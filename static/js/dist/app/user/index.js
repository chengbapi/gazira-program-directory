define("dist/app/user/index",["../common/index","../common/helper/global","$","../common/tpl/user/avatar","../common/tpl/user/user-link","../../lib/util/string","../common/expression/expression","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/tip/tpl/tip","../../lib/util/dom/action","../../lib/cmp/switchable/tabs","../../lib/cmp/switchable/switchable","../../lib/cmp/switchable/plugins/effects","../../lib/util/dom/easing","../../lib/cmp/switchable/plugins/autoplay","../../lib/cmp/switchable/plugins/circular","../common/helper/inputor","../../lib/util/dom/selection","../../lib/util/dom/inputor","../../lib/util/timer","../common/expression/tpl/container","../common/expression/tpl/item","../common/expression/tpl/expression","../common/expression/data","../../lib/util/date","../common/action/action","../common/action/api","../common/ajax","../common/_ajax","../../lib/util/json","../common/dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../common/singleton-tip","../common/new-weibo","../common/weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/cmp/autocomplete/autocomplete","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","../../lib/util/dom/placeholder","../common/weibo-manager","../common/tpl/weibo","../common/tpl/comment","../common/tpl/weibo-pic","../common/pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image","../common/upload-pic","../../lib/util/dom/upload/upload","../../lib/util/dom/upload/upload-swfupload","../../lib/util/dom/upload/swfupload","../../lib/util/dom/upload/upload-html5","../../lib/util/dom/upload/upload-draggable","../common/tpl/pic","../common/dialog/new-weibo","../common/dialog/tpl/new-weibo","../common/dialog/repost","../common/dialog/tpl/repost","../common/dialog/tpl/repost-referer","../common/dialog/pic-display","../common/dialog/tpl/pic-display","../common/dialog/praise-list","../common/dialog/tpl/praise-list","../common/dialog/tpl/praise-data","./ajaxCommon","./ajaxCallback","../common/handler","../common/tpl/no-data","../common/tpl/weiboinfo","../common/tpl/userinfo","../message/tpl/praise","../common/tpl/no-result","../common/tpl/weibo-del","../common/query","../attention/ajaxCommon","../common/tpl/comments","../common/tpl/recomm-user","../common/search","../common/head","../../lib/util/bom/cookie","../common/message-manager","../common/ext-tip","../common/tpl/unread_tip","../common/dashboard","../common/attention","../common/hot-topic","../common/tpl/topic","../common/user-info","../common/placeholder","./tab"],function(a){a("../common/index");var b=a("$"),c=(a("../common/pagenation"),a("./tab")),d=a("./ajaxCommon"),e=a("../common/query"),f=(a("../../lib/util/dom/action"),e.param("uid")),g={tabWidget:function(a){new c({element:".info-counts ul",index:a}).render()},getInitList:function(){var a=e.param("tabType"),b=0;switch(a){case"userweb":b=0;break;case"favor":b=1;break;case"fans":b=2;break;case"idols":b=3}this.tabWidget(b)}};g.getInitList(),d.userInfo(f).done(function(a){b(".my-info .user-avatar").html(Global.Helper.avatar(a,120)),b(".my-info .user-name").html(a.nickname),b(".at-btn").attr({"data-uid":a.uid,"data-username":a.nickname});var c=b('[data-role="is-follow"]');c.attr("data-uid",f),1===a.is_following?(c.addClass("attened-btn").removeClass("attention-btn"),c.attr("data-action","unfollow")):(c.addClass("attention-btn").removeClass("attened-btn"),c.attr("data-action","follow"));var d=[null===a.topics?0:a.topics,null===a.favs?0:a.favs,null===a.fans?0:a.fans,null===a.idols?0:a.idols];b(".info-counts").find(".item").each(function(a){b(this).find(".num").html(d[a])})})}),define("dist/app/common/index",["./helper/global","$","./tpl/user/avatar","./tpl/user/user-link","../../lib/util/string","./expression/expression","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/tip/tpl/tip","../../lib/util/dom/action","../../lib/cmp/switchable/tabs","../../lib/cmp/switchable/switchable","../../lib/cmp/switchable/plugins/effects","../../lib/util/dom/easing","../../lib/cmp/switchable/plugins/autoplay","../../lib/cmp/switchable/plugins/circular","./helper/inputor","../../lib/util/dom/selection","../../lib/util/dom/inputor","../../lib/util/timer","./expression/tpl/container","./expression/tpl/item","./expression/tpl/expression","./expression/data","../../lib/util/date","../common/action/action","./action/api","./ajax","./_ajax","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./singleton-tip","./new-weibo","./weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/cmp/autocomplete/autocomplete","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","../../lib/util/dom/placeholder","./weibo-manager","./tpl/weibo","./tpl/comment","./tpl/weibo-pic","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image","./upload-pic","../../lib/util/dom/upload/upload","../../lib/util/dom/upload/upload-swfupload","../../lib/util/dom/upload/swfupload","../../lib/util/dom/upload/upload-html5","../../lib/util/dom/upload/upload-draggable","./tpl/pic","./dialog/new-weibo","./dialog/tpl/new-weibo","./dialog/repost","./dialog/tpl/repost","./dialog/tpl/repost-referer","./dialog/pic-display","./dialog/tpl/pic-display","./dialog/praise-list","./dialog/tpl/praise-list","./dialog/tpl/praise-data","../user/ajaxCommon","../user/ajaxCallback","./handler","./tpl/no-data","./tpl/weiboinfo","./tpl/userinfo","../message/tpl/praise","./tpl/no-result","./tpl/weibo-del","./query","../attention/ajaxCommon","./tpl/comments","./tpl/recomm-user","./search","./head","../../lib/util/bom/cookie","./message-manager","./ext-tip","./tpl/unread_tip","./dashboard","./attention","./hot-topic","./tpl/topic","./user-info","./placeholder"],function(a){a("./helper/global"),a("../common/action/action"),setTimeout(function(){a("./search"),a("./head"),a("./dashboard"),a("./placeholder")},0)}),define("dist/app/common/helper/global",["$","./../tpl/user/avatar","./../tpl/user/user-link","../../../lib/util/string","../expression/expression","../../../lib/cmp/tip/tip","../../../lib/cmp/tip/basic-tip","../../../lib/cmp/popup","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/tip/tpl/tip","../../../lib/util/dom/action","../../../lib/cmp/switchable/tabs","../../../lib/cmp/switchable/switchable","../../../lib/cmp/switchable/plugins/effects","../../../lib/util/dom/easing","../../../lib/cmp/switchable/plugins/autoplay","../../../lib/cmp/switchable/plugins/circular","./inputor","../../../lib/util/dom/selection","../../../lib/util/dom/inputor","../../../lib/util/timer","../expression/tpl/container","../expression/tpl/item","../expression/tpl/expression","../expression/data","../../../lib/util/date"],function(a,b,c){var d=(a("$"),a("./../tpl/user/avatar")),e=a("./../tpl/user/user-link"),f=a("../../../lib/util/string"),g=a("../expression/expression"),h=a("../../../lib/util/date"),i={loopParse:function(a,b,c){!function(){for(var d,e=0,f=a.length;f>e;e++)d=a[e],c!==!0&&d.index||b(d)}()}},j={avatar:function(a,b){return a?d.render({user:a,size:b||100}):""},userLink:function(a){return a?e.render({user:a}):""},followLink:function(){},getLength:function(a){return Math.ceil(a.replace(/[^x00-xFF]/g,"xx").length/2)},parseContent:function(a){var b=f.code(a),c=Global.hostname.replace(/\//g,"\\/");c=c.replace(/\./g,"\\.");var d=new RegExp(c+"\\/r\\/\\w+","g"),e=[];!function(){var a,c,f,g,h;b.replace(d,function(a){e.push({index:arguments[1],match:a,text:'<a href="'+a+'" target="_blank" title="'+a+'">'+a+"</a>"})});var i=[];for(a=0,c=e.length;c>a;a++)i.push(e[a].index,e[a].text);var j=e.slice();for(a=0,c=j.length,f=0;c>a;a++)g=j[a],h=g.index,h>=f&&(e.splice(2*a,0,{text:b.slice(f,h)}),f=h+g.match.length);var k=b.slice(f);k&&e.push({text:k})}(),d=/(#([^#\$\-@\[\]\(\)\{\};<>\/\\]+?)#)/g;var h=/&amp;/g;return function(){i.loopParse(e,function(a){a.text=a.text.replace(h,"&"),a.text=a.text.replace(d,function(a,b,c){return f.blength(b,!0)>40?b:a.replace(b,'<a href="/topicinfo?topic='+encodeURIComponent(c)+'">'+b+"</a>")})})}(),i.loopParse(e,function(a){a.text=g.parse(a.text)}),d=/&lt;M\s+(\d+)&gt;(.+?)&lt;\/M&gt;/gi,i.loopParse(e,function(a){a.text=a.text.replace(d,function(a,b,c){return'<a href="/user?uid='+b+'" title="'+c+'">'+c+"</a>"})}),function(){var a=[];i.loopParse(e,function(b){a.push(b.text)},!0),b=a.join("")}(),b},cuteDate:function(a){for(var b,c=new Date(a*Math.pow(10,13-(a+"").length)),d=new Date,e=[h.distance(d,-1,"m"),h.distance(d,-1,"h"),h.distance(d,-5,"h"),h.distance(d,-1,"d"),h.distance(d,-7,"d"),h.distance(d,-1,"y")],f=0,g=e.length;g>f;f++)if(b=e[f]-c,0>=b){b=d-c;break}0===f?b="1分钟前":1===f?b=Math.ceil(b/6e4)+"分钟前":2===f?b=Math.ceil(b/36e5)+"小时前":3===f?(b=c.getDate()<d.getDate()?"昨天 ":"",b+=h.format(c,"HH:mm")):b=4===f?Math.ceil(b/6048e5)+"天前":5===f?h.format(c,"M月d日"):h.format(c,"yyyy年M月d日 HH:mm");var i=d.getFullYear(),j=c.getFullYear();return i>j&&(b=h.format(c,"yyyy年M月d日 HH:mm")),b}};Global.Helper=j,c.exports=j}),define("dist/app/common/tpl/user/avatar",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <a href=\"/user?uid=',user.uid,'\" data-uid=\"',user.uid,'\">  <img class=\"avatar\" title=\"',user.nickname,'\" alt=\"',user.nickname,'\" src=\"',Global.avatarBaseUrl,'uid=',user.uid,'&amp;size=f',size,'\"> </a>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/tpl/user/user-link",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <a href="/user?uid=\',user.uid,\'" data-uid="\',user.uid,\'" data-role="user">  <span class="name"><strong data-role="username">\',user.nickname,\'</strong></span> </a>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/util/string",[],function(a,b,c){var d={blength:function(a,b){var c=0;return a&&(c=a.replace(/[^\x00-\xff]/g,"**").length,b===!0&&(c=Math.ceil(c/2))),c},cut:function(a,b,c){c=c||{};var d=c===!0||c.fullSharp===!0,e=c&&"right"===c.dir;if(d){var f=this.blength(a),g=0,h=0;if(b>=f)return a;var i,j=b/2;j=j!==parseInt(j,10)?parseInt(j,10)-1:j,i=e?a.slice(a.length-j):a.slice(0,j),h=this.blength(i),g=i.length;for(var k=g,l=a.length;l>k&&(b>h&&f>g);k++)j=e?l-k-1:k,/[^\x00-\xff]/.test(a.charAt(j))?h+=2:h++,g++;return e?a.slice(a.length-g):a.slice(0,g)}return e?a.slice(a.length-b):a.slice(0,b)},code:function(a,b){var c,d;b===!0?(c=[/&amp;/g,/&gt;/g,/&lt;/g],d=["&",">","<"]):(c=[/&/g,/>/g,/</g],d=["&amp;","&gt;","&lt;"]);for(var e=0,f=d.length;f>e;e++)a=a.replace(c[e],d[e]);return a},content:function(a){return a=d.code(a),a=a.replace(/ /g,"&nbsp;").replace(/\n/g,"<br/>"),a=a.replace(/((https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?)/g,function(a,b){return'<a href="'+b+'" target="_blank">'+b+"</a>"})}};c.exports=d}),define("dist/app/common/expression/expression",["$","../../../lib/cmp/tip/tip","../../../lib/cmp/tip/basic-tip","../../../lib/cmp/popup","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/tip/tpl/tip","../../../lib/util/dom/action","../../../lib/cmp/switchable/tabs","../../../lib/cmp/switchable/switchable","../../../lib/cmp/switchable/plugins/effects","../../../lib/util/dom/easing","../../../lib/cmp/switchable/plugins/autoplay","../../../lib/cmp/switchable/plugins/circular","../helper/inputor","../../../lib/util/dom/selection","../../../lib/util/dom/inputor","../../../lib/util/timer","../../../lib/util/string","./tpl/container","./tpl/item","./tpl/expression","./data"],function(a,b){var c=a("$"),d=a("../../../lib/cmp/tip/tip"),e=a("../../../lib/util/dom/action"),f=a("../../../lib/cmp/switchable/tabs"),g=a("../helper/inputor"),h={container:a("./tpl/container"),item:a("./tpl/item"),expression:a("./tpl/expression")},i=a("./data"),j=function(a){for(var b={},c=function(a){return new Array(4-(a+"").length).join("0")+a},d=0,e=a.length;e>d;d++)b[a[d]]=c(d+1);return b}(i),k=d.extend({attrs:{trigger:"[data-action=expression]",triggerType:"click",theme:"white",content:h.container.render(),zIndex:999999,arrowPosition:11,align:{_specifiedAlign:!1}},events:{"click [data-action=expression-item]":function(a){var b=c(a.target);this.output(b.data("tip")),this.hide()}},setup:function(){k.superclass.setup.call(this),this.after("render",function(){var a=this.$(".expr-tabs"),b=this.$(".expr-panels"),d=0,e=0,g=6,j=8;c.each(i,function(c,f){0===d&&(a.append('<div class="expr-tab">'),b.append('<div class="expr-panel no-'+e+'">')),b.children().last().append(h.item.render({data:f})),d+1===g*j?(d=0,e++):d++}),new f({className:"expr",element:this.$("[data-role=expression-container]"),triggerType:"click",triggers:".expr-tab",panels:".expr-panel",activeTriggerClass:"active"})})},output:function(a){var b="["+a+"]",c=this.get("selection"),d=c.cachedCursor;c.insertText(b,d,!0),c.cursor(d[0]+b.length),c.element.focus()}});b.parse=function(a){return a.replace(/\[([^\]]+?)\]/g,function(a,b){return b in j?h.expression.render({index:j[b],name:b}):a})},c(function(){var a=(new k).render();b.ins=a,e.listen({expression:function(b,c){var d=g.selection(g.getTextarea(c));a.set("selection",d),a.set("align",{selfXY:[0,0],baseElement:c,baseXY:[-5,"100%+8px"]}).show()}})})}),define("dist/lib/cmp/tip/tip",["$","./basic-tip","../popup","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./tpl/tip"],function(a,b,c){var d=a("$"),e=a("./basic-tip"),f=a("./tpl/tip"),g=e.extend({attrs:{template:f.render(),content:"A TIP BOX",arrowPosition:7,theme:"yellow",inViewport:!1},setup:function(){e.superclass.setup.call(this),this._originArrowPosition=this.get("arrowPosition"),this.after("show",function(){this._makesureInViewport()})},_makesureInViewport:function(){if(this.get("inViewport")){var a=this._originArrowPosition,b=d(window).scrollTop(),c=d(window).outerHeight(),e=this.element.height()+this.get("distance"),f=this.get("trigger").offset().top,g=this.get("trigger").height(),h={1:5,5:1,7:11,11:7};(11==a||1==a)&&f+g>b+c-e?this.set("arrowPosition",h[a]):(7==a||5==a)&&b+e>f?this.set("arrowPosition",h[a]):this.set("arrowPosition",this._originArrowPosition)}},_onRenderArrowPosition:function(a,b){a=parseInt(a,10);var c=this.$(".widget-poptip-arrow");if(c.removeClass("widget-poptip-arrow-"+b).addClass("widget-poptip-arrow-"+a),!this._specifiedAlign){var d="",e=0;10===a?(d="right",e=20):11===a?(d="down",e=22):1===a?(d="down",e=-22):2===a?(d="left",e=20):5===a?(d="up",e=-22):7===a&&(d="up",e=22),this.set("direction",d),this.set("arrowShift",e),this._setAlign()}},_onRenderWidth:function(a){this.$('[data-role="content"]').css("width",a)},_onRenderHeight:function(a){this.$('[data-role="content"]').css("height",a)},_onRenderTheme:function(a,b){this.element.removeClass("widget-poptip-"+b),this.element.addClass("widget-poptip-"+a)}});c.exports=g}),define("dist/lib/cmp/tip/basic-tip",["../popup","$","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render"],function(a,b,c){var d=a("../popup");c.exports=d.extend({attrs:{content:null,direction:"up",distance:8,arrowShift:22,pointPos:"50%"},_setAlign:function(){var a={},b=this.get("arrowShift"),c=this.get("distance"),d=this.get("pointPos"),e=this.get("direction");0>b&&(b="100%"+b),"up"===e?(a.baseXY=[d,0],a.selfXY=[b,"100%+"+c]):"down"===e?(a.baseXY=[d,"100%+"+c],a.selfXY=[b,0]):"left"===e?(a.baseXY=[0,d],a.selfXY=["100%+"+c,b]):"right"===e&&(a.baseXY=["100%+"+c,d],a.selfXY=[0,b]),a.comeFromArrowPosition=!0,this.set("align",a)},_onRenderContent:function(a){var b=this.$('[data-role="content"]');"string"!=typeof a&&(a=a.call(this)),b&&b.html(a)}})}),define("dist/lib/cmp/popup",["$","./overlay","../util/dom/position","../util/bom/browser","../util/dom/iframe-shim","./widget","../util/base","../util/class","../util/event","../util/aspect","../util/attribute","./daparser","./auto-render"],function(a,b,c){function d(a,b,c,d,e){var f=d&&d[0];e.delegateEvents(f?d:b,f?a+" "+b.selector:a,function(a){c.call(a.currentTarget,a)})}var e=a("$"),f=a("./overlay"),g=f.extend({attrs:{trigger:{value:null,getter:function(a){return e(a)}},triggerType:"hover",delegateNode:{value:null,getter:function(a){return e(a)}},align:{value:{baseXY:[0,"100%"],selfXY:[0,0]},setter:function(a){return a?(a.baseElement?this._specifiedBaseElement=!0:this.activeTrigger&&(a.baseElement=this.activeTrigger),a):void 0},getter:function(a){return e.extend({},a,this._specifiedBaseElement?{}:{baseElement:this.activeTrigger})}},delay:70,disabled:!1,effect:"",duration:250},setup:function(){g.superclass.setup.call(this),this._bindTrigger(),this._blurHide(this.get("trigger")),this.activeTrigger=this.get("trigger").eq(0)},show:function(){return this.get("disabled")?void 0:g.superclass.show.call(this)},_bindTrigger:function(){var a=this.get("triggerType");"click"===a?this._bindClick():"focus"===a?this._bindFocus():this._bindHover()},_bindClick:function(){function a(a){b.get("disabled")||b.get("trigger").each(function(c,d){a===d?(d._active=!0,b.activeTrigger=e(d)):d._active=!1})}var b=this;d("click",this.get("trigger"),function(c){"a"===this.tagName.toLowerCase()&&c.preventDefault(),this._active===!0?b.hide():(a(this),b.show())},this.get("delegateNode"),this),this.before("hide",function(){a()})},_bindFocus:function(){var a=this;d("focus",this.get("trigger"),function(){a.activeTrigger=e(this),a.show()},this.get("delegateNode"),this),d("blur",this.get("trigger"),function(){setTimeout(function(){!a._downOnElement&&a.hide(),a._downOnElement=!1},a.get("delay"))},this.get("delegateNode"),this),this.delegateEvents("mousedown",function(){this._downOnElement=!0})},_bindHover:function(){function a(){clearTimeout(b),b=null,i.get("visible")&&(c=setTimeout(function(){i.hide()},h))}var b,c,f=this.get("trigger"),g=this.get("delegateNode"),h=this.get("delay"),i=this;return 0>h?void this._bindTooltip():(d("mouseenter",f,function(){clearTimeout(c),c=null,i.activeTrigger=e(this),b=setTimeout(function(){i.show()},h)},g,this),d("mouseleave",f,a,g,this),this.delegateEvents("mouseenter",function(){clearTimeout(c)}),void this.delegateEvents("mouseleave",a))},_bindTooltip:function(){var a=this.get("trigger"),b=this.get("delegateNode"),c=this;d("mouseenter",a,function(){c.activeTrigger=e(this),c.show()},b,this),d("mouseleave",a,function(){c.hide()},b,this)},_onRenderVisible:function(a){var b=-1!==this.get("effect").indexOf("fade"),c=-1!==this.get("effect").indexOf("slide"),d={};c&&(d.height=a?"show":"hide"),b&&(d.opacity=a?"show":"hide"),b||c?this.element.stop(!0,!0).animate(d,this.get("duration")).css({visibility:"visible"}):this.element[a?"show":"hide"]()}});c.exports=g}),define("dist/lib/cmp/overlay",["$","../util/dom/position","../util/bom/browser","../util/dom/iframe-shim","./widget","../util/base","../util/class","../util/event","../util/aspect","../util/attribute","./daparser","./auto-render"],function(a,b,c){function d(a){return g.contains(document.documentElement,a)}function e(a){g(k.blurOverlays).each(function(b,c){if(c&&c.get("visible")){for(var d=0;d<c._relativeElements.length;d++){var e=g(c._relativeElements[d])[0];if(e===a.target||g.contains(e,a.target))return}c.hide()}})}function f(a,b){for(var c=0;c<b.length;c++)if(a===b[c])return b.splice(c,1),b}var g=a("$"),h=a("../util/dom/position"),i=a("../util/dom/iframe-shim"),j=a("./widget"),k=j.extend({attrs:{width:null,height:null,zIndex:99,visible:!1,repositionOnResize:!0,align:{selfXY:[0,0],baseElement:h.VIEWPORT,baseXY:[0,0]},parentNode:document.body},show:function(){return this.rendered||this.render(),this.set("visible",!0),this},hide:function(){return this.set("visible",!1),this},setup:function(){var a=this;this._setupShim(),this.get("repositionOnResize")&&this._setupResize(),this.after("show",function(){a._setPosition()})},destroy:function(){return f(this,k.allOverlays),f(this,k.blurOverlays),k.superclass.destroy.call(this)},_setPosition:function(a){if(d(this.element[0])&&(a||(a=this.get("align")),a)){var b="none"===this.element.css("display");return b&&this.element.css({visibility:"hidden",display:"block"}),h.pin({element:this.element,x:a.selfXY[0],y:a.selfXY[1]},{element:a.baseElement,x:a.baseXY[0],y:a.baseXY[1]}),b&&this.element.css({visibility:"",display:"none"}),this}},_setupShim:function(){var a=new i(this.element);this.after("hide _setPosition",a.sync,a);var b=["width","height"];for(var c in b)b.hasOwnProperty(c)&&this.on("change:"+c,a.sync,a);this.before("destroy",a.destroy,a)},_setupResize:function(){k.allOverlays.push(this)},_blurHide:function(a){a=g.makeArray(a),a.push(this.element),this._relativeElements=a,k.blurOverlays.push(this)},_onRenderWidth:function(a){this.element.css("width",a)},_onRenderHeight:function(a){this.element.css("height",a)},_onRenderZIndex:function(a){this.element.css("zIndex",a)},_onRenderAlign:function(a){this._setPosition(a)},_onRenderVisible:function(a){this.element[a?"show":"hide"]()}});k.blurOverlays=[],g(document).on("mousedown",function(a){e(a)});var l,m=g(window).width(),n=g(window).height();k.allOverlays=[],g(window).resize(function(){var a=g(window).width(),b=g(window).height();(m!==a||n!==b)&&(l&&clearTimeout(l),l=setTimeout(function(){g(k.allOverlays).each(function(a,b){b&&b.get("visible")&&b._setPosition()})},80)),m=a,n=b}),c.exports=k}),define("dist/lib/util/dom/position",["$","../bom/browser"],function(a,b){function c(a){a=h(a)||{},a.nodeType&&(a={element:a});var b=h(a.element)||j;if(1!==b.nodeType)throw new Error("posObject.element is invalid.");var c={element:b,x:a.x||0,y:a.y||0},d=b===j||"VIEWPORT"===b._id;return c.offset=function(){return m?{left:0,top:0}:d?{left:k(document).scrollLeft(),top:k(document).scrollTop()}:k(b).offset()},c.size=function(){var a=k(d?window:b);return{width:a.outerWidth(),height:a.outerHeight()}},c}function d(a){a.x=e(a.x,a,"width"),a.y=e(a.y,a,"height")}function e(a,b,c){if(a+="",a=a.replace(/px/gi,""),/\D/.test(a)&&(a=a.replace(/(?:top|left)/gi,"0%").replace(/center/gi,"50%").replace(/(?:bottom|right)/gi,"100%")),-1!==a.indexOf("%")&&(a=a.replace(/(\d+(?:\.\d+)?)%/gi,function(a,d){return b.size()[c]*(d/100)})),/[+\-*\/]/.test(a))try{a=new Function("return "+a)()}catch(d){throw new Error("Invalid position value: "+a)}return g(a)}function f(a){var b=a.offsetParent();b[0]===document.documentElement&&(b=k(document.body)),n&&b.css("zoom",1);var c=b[0]===document.body?{left:0,top:0}:b.offset();return c.top+=g(b.css("border-top-width")),c.left+=g(b.css("border-left-width")),c}function g(a){return parseFloat(a,10)||0}function h(a){return k(a)[0]}var i=b,j={_id:"VIEWPORT",nodeType:1},k=a("$"),l=a("../bom/browser"),m=!1,n=l.ie6;i.pin=function(a,b){a=c(a),b=c(b);var e=k(a.element);"fixed"!==e.css("position")||n?(e.css("position","absolute"),m=!1):m=!0,d(a),d(b);var g=f(e),h=b.offset(),i=h.top+b.y-a.y-g.top,j=h.left+b.x-a.x-g.left;e.css({left:j,top:i})},i.center=function(a,b){i.pin({element:a,x:"50%",y:"50%"},{element:b,x:"50%",y:"50%"})},i.VIEWPORT=j}),define("dist/lib/util/bom/browser",[],function(a,b,c){c.exports=function(){var a=!!window.ActiveXObject,b=!!window.devicePixelRatio;return{ie:a,ie6:a&&!window.XMLHttpRequest,ie7:a&&"7."===navigator.appVersion.match(/7./i),ie8:!!window.XDomainRequest,ie9:a&&1,firefox:!!document.getBoxObjectFor||"mozInnerScreenX"in window,opera:b&&!!window.opera,safari:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,chrome:b&&!!window.chrome}}()}),define("dist/lib/util/dom/iframe-shim",["$","./position","../bom/browser"],function(a,b,c){function d(a){this.target=f(a).eq(0)}function e(a){var b={display:"none",border:"none",opacity:0,position:"absolute"},c=a.css("zIndex");return c&&c>0&&(b.zIndex=c-1),f("<iframe>",{src:"about:blank",frameborder:0,css:b}).insertBefore(a)}var f=a("$"),g=a("./position"),h=-1!==(window.navigator.userAgent||"").toLowerCase().indexOf("msie 6");if(d.prototype.sync=function(){var a=this.target,b=this.iframe;if(!a.length)return this;var c=a.outerHeight(),d=a.outerWidth();return c&&d&&!a.is(":hidden")?(b||(b=this.iframe=e(a)),b.css({height:c,width:d}),g.pin(b[0],a[0]),b.show()):b&&b.hide(),this},d.prototype.destroy=function(){this.iframe&&(this.iframe.remove(),delete this.iframe),delete this.target},h)c.exports=d;else{var i=function(){};i.prototype.sync=function(){return this},i.prototype.destroy=i,c.exports=i}}),define("dist/lib/cmp/widget",["../util/base","../util/class","../util/event","../util/aspect","../util/attribute","$","./daparser","./auto-render"],function(a,b,c){function d(){return"widget-"+w++}function e(a){return"[object String]"===v.call(a)}function f(a){return"[object Function]"===v.call(a)}function g(a){return x(document.documentElement,a)}function h(a){return a.charAt(0).toUpperCase()+a.substring(1)}function i(a){return f(a.events)&&(a.events=a.events()),a.events}function j(a,b){var c=a.match(y),d=c[1]+q+b.cid,e=c[2]||void 0;return e&&e.indexOf("{{")>-1&&(e=k(e,b)),{type:d,selector:e}}function k(a,b){return a.replace(z,function(a,c){for(var d,f=c.split("."),g=b;d=f.shift();)g=g===b.attrs?b.get(d):g[d];return e(g)?g:A})}function l(a){return null==a||void 0===a}var m=a("../util/base"),n=a("$"),o=a("./daparser"),p=a("./auto-render"),q=".delegate-events-",r="_onRender",s="data-widget-cid",t={},u=m.extend({propsInAttrs:["initElement","element","events"],element:null,events:null,attrs:{id:null,className:null,style:null,template:"<div></div>",model:null,parentNode:document.body},initialize:function(a){this.cid=d();var b=this._parseDataAttrsConfig(a);u.superclass.initialize.call(this,a?n.extend(b,a):b),this.parseElement(),this.initProps(),this.delegateEvents(),this.setup(),this._stamp(),this._isTemplate=!(a&&a.element)},_parseDataAttrsConfig:function(a){var b,c;return a&&(b=n(a.initElement?a.initElement:a.element)),b&&b[0]&&!p.isDataApiOff(b)&&(c=o.parseElement(b)),c},parseElement:function(){var a=this.element;if(a?this.element=n(a):this.get("template")&&this.parseElementFromTemplate(),!this.element||!this.element[0])throw new Error("element is invalid")},parseElementFromTemplate:function(){this.element=n(this.get("template"))},initProps:function(){},delegateEvents:function(a,b,c){if(0===arguments.length?(b=i(this),a=this.element):1===arguments.length?(b=a,a=this.element):2===arguments.length?(c=b,b=a,a=this.element):(a||(a=this.element),this._delegateElements||(this._delegateElements=[]),this._delegateElements.push(n(a))),e(b)&&f(c)){var d={};d[b]=c,b=d}for(var g in b)if(b.hasOwnProperty(g)){var h=j(g,this),k=h.type,l=h.selector;!function(b,c){var d=function(a){return f(b)?b.call(c,a):c[b](a)};l?n(a).on(k,l,d):n(a).on(k,d)}(b[g],this)}return this},undelegateEvents:function(a,b){if(b||(b=a,a=null),0===arguments.length){var c=q+this.cid;if(this.element&&this.element.off(c),this._delegateElements)for(var d in this._delegateElements)this._delegateElements.hasOwnProperty(d)&&this._delegateElements[d].off(c)}else{var e=j(b,this);a?n(a).off(e.type,e.selector):this.element&&this.element.off(e.type,e.selector)}return this},setup:function(){},render:function(){this.rendered||(this._renderAndBindAttrs(),this.rendered=!0);var a=this.get("parentNode");if(a&&!g(this.element[0])){var b=this.constructor.outerBoxClass;if(b){var c=this._outerBox=n("<div></div>").addClass(b);c.append(this.element).appendTo(a)}else this.element.appendTo(a)}return this},_renderAndBindAttrs:function(){var a=this,b=a.attrs;for(var c in b)if(b.hasOwnProperty(c)){var d=r+h(c);if(this[d]){var e=this.get(c);l(e)||this[d](e,void 0,c),function(b){a.on("change:"+c,function(c,d,e){a[b](c,d,e)})}(d)}}},_onRenderId:function(a){this.element.attr("id",a)},_onRenderClassName:function(a){this.element.addClass(a)},_onRenderStyle:function(a){this.element.css(a)},_stamp:function(){var a=this.cid;(this.initElement||this.element).attr(s,a),t[a]=this},$:function(a){return this.element.find(a)},destroy:function(){this.undelegateEvents(),delete t[this.cid],this.element&&this._isTemplate&&(this.element.off(),this._outerBox?this._outerBox.remove():this.element.remove()),this.element=null,u.superclass.destroy.call(this)}});n(window).unload(function(){for(var a in t)t[a].destroy()}),u.query=function(a){var b,c=n(a).eq(0);return c&&(b=c.attr(s)),t[b]},u.autoRender=p.autoRender,u.autoRenderAll=p.autoRenderAll,u.StaticsWhiteList=["autoRender"],c.exports=u;var v=Object.prototype.toString,w=0,x=n.contains||function(a,b){return!!(16&a.compareDocumentPosition(b))},y=/^(\S+)\s*(.*)$/,z=/{{([^}]+)}}/g,A="INVALID_SELECTOR"}),define("dist/lib/util/base",["./class","./event","./aspect","./attribute"],function(a,b,c){function d(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d="_onChange"+e(c);a[d]&&a.on("change:"+c,a[d])}}function e(a){return a.charAt(0).toUpperCase()+a.substring(1)}var f=a("./class"),g=a("./event"),h=a("./aspect"),i=a("./attribute"),j=f.create({Implements:[g,h,i],initialize:function(a){this.initAttrs(a),d(this,this.attrs)},destroy:function(){this.off();for(var a in this)this.hasOwnProperty(a)&&delete this[a];this.destroy=function(){}}});c.exports=j}),define("dist/lib/util/class",[],function(a,b,c){function d(a){return this instanceof d||!l(a)?void 0:g(a)}function e(){}function f(a){var b,c;for(b in a)c=a[b],d.Mutators.hasOwnProperty(b)?d.Mutators[b].call(this,c):this.prototype[b]=c}function g(a){return a.extend=d.extend,a.implement=f,a}function h(a,b,c){for(var d in b)if(b.hasOwnProperty(d)){if(c&&-1===m(c,d))continue;"prototype"!==d&&(a[d]=b[d])}}c.exports=d,d.extend=function(a){return a||(a={}),a.Extends=this,d.create(a)},d.create=function(a,b){function c(){a.apply(this,arguments),this.constructor===c&&this.initialize&&this.initialize.apply(this,arguments)}return l(a)||(b=a,a=null),b||(b={}),a||(a=b.Extends||d),b.Extends=a,a!==d&&h(c,a,a.StaticsWhiteList),f.call(c,b),g(c)};var i=Object.__proto__?function(a){return{__proto__:a}}:function(a){return e.prototype=a,new e};d.Mutators={Extends:function(a){var b=this.prototype,c=i(a.prototype);
h(c,b),c.constructor=this,this.prototype=c,this.superclass=a.prototype},Implements:function(a){k(a)||(a=[a]);for(var b,c=this.prototype;b=a.shift();)h(c,b.prototype||b)},Statics:function(a){h(this,a)}};var j=Object.prototype.toString,k=Array.isArray||function(a){return"[object Array]"===j.call(a)},l=function(a){return"[object Function]"===j.call(a)},m=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}}),define("dist/lib/util/event",[],function(a,b,c){function d(){}function e(a,b,c,d){var e;if(a)for(var f=0,g=a.length;g>f;f+=2)e=a[f].apply(a[f+1]||c,b),e===!1&&d.status&&(d.status=!1)}var f=/\s+/;c.exports=d,d.prototype.on=function(a,b,c){var d,e,g;if(!b)return this;for(d=this.__events||(this.__events={}),a=a.split(f);e=a.shift();)g=d[e]||(d[e]=[]),g.push(b,c);return this},d.prototype.off=function(a,b,c){var d,e,h,i;if(!(d=this.__events))return this;if(!(a||b||c))return delete this.__events,this;for(a=a?a.split(f):g(d);e=a.shift();)if(h=d[e])if(b||c)for(i=h.length-2;i>=0;i-=2)b&&h[i]!==b||c&&h[i+1]!==c||h.splice(i,2);else delete d[e];return this},d.prototype.trigger=function(a){var b,c,d,g,h,i,j=[],k={status:!0};if(!(b=this.__events))return this;for(a=a.split(f),h=1,i=arguments.length;i>h;h++)j[h-1]=arguments[h];for(;c=a.shift();)(d=b.all)&&(d=d.slice()),(g=b[c])&&(g=g.slice()),e(g,j,this,k),e(d,[c].concat(j),this,k);return k.status},d.mixTo=function(a){a=a.prototype||a;var b=d.prototype;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};var g=Object.keys;g||(g=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b})}),define("dist/lib/util/aspect",[],function(a,b,c){function d(a,b,c,d){for(var g,i,j=b.split(h);g=j.shift();)i=e(this,g),i.__isAspected||f.call(this,g),this.on(a+":"+g,c,d);return this}function e(a,b){var c=a[b];if(!c)throw new Error("Invalid method name: "+b);return c}function f(a){var b=this[a];this[a]=function(){var c=Array.prototype.slice.call(arguments),d=["before:"+a].concat(c);if(this.trigger.apply(this,d)!==!1){var e=b.apply(this,arguments),f=["after:"+a,e].concat(c);return this.trigger.apply(this,f),e}},this[a].__isAspected=!0}var g={before:function(a,b,c){return d.call(this,"before",a,b,c)},after:function(a,b,c){return d.call(this,"after",a,b,c)}};c.exports=g;var h=/\s+/}),define("dist/lib/util/attribute",[],function(a,b,c){function d(a){return"[object String]"===u.call(a)}function e(a){return"[object Function]"===u.call(a)}function f(a){return null!==a&&a===a.window}function g(a){if(!a||"[object Object]"!==u.call(a)||a.nodeType||f(a))return!1;try{if(a.constructor&&!v.call(a,"constructor")&&!v.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;if(t)for(c in a)return v.call(a,c);for(c in a);return void 0===c||v.call(a,c)}function h(a){if(!a||"[object Object]"!==u.call(a)||a.nodeType||f(a)||!a.hasOwnProperty)return!1;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function i(a,b){var c,d;for(c in b)if(b.hasOwnProperty(c)){if(d=b[c],w(d))d=d.slice();else if(g(d)){var e=a[c];g(e)||(e={}),d=i(e,d)}a[c]=d}return a}function j(a,b,c){for(var d=[],e=b.constructor.prototype;e;)e.hasOwnProperty("attrs")||(e.attrs={}),l(c,e.attrs,e),h(e.attrs)||d.unshift(e.attrs),e=e.constructor.superclass;for(var f=0,g=d.length;g>f;f++)i(a,p(d[f]))}function k(a,b){i(a,p(b,!0))}function l(a,b,c,d){for(var e=0,f=a.length;f>e;e++){var g=a[e];c.hasOwnProperty(g)&&(b[g]=d?b.get(g):c[g])}}function m(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d,f=b[c].value;e(f)&&(d=c.match(y))&&(a[d[1]](n(d[2]),f),delete b[c])}}function n(a){var b=a.match(z),c=b[1]?"change:":"";return c+=b[2].toLowerCase()+b[3]}function o(a,b,c){var d={silent:!0};a.__initializingAttrs=!0;for(var e in c)c.hasOwnProperty(e)&&b[e].setter&&a.set(e,c[e],d);delete a.__initializingAttrs}function p(a,b){var c={};for(var d in a){var e=a[d];c[d]=!b&&g(e)&&q(e,A)?e:{value:e}}return c}function q(a,b){for(var c=0,d=b.length;d>c;c++)if(a.hasOwnProperty(b[c]))return!0;return!1}function r(a){return null===a||(d(a)||w(a))&&0===a.length||h(a)}function s(a,b){if(a===b)return!0;if(r(a)&&r(b))return!0;var c=u.call(a);if(c!==u.call(b))return!1;switch(c){case"[object String]":return a===String(b);case"[object Number]":return a!==+a?b!==+b:0===a?1/a===1/b:a===+b;case"[object Date]":case"[object Boolean]":return+a===+b;case"[object RegExp]":return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.ignoreCase===b.ignoreCase;case"[object Array]":var d=a.toString(),e=b.toString();return-1===d.indexOf("[object")&&-1===e.indexOf("[object")&&d===e}if("object"!=typeof a||"object"!=typeof b)return!1;if(g(a)&&g(b)){if(!s(x(a),x(b)))return!1;for(var f in a)if(a[f]!==b[f])return!1;return!0}return!1}var t,u=Object.prototype.toString,v=Object.prototype.hasOwnProperty;!function(){function a(){this.x=1}var b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);t="x"!==b[0]}();var w=Array.isArray||function(a){return"[object Array]"===u.call(a)},x=Object.keys;x||(x=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b});var y=/^(on|before|after)([A-Z].*)$/,z=/^(Change)?([A-Z])(.*)/,A=["value","getter","setter","readOnly"],B={initAttrs:function(a){var b=this.attrs={},c=this.propsInAttrs||[];j(b,this,c),a&&k(b,a),o(this,b,a),m(this,b),l(c,this,b,!0)},get:function(a){var b=this.attrs[a]||{},c=b.value;return b.getter?b.getter.call(this,c,a):c},set:function(a,b,c){var e={};d(a)?e[a]=b:(e=a,c=b),c||(c={});var f=c.silent,h=c.override,j=this.attrs,k=this.__changedAttrs||(this.__changedAttrs={});for(a in e)if(e.hasOwnProperty(a)){var l=j[a]||(j[a]={});if(b=e[a],l.readOnly)throw new Error("This attribute is readOnly: "+a);l.setter&&(b=l.setter.call(this,b,a));var m=this.get(a);!h&&g(m)&&g(b)&&(b=i(i({},m),b)),j[a].value=b,this.__initializingAttrs||s(m,b)||(f?k[a]=[b,m]:this.trigger("change:"+a,b,m,a))}return this},change:function(){var a=this.__changedAttrs;if(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];this.trigger("change:"+b,c[0],c[1],b)}delete this.__changedAttrs}return this},_isPlainObject:g};c.exports=B}),define("dist/lib/cmp/daparser",["$"],function(a,b){function c(a){return a.toLowerCase().replace(g,function(a,b){return(b+"").toUpperCase()})}function d(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];if("string"!=typeof c)continue;h.test(c)?(c=c.replace(/'/g,'"'),a[b]=d(i(c))):a[b]=e(c)}return a}function e(a){if("false"===a.toLowerCase())a=!1;else if("true"===a.toLowerCase())a=!0;else if(/\d/.test(a)&&/[^a-z]/i.test(a)){var b=parseFloat(a);b+""===a&&(a=b)}return a}var f=a("$");b.parseElement=function(a,b){a=f(a)[0];var e={};if(a.dataset)e=f.extend({},a.dataset);else for(var g=a.attributes,h=0,i=g.length;i>h;h++){var j=g[h],k=j.name;0===k.indexOf("data-")&&(k=c(k.substring(5)),e[k]=j.value)}return b===!0?e:d(e)};var g=/-([a-z])/g,h=/^\s*[\[{].*[\]}]\s*$/,i=this.JSON?JSON.parse:f.parseJSON}),define("dist/lib/cmp/auto-render",["$"],function(a,b){var c=a("$"),d="data-widget-auto-rendered";b.autoRender=function(a){return new this(a).render()},b.autoRenderAll=function(a,e){"function"==typeof a&&(e=a,a=null),a=c(a||document.body);var f=[],g=[];a.find("[data-widget]").each(function(a,c){b.isDataApiOff(c)||(f.push(c.getAttribute("data-widget").toLowerCase()),g.push(c))}),f.length&&seajs.use(f,function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],f=c(g[a]);if(!f.attr(d)){var h={initElement:f,renderType:"auto"},i=f.attr("data-widget-role");h[i?i:"element"]=f,b.autoRender&&b.autoRender(h),f.attr(d,"true")}}e&&e()})};var e="off"===c(document.body).attr("data-api");b.isDataApiOff=function(a){var b=c(a).attr("data-api");return"off"===b||"on"!==b&&e}}),define("dist/lib/cmp/tip/tpl/tip",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-poptip">  <div class="widget-poptip-shadow">  <div class="widget-poptip-container">  <div class="widget-poptip-arrow">  <em></em>  <span></span>  </div>  <div class="widget-poptip-content" data-role="content">  </div>  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/util/dom/action",["$"],function(a){var b=a("$"),c={dom:[],eventType:[],action:[]},d="data-action",e={setActionKey:function(a){d=a,e.setActionKey=null},listen:function(a,e,f){a=a||{},e=b(e?e:document),f=f||"click";var g=b.inArray(e[0],c.dom);if(-1!==g&&c.eventType[g]!==f&&(g=-1),-1===g)c.dom.push(e[0]),c.eventType.push(f),c.action.push(a),g=c.action.length-1,e[f](function(a){var e=b(a.target),f=e.attr(d),h=e;f||(h=e.closest("["+d+"]"),f=h.attr(d));var i=!0,j=c.action[g],k=j[f];if(k)if(b.isFunction(k.not)&&(k.node&&k.node[0]!==h[0]&&k.not.call(k.scope||e,a,k.node,f),k.node=h,k.using=!0),b.isFunction(k))i=k.call(e,a,h,f);else if(b.isFunction(k.is)||b.isFunction(k.action)){var l=k.is||k.action;i=l.call(k.scope||e,a,h,f)}for(var m=0,n=c.action.length;n>m;m++){var o=c.action[m];for(var p in o)p!==f&&o[p]&&o[p].not&&b.isFunction(o[p].not)&&o[p].using&&(o[p].using=!!o[p].not.call(o[p].scope||e,a,o[p].node,f))}if(-1===i)a.stopPropagation();else{if(i===!0)return!0;if(i===!1)return!1;a.preventDefault()}});else{var h=c.action[g];for(var i in a)h[i]=a[i]}return e}};return e}),define("dist/lib/cmp/switchable/tabs",["./switchable","$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./plugins/effects","../../util/dom/easing","./plugins/autoplay","./plugins/circular"],function(a,b,c){var d=a("./switchable");c.exports=d.extend({})}),define("dist/lib/cmp/switchable/switchable",["$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./plugins/effects","../../util/dom/easing","./plugins/autoplay","./plugins/circular"],function(a,b,c){function d(a,b,c,d){for(var e=f("<ul>"),g=0;a>g;g++){var h=g===b?c:"";f("<li>",{"class":h,html:g+1}).appendTo(e)}return d?e.children():e}function e(a){return{UI_SWITCHABLE:a||"",NAV_CLASS:a?a+"-nav":"",CONTENT_CLASS:a?a+"-content":"",TRIGGER_CLASS:a?a+"-trigger":"",PANEL_CLASS:a?a+"-panel":"",PREV_BTN_CLASS:a?a+"-prev-btn":"",NEXT_BTN_CLASS:a?a+"-next-btn":""}}var f=a("$"),g=a("../widget"),h=a("./plugins/effects"),i=a("./plugins/autoplay"),j=a("./plugins/circular"),k=g.extend({attrs:{triggers:{value:[],getter:function(a){return f(a)}},panels:{value:[],getter:function(a){return f(a)}},classPrefix:"ui-switchable",hasTriggers:!0,triggerType:"hover",delay:100,activeIndex:{value:0,setter:function(a){return parseInt(a)||0}},step:1,length:{readOnly:!0,getter:function(){return Math.ceil(this.get("panels").length/this.get("step"))}},viewSize:[],activeTriggerClass:{getter:function(a){return a?a:this.get("classPrefix")+"-active"}}},setup:function(){this._initConstClass(),this._initElement();var a=this._getDatasetRole();this._initPanels(a),this._initTriggers(a),this._bindTriggers(),this._initPlugins(),this.render()},_initConstClass:function(){this.CONST=e(this.get("classPrefix"))},_initElement:function(){this.element.addClass(this.CONST.UI_SWITCHABLE)},_getDatasetRole:function(){var a=this.element,b={},c=["trigger","panel","nav","content"];return f.each(c,function(c,d){var e=f("[data-role="+d+"]",a);e.length&&(b[d]=e)}),b},_initPanels:function(a){var b=this.get("panels");if(b.length>0||(a.panel?this.set("panels",b=a.panel):a.content&&(this.set("panels",b=a.content.find("> *")),this.content=a.content)),0===b.length)throw new Error("panels.length is ZERO");this.content||(this.content=b.parent()),this.content.addClass(this.CONST.CONTENT_CLASS),this.get("panels").addClass(this.CONST.PANEL_CLASS)},_initTriggers:function(a){var b=this.get("triggers");b.length>0||(a.trigger?this.set("triggers",b=a.trigger):a.nav?(b=a.nav.find("> *"),0===b.length&&(b=d(this.get("length"),this.get("activeIndex"),this.get("activeTriggerClass"),!0).appendTo(a.nav)),this.set("triggers",b),this.nav=a.nav):this.get("hasTriggers")&&(this.nav=d(this.get("length"),this.get("activeIndex"),this.get("activeTriggerClass")).appendTo(this.element),this.set("triggers",b=this.nav.children()))),!this.nav&&b.length&&(this.nav=b.parent()),this.nav&&this.nav.addClass(this.CONST.NAV_CLASS),b.addClass(this.CONST.TRIGGER_CLASS).each(function(a,b){f(b).data("value",a)})},_bindTriggers:function(){function a(a){c._onFocusTrigger(a.type,f(this).data("value"))}function b(){clearTimeout(c._switchTimer)}var c=this,d=this.get("triggers");"click"===this.get("triggerType")?d.click(a):d.hover(a,b)},_onFocusTrigger:function(a,b){var c=this;"click"===a?this.switchTo(b):this._switchTimer=setTimeout(function(){c.switchTo(b)},this.get("delay"))},_initPlugins:function(){this._plugins=[],this._plug(h),this._plug(i),this._plug(j)},switchTo:function(a){this.set("activeIndex",a)},_onRenderActiveIndex:function(a,b){this._switchTo(a,b)},_switchTo:function(a,b){this.trigger("switch",a,b),this._switchTrigger(a,b),this._switchPanel(this._getPanelInfo(a,b)),this.trigger("switched",a,b)},_switchTrigger:function(a,b){var c=this.get("triggers");c.length<1||(c.eq(b).removeClass(this.get("activeTriggerClass")),c.eq(a).addClass(this.get("activeTriggerClass")))},_switchPanel:function(a){a.fromPanels.hide(),a.toPanels.show()},_getPanelInfo:function(a,b){var c,d,e=this.get("panels").get(),g=this.get("step");return b>-1&&(c=e.slice(b*g,(b+1)*g)),d=e.slice(a*g,(a+1)*g),{toIndex:a,fromIndex:b,toPanels:f(d),fromPanels:f(c)}},prev:function(){var a=this.get("activeIndex"),b=(a-1+this.get("length"))%this.get("length");this.switchTo(b)},next:function(){var a=this.get("activeIndex"),b=(a+1)%this.get("length");this.switchTo(b)},_plug:function(a){var b=a.attrs;if(b)for(var c in b)!b.hasOwnProperty(c)||c in this.attrs||this.set(c,b[c]);a.isNeeded.call(this)&&(a.install&&a.install.call(this),this._plugins.push(a))},destroy:function(){var a=this;f.each(this._plugins,function(b,c){c.destroy&&c.destroy.call(a)}),k.superclass.destroy.call(this)}});c.exports=k}),define("dist/lib/cmp/switchable/plugins/effects",["$","../../../util/dom/easing"],function(a,b,c){var d=a("$");a("../../../util/dom/easing");var e="scrollx",f="scrolly",g="fade";c.exports={attrs:{effect:"none",easing:"linear",duration:500},isNeeded:function(){return"none"!==this.get("effect")},install:function(){var a=this.get("panels");a.show();var b=this.get("effect"),c=this.get("step");if(0===b.indexOf("scroll")){var f=this.content,i=a.eq(0);f.css("position","relative"),"static"===f.parent().css("position")&&f.parent().css("position","relative"),b===e&&(a.css("float","left"),f.width("9999px"));var j=this.get("viewSize");if(j[0]||(j[0]=i.outerWidth()*c,j[1]=i.outerHeight()*c,this.set("viewSize",j)),!j[0])throw new Error("Please specify viewSize manually")}else if(b===g){var k=this.get("activeIndex"),l=k*c,m=l+c-1;a.each(function(a,b){var c=a>=l&&m>=a;d(b).css({opacity:c?1:0,position:"absolute",zIndex:c?9:1})})}this._switchPanel=function(a){var b=this.get("effect"),c=d.isFunction(b)?b:h[b];c.call(this,a)}}};var h={fade:function(a){if(this.get("step")>1)throw new Error('Effect "fade" only supports step === 1');var b=a.fromPanels.eq(0),c=a.toPanels.eq(0);if(this.anim&&this.anim.stop(!1,!0),c.css("opacity",1),c.show(),a.fromIndex>-1){var d=this,e=this.get("duration"),f=this.get("easing");this.anim=b.animate({opacity:0},e,f,function(){d.anim=null,c.css("zIndex",9),b.css("zIndex",1),b.css("display","none")})}else c.css("zIndex",9)},scroll:function(a){var b=this.get("effect")===e,c=this.get("viewSize")[b?0:1]*a.toIndex,d={};if(d[b?"left":"top"]=-c+"px",this.anim&&this.anim.stop(),a.fromIndex>-1){var f=this,g=this.get("duration"),h=this.get("easing");this.anim=this.content.animate(d,g,h,function(){f.anim=null})}else this.content.css(d)}};h[f]=h.scroll,h[e]=h.scroll,c.exports.Effects=h}),define("dist/lib/util/dom/easing",["$"],function(a,b,c){var d=a("$"),e=Math.PI,f=Math.pow,g=Math.sin,h=1.70158,i={easeNone:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return(a*=2)<1?.5*a*a:.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return(a*=2)<1?.5*a*a*a*a:.5*(2-(a-=2)*a*a*a)},backIn:function(a){return 1===a&&(a-=.001),a*a*((h+1)*a-h)},backOut:function(a){return(a-=1)*a*((h+1)*a+h)+1},backBoth:function(a){var b=h,c=(b*=1.525)+1;return(a*=2)<1?.5*a*a*(c*a-b):.5*((a-=2)*a*(c*a+b)+2)},elasticIn:function(a){var b=.3,c=b/4;return 0===a||1===a?a:-(f(2,10*(a-=1))*g(2*(a-c)*e/b))},elasticOut:function(a){var b=.3,c=b/4;return 0===a||1===a?a:f(2,-10*a)*g(2*(a-c)*e/b)+1},elasticBoth:function(a){var b=.45,c=b/4;return 0===a||2===(a*=2)?a:1>a?-.5*f(2,10*(a-=1))*g(2*(a-c)*e/b):f(2,-10*(a-=1))*g(2*(a-c)*e/b)*.5+1},bounceIn:function(a){return 1-i.bounceOut(1-a)},bounceOut:function(a){var b,c=7.5625;return b=1/2.75>a?c*a*a:2/2.75>a?c*(a-=1.5/2.75)*a+.75:2.5/2.75>a?c*(a-=2.25/2.75)*a+.9375:c*(a-=2.625/2.75)*a+.984375},bounceBoth:function(a){return.5>a?.5*i.bounceIn(2*a):.5*i.bounceOut(2*a-1)+.5}};c.exports=i,d.extend(d.easing,i)}),define("dist/lib/cmp/switchable/plugins/autoplay",["$"],function(a,b,c){function d(a,b){function c(){c.stop(),d=setTimeout(a,b)}b=b||200;var d;return c.stop=function(){d&&(clearTimeout(d),d=0)},c}function e(a){var b=g.scrollTop(),c=b+g.height(),d=a.offset().top,e=d+a.height();return c>d&&e>b}var f=a("$"),g=f(window);c.exports={attrs:{autoplay:!1,interval:5e3},isNeeded:function(){return this.get("autoplay")},install:function(){function a(){b(),j.paused=!1,c=setInterval(function(){j.paused||j.next()},i)}function b(){c&&(clearInterval(c),c=null),j.paused=!0}var c,f=this.element,h="."+this.cid,i=this.get("interval"),j=this;a(),this.stop=b,this.start=a,this._scrollDetect=d(function(){j[e(f)?"start":"stop"]()}),g.on("scroll"+h,this._scrollDetect),this.element.hover(b,a)},destroy:function(){var a="."+this.cid;this.stop&&this.stop(),this._scrollDetect&&(this._scrollDetect.stop(),g.off("scroll"+a))}}}),define("dist/lib/cmp/switchable/plugins/circular",["$","./effects","../../../util/dom/easing"],function(a,b,c){function d(a,b,c){var d=this.get("step"),e=this.get("length"),g=a?e-1:0,h=g*d,i=(g+1)*d,j=a?c:-c*e,k=a?-c*e:c*e,l=f(this.get("panels").get().slice(h,i));return l.css("position","relative"),l.css(b,k+"px"),j}function e(a,b,c){var d=this.get("step"),e=this.get("length"),g=a?e-1:0,h=g*d,i=(g+1)*d,j=f(this.get("panels").get().slice(h,i));j.css("position",""),j.css(b,""),this.content.css(b,a?-c*(e-1):"")}var f=a("$"),g="scrollx",h="scrolly",i=a("./effects").Effects;c.exports={isNeeded:function(){var a=this.get("effect"),b=this.get("circular");return b&&(a===g||a===h)},install:function(){this._scrollType=this.get("effect"),this.set("effect","scrollCircular")}},i.scrollCircular=function(a){var b=a.toIndex,c=a.fromIndex,f=this._scrollType===g,h=f?"left":"top",i=this.get("viewSize")[f?0:1],j=-i*b,k={};if(k[h]=j+"px",c>-1){this.anim&&this.anim.stop(!1,!0);var l=this.get("length"),m=!1,n=c===l-1&&0===b,o=m||!n&&c>b,p=m||n;p&&(j=d.call(this,o,h,i),k[h]=j+"px");var q=this.get("duration"),r=this.get("easing"),s=this;this.anim=this.content.animate(k,q,r,function(){s.anim=null,p&&e.call(s,o,h,i)})}else this.content.css(k)}}),define("dist/app/common/helper/inputor",["$","../../../lib/util/dom/selection","../../../lib/util/dom/inputor","../../../lib/util/timer","../../../lib/util/string"],function(a,b,c){var d=a("$"),e=a("../../../lib/util/dom/selection"),f=a("../../../lib/util/dom/inputor"),g=a("../../../lib/util/string"),h={selection:function(a){a=d(a);var b=a.data("selection");return b||(b=e(a),a.data("selection",b)),b},showComments:function(a){var b=this.getEditorWrap(a),c=b.find(".comments");c.hasClass("hide")&&c.removeClass("hide")},getTextarea:function(a){a=d(a);var b=a.closest("[data-role=editor-wrap]"),c=b.find("textarea[data-role=editor]").eq(0);return c},getEditorWrap:function(a){a=d(a);var b=a.closest("[data-role=editor-wrap]");return b},listenWordcount:function(a,b,c){c=c||{};var d=c.total||2e3,e=c.step||300;f(a,function(){h.wordcount(a,d,b)},{timer:e||300})},wordcount:function(a,b,c){var d=!1,e=!0,f=a.val(),h=g.blength(f,!0);b=b||2e3;var i=b-h;0>i?(d=!0,e=!1):(d=!1,e=!1),0!==h&&f.match(/\S/)||(d=!1,e=!0),c&&c(i,d,e)}};c.exports=h}),define("dist/lib/util/dom/selection",["$"],function(a,b,c){function d(a,b){return this.element=a,this.cursor=function(a,c){var d=this.element;if("undefined"==typeof a)return b?f(d):[d.selectionStart,d.selectionEnd];if(m(a)){var e=a;a=e[0],c=e[1]}return"undefined"==typeof c&&(c=a),b?g(d,a,c):d.setSelectionRange(a,c),this},this}function e(a){if(a)this.text=function(){return document.selection.createRange().text};else{var b=window.getSelection();this.element=i(b),this.text=function(){return b.toString()}}return this}function f(a){var b,c,d=document.selection.createRange(),e=a.value.length,f=a.value.replace(/\r\n/g,"\n"),g=a.createTextRange();g.moveToBookmark(d.getBookmark());var h=a.createTextRange();return h.collapse(!1),g.compareEndPoints("StartToEnd",h)>-1?b=c=e:(b=-g.moveStart("character",-e),b+=f.slice(0,b).split("\n").length-1,g.compareEndPoints("EndToEnd",h)>-1?c=e:(c=-g.moveEnd("character",-e),c+=f.slice(0,c).split("\n").length-1)),[b,c]}function g(a,b,c){var d=a.createTextRange(),e=a.value.slice(0,b).match(/\r\n/g,"\n");e=e?e.length:0,d.move("character",b-e),d.moveEnd("character",c-b),d.select()}function h(a,b,c,d,e){"undefined"==typeof b&&(b="");var f=a.element.value;return a.element.value=[f.slice(0,c),b,f.slice(d)].join(""),d=c+b.length,"left"===e?a.cursor(c):"right"===e?a.cursor(d):a.cursor(c,d),a}function i(a){for(var b=null,c=a.anchorNode,d=a.focusNode;!b;){if(c.parentElement===d.parentElement){b=d.parentElement;break}c=c.parentElement,d=d.parentElement}return b}var j=a("$"),k=function(a){if(a=j(a).eq(0)[0]){if("undefined"!=typeof a.selectionStart)return new d(a);var b=a.tagName.toLowerCase()}if(b&&("textarea"===b||"input"===b))return new d(a,!0);if(window.getSelection)return new e;if(document.selection)return new e(!0);throw new Error("your browser is very weird")};c.exports=k,d.prototype.text=function(a,b){var c=this.element,d=this.cursor();return"undefined"==typeof a?c.value.slice(d[0],d[1]):h(this,a,d[0],d[1],b)},d.prototype.append=function(a,b){var c=this.cursor()[1];return h(this,a,c,c,b)},d.prototype.prepend=function(a,b){var c=this.cursor()[0];return h(this,a,c,c,b)},d.prototype.surround=function(a){"undefined"==typeof a&&(a=1);var b=this.element.value,c=this.cursor(),d=b.slice(Math.max(0,c[0]-a),c[0]),e=b.slice(c[1],c[1]+a);return[d,e]},d.prototype.line=function(){var a=this.element.value,b=this.cursor(),c=a.slice(0,b[0]).lastIndexOf("\n"),d=a.slice(b[1]).indexOf("\n"),e=c+1;if(-1===d)return a.slice(e);var f=b[1]+d;return a.slice(e,f)},d.prototype.insertText=function(a,b,c){var d=h(this,a,b[0],b[1],void 0);return c&&(b=this.cursor(),this.cursor(b[1],b[1])),d};var l=Object.prototype.toString,m=Array.isArray;m||(m=function(a){return"[object Array]"===l.call(a)})}),define("dist/lib/util/dom/inputor",["$","../timer"],function(a,b,c){var d=a("$"),e=a("../timer"),f=function(a,b,c){a=d(a),c=c||{};var f=a.val(),g=!1,h=e.debounce(function(d){if(g){var e=a.val();(c.keep===!0||d===!0||e!==f)&&(b(e,a),f=e),g&&h()}},c.timer||128);a.bind("focus.timer",function(){g=!0,h(!0)}),a.bind("blur.timer",function(){c.silentBlur||b(a.val(),a),g=!1})};d.fn.timer=function(a,b){this.each(function(){f(this,a,b)})},c.exports=f}),define("dist/lib/util/timer",[],function(a,b,c){var d={throttle:function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},debounce:function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}}};c.exports=d}),define("dist/app/common/expression/tpl/container",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div data-role="expression-container" class="expression-container">  <div class="expr-panels"></div>  <div class="expr-tabs"></div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/expression/tpl/item",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="expr-option" title="\',data,\'" data-tip="\',data,\'" data-action="expression-item"></div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/expression/tpl/expression",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <img src=\"/static/themes/default/images/parsed/',index,'.gif\" alt=\"[',name,']\" title=\"',name,'\"/>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/expression/data",[],function(a,b,c){c.exports=["微笑2","撇嘴1","色4","发呆2","得意1","流泪2","害羞5","闭嘴1","睡","大哭7","尴尬1","发怒","调皮1","呲牙","惊讶4","难过","酷","冷汗","抓狂","吐","偷笑2","可爱1","白眼1","傲慢","饥饿2","困","惊恐1","流汗2","憨笑","大兵","奋斗1","咒骂","疑问2","嘘","晕3","折磨1","衰1","骷髅","敲打","再见","擦汗","抠鼻","鼓掌1","糗大了","坏笑1","左哼哼","右哼哼","哈欠","鄙视2","委屈1","快哭了","阴险","亲亲","吓","可怜2","菜刀","西瓜","啤酒","篮球","乒乓","咖啡","饭","猪头","玫瑰","凋谢","示爱","爱心","心碎","蛋糕","闪电","炸弹","刀","足球","瓢虫","便便","月亮","太阳","礼物","拥抱","强","弱","握手","胜利","抱拳","勾引","拳头","差劲","爱你","NO","OK","爱情","飞吻1","跳跳","发抖","怄火","转圈","磕头","回头","跳绳","挥手","激动3","街舞","献吻","左太极","右太极"]}),define("dist/lib/util/date",[],function(a,b,c){var d=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=function(a){return(0>a||a>9?"":"0")+a},g=function(a,b,c,d){for(var e=d;e>=c;e--){var f=a.substring(b,b+e);if(f.length<c)return null;if(/^\d+$/.test(f))return f}return null},h={isLeap:function(a){return a%4===0&&a%100!==0||a%400===0},check:function(a,b){var c=h.stringToDate(a,b);return 0!==c},compare:function(a,b){var c=a.getTime(),d=b.getTime();return c>d?-1:d>c?1:0},stringCompare:function(a,b,c,d){var e=h.stringToDate(a,b),f=h.stringToDate(c,d);return h.compare(e,f)},stringToDate:function(a,b){a+="",b=b||"yyyy-MM-dd";for(var c,f,i,j=0,k=0,l="",m="",n=1970,o=1,p=1,q=0,r=0,s=0,t="";k<b.length;){for(l=b.charAt(k),m="";b.charAt(k)===l&&k<b.length;)m+=b.charAt(k++);if("yyyy"===m||"yy"===m||"y"===m){if("yyyy"===m&&(c=4,f=4),"yy"===m&&(c=2,f=2),"y"===m&&(c=2,f=4),n=g(a,j,c,f),null===n)return 0;j+=n.length,2===n.length&&(n=n>70?1900+(n-0):2e3+(n-0))}else if("MMM"===m||"NNN"===m){for(o=0,i=0;i<d.length;i++){var u=d[i];if(a.substring(j,j+u.length).toLowerCase()===u.toLowerCase()&&("MMM"===m||"NNN"===m&&i>11)){o=i+1,o>12&&(o-=12),j+=u.length;break}}if(1>o||o>12)return 0}else if("EE"===m||"E"===m)for(i=0;i<e.length;i++){var v=e[i];if(a.substring(j,j+v.length).toLowerCase()===v.toLowerCase()){j+=v.length;break}}else if("MM"===m||"M"===m){if(o=g(a,j,m.length,2),null===o||1>o||o>12)return 0;j+=o.length}else if("dd"===m||"d"===m){if(p=g(a,j,m.length,2),null===p||1>p||p>31)return 0;j+=p.length}else if("hh"===m||"h"===m){if(q=g(a,j,m.length,2),null===q||1>q||q>12)return 0;j+=q.length}else if("HH"===m||"H"===m){if(q=g(a,j,m.length,2),null===q||0>q||q>23)return 0;j+=q.length}else if("KK"===m||"K"===m){if(q=g(a,j,m.length,2),null===q||0>q||q>11)return 0;j+=q.length}else if("kk"===m||"k"===m){if(q=g(a,j,m.length,2),null===q||1>q||q>24)return 0;j+=q.length,q--}else if("mm"===m||"m"===m){if(r=g(a,j,m.length,2),null===r||0>r||r>59)return 0;j+=r.length}else if("ss"===m||"s"===m){if(s=g(a,j,m.length,2),null===s||0>s||s>59)return 0;j+=s.length}else if("a"===m){if("am"===a.substring(j,j+2).toLowerCase())t="AM";else{if("pm"!==a.substring(j,j+2).toLowerCase())return 0;t="PM"}j+=2}else{if(a.substring(j,j+m.length)!==m)return 0;j+=m.length}}if(j!==a.length)return 0;if(2===o)if(h.isLeap(n)){if(p>29)return 0}else if(p>28)return 0;return(4===o||6===o||9===o||11===o)&&p>30?0:(12>q&&"PM"===t?q=q-0+12:q>11&&"AM"===t&&(q-=12),new Date(n,o-1,p,q,r,s))},format:function(a,b){b=b||"yyyy-MM-dd";var c,g="",h=0,i="",j="",k=a.getYear()+"",l=a.getMonth()+1,m=a.getDate(),n=a.getDay(),o=a.getHours(),p=a.getMinutes(),q=a.getSeconds(),r={};for(k.length<4&&(k=""+(k-0+1900)),r.y=""+k,r.yyyy=k,r.yy=k.substring(2,4),r.M=l,r.MM=f(l),r.MMM=d[l-1],r.NNN=d[l+11],r.d=m,r.dd=f(m),r.E=e[n+7],r.EE=e[n],r.H=o,r.HH=f(o),r.h=0===o?12:o>12?o-12:o,r.hh=f(r.h),r.K=o>11?o-12:o,r.k=o+1,r.KK=f(r.K),r.kk=f(r.k),r.a=o>11?"PM":"AM",r.m=p,r.mm=f(p),r.s=q,r.ss=f(q);h<b.length;){for(i=b.charAt(h),j="";b.charAt(h)===i&&h<b.length;)j+=b.charAt(h++);g+=null!==r[j]&&r[j]!==c?r[j]:j}return g},distance:function(a,b,c){var d,e,g=0;if("y"===c)return d=h.format(a,"yyyy-MM-dd HH:mm:ss").split("-"),e=d[0]-0+b,h.stringToDate(e+"-"+d[1]+"-"+d[2],"yyyy-MM-dd HH:mm:ss");if("q"===c||"M"===c){"q"===c&&(b*=3);var i=b%12,j=(b-i)/12;d=h.format(a,"yyyy-MM-dd HH:mm:ss").split("-"),e=d[0]-0+j;var k=d[1]-0+i,l=d[2].split(" "),m=l[0];return 0>=k?(k+=12,e-=1):k>12&&(k-=12,e+=1),m=2===k?h.isLeap(e)?m>29?29:m:m>28?28:m:4===k||6===k||9===k||11===k?m>30?30:m:m>31?31:m,h.stringToDate(e+"-"+f(k)+"-"+m+" "+l[1],"yyyy-MM-dd HH:mm:ss")}return g="h"===c?36e5*b:"m"===c?6e4*b:"s"===c?1e3*b:"w"===c?6048e5*b:864e5*b,new Date(a.getTime()+g)}};c.exports=h}),define("dist/app/common/action/action",["$","../../../lib/util/dom/action","./api","../ajax","../_ajax","../../../lib/util/event","../../../lib/util/json","../dialog/singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../singleton-tip","../new-weibo","../weibo-textarea","../../../lib/cmp/autocomplete/textarea-complete","../../../lib/util/dom/selection","../../../lib/cmp/autocomplete/autocomplete","../../../lib/util/dom/inputor","../../../lib/util/timer","../../../lib/cmp/autocomplete/data-source","../../../lib/cmp/autocomplete/filter","../../../lib/cmp/autocomplete/tpl/autocomplete","../helper/inputor","../../../lib/util/string","../../../lib/util/dom/placeholder","../weibo-manager","../tpl/weibo","../tpl/comment","../tpl/weibo-pic","../../../lib/util/date","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../../lib/util/dom/image","../upload-pic","../../../lib/util/dom/upload/upload","../../../lib/util/dom/upload/upload-swfupload","../../../lib/util/dom/upload/swfupload","../../../lib/util/dom/upload/upload-html5","../../../lib/util/dom/upload/upload-draggable","../tpl/pic","../helper/global","../tpl/user/avatar","../tpl/user/user-link","../expression/expression","../../../lib/cmp/tip/tip","../../../lib/cmp/tip/basic-tip","../../../lib/cmp/popup","../../../lib/cmp/tip/tpl/tip","../../../lib/cmp/switchable/tabs","../../../lib/cmp/switchable/switchable","../../../lib/cmp/switchable/plugins/effects","../../../lib/util/dom/easing","../../../lib/cmp/switchable/plugins/autoplay","../../../lib/cmp/switchable/plugins/circular","../expression/tpl/container","../expression/tpl/item","../expression/tpl/expression","../expression/data","../dialog/new-weibo","../dialog/tpl/new-weibo","../dialog/repost","../dialog/tpl/repost","../dialog/tpl/repost-referer","../dialog/pic-display","../dialog/tpl/pic-display","../dialog/praise-list","../dialog/tpl/praise-list","../dialog/tpl/praise-data","../../user/ajaxCommon","../../user/ajaxCallback","../handler","../tpl/no-data","../tpl/weiboinfo","../tpl/userinfo","../../message/tpl/praise","../tpl/no-result","../tpl/weibo-del","../query","../../attention/ajaxCommon","../tpl/comments","../tpl/recomm-user"],function(a){function b(a,b){var c=d(".dashboard .recommand .content");
d.each(a.users,function(a,e){var f=0,g=e.idols.uid;if(c.find(".user").find(".button").each(function(a,b){var c=d(b).data("uid");+c!==+g&&f++}),3===f){var h=q.recommtpl.render(e);if(0===b)c.prepend(h);else{var i=c.find(".user").eq(b-1);d(h).insertAfter(i)}return c.find(".user").eq(b+1).remove(),!1}})}var c,d=a("$"),e=a("../../../lib/util/dom/action"),f=a("./api"),g=(a("../dialog/singleton"),a("../singleton-tip")),h=(a("../../../lib/cmp/dialog/dialog"),a("../../../lib/cmp/dialog/confirm-box")),i=(a("../new-weibo"),a("../weibo-textarea")),j=a("../weibo-manager"),k=a("../pagenation"),l=a("../helper/global"),m=a("../helper/inputor"),n=(a("../expression/expression"),a("../dialog/new-weibo")),o=(a("../dialog/repost"),a("../dialog/pic-display"),a("../dialog/praise-list"),a("../../user/ajaxCommon")),p=a("../../attention/ajaxCommon"),q={comment:a("../tpl/comment"),commentList:a("../tpl/comments"),recommtpl:a("../tpl/recomm-user")},r={commentTextarea:function(a){var b=a.closest("[data-role=editor-wrap]"),c=b.find(".input-group").eq(0),d=b.find("[data-role=send-comment-bar]").eq(0),e=d.find("[data-action=sendComment]").eq(0),f=a.data("at");f||(a.data("at",!0),new i({trigger:a}).render(),m.listenWordcount(a,function(a,b,c){c||b?e.addClass("disabled").removeClass("abled"):e.addClass("abled").removeClass("disabled")},{total:140}),a.trigger("focus.timer")),c.addClass("active"),d.show()}};d(function(){e.listen({seeNewWeibo:function(a,b){b=b.closest("[data-role=see-new-weibo]"),b.hide(),j.requestNew()},deleteWeibo:function(a,b){h.confirm({header:!1,closable:!1,content:"确定删除这条动态信息？",height:132,buttons:[{text:"取消",className:"cancel btn"},{text:"删除",action:"submit",className:"confirm btn"}],className:"delcontent"}).on("submit",function(){var a=this,c=b.closest(".weibo[data-tid]");f.deleteWeibo(c.attr("data-tid"),function(){c.slideUp(function(){j.remove(c);var a=d(".info-counts li.userweb .num");a&&a.length>0&&a.text(+a.text()-1)})}).then(function(){a.hide()})})},showLongText:function(a,b){var c=b.closest("[data-role=content-wrap]"),d=c.find("[data-role=long-content]"),e=c.find("[data-role=content]"),f=c.find("[data-role=unfold-btn]"),g=c.find("[data-role=fold-btn]");e.slideUp(function(){e.hide(),d.slideDown()}),f.hide(),g.show()},hideLongText:function(a,b){var c=b.closest("[data-role=content-wrap]"),d=c.find("[data-role=long-content]"),e=c.find("[data-role=content]"),f=c.find("[data-role=unfold-btn]"),g=c.find("[data-role=fold-btn]");d.slideUp(function(){d.hide(),e.slideDown()}),f.show(),g.hide()},favorite:function(a,b){var c=b.closest(".weibo[data-tid]");f.favorite(c.attr("data-tid"),function(){b.addClass("active").attr("data-action","unfavorite").attr("title","取消收藏");var a=d(".info-counts li.favor .num");a&&a.length>0&&a.text(+a.text()+1)})},unfavorite:function(a,b){var c=b.closest(".weibo"),e=c.data("tid")?"tid":"id";c.length&&f.unfavorite(c.attr("data-"+e),e,function(){b.removeClass("active").attr("data-action","favorite").attr("title","收藏"),c.closest(".weiboinfos").data("favor")&&c.slideUp(function(){c.eq(0).remove()});var a=d(".info-counts li.favor .num");a&&a.length>0&&a.text(+a.text()-1)})},praise:function(a,b){var c=b.closest(".weibo[data-tid]"),d=b.children("span:first");f.praise(c.attr("data-tid"),function(){var a=+d.text()+1;b.addClass("active").attr("data-action","cancelPraise").attr("title","取消赞"),d.text(a),1===a&&d.addClass("praisecount"),c.find(".support>.users").append(l.avatar(Global.user))})},cancelPraise:function(a,b){var c=b.closest(".weibo[data-tid]"),d=b.children("span:first");f.cancelPraise(c.attr("data-tid"),function(){var a=d.text()-1;b.removeClass("active").attr("data-action","praise").attr("title","赞"),a>0?d.text(a):d.text("").removeClass("praisecount"),c.find(".support [data-uid="+Global.user.uid+"]").remove()})},follow:function(a,e){f.follow(e.attr("data-uid"),function(){var a=e.attr("data-role");if("editor-followed"===a){e.text("互相关注").removeClass("follow-button").addClass("atten-button");var f=d(".info-counts li.fans .num");f.text(+f.text()+1)}else if("is-follow"===a){e.addClass("attened-btn").removeClass("attention-btn");var g=d(".info-counts li.idols .num");g.text(+g.text()+1),d(".info-counts li.idols").hasClass("active")&&o.fans(1,!0)}else if("editor-follow"===a){var f=d(".info-counts li.fans .num");f.text(+f.text()+1),e.text("正在关注").removeClass("follow-button").addClass("following-btn")}else e.text("正在关注").removeClass("follow-button").addClass("following-btn"),c=setTimeout(function(){p.getList(function(a){var c=e.closest(".content").find(".button").index(e[0]);c>-1&&b(a,c)})},5e3);e.attr("data-action","unfollow")})},unfollow:function(a,b){f.unfollow(b.attr("data-uid"),function(){var a=b.attr("data-role");if("editor-followed"===a||"editor-follow"===a){b.text("关注").removeClass("following-btn atten-button").addClass("follow-button");var e=d(".info-counts li.fans .num");e.text(+e.text()-1)}else if("is-follow"===a){b.addClass("attention-btn").removeClass("attened-btn");var f=d(".info-counts li.idols .num");f.text(+f.text()-1),d(".info-counts li.idols").hasClass("active")&&o.fans(1,!0)}else b.text("关注").removeClass("following-btn").addClass("follow-button"),clearTimeout(c);b.attr("data-action","follow")})},unfoldComments:function(a,b){function c(a){j.empty(),a.tpl={comment:q.comment},a.topic={own:l},j.html(q.commentList.render(a))}var d=1,e=b.closest(".weibo[data-tid]"),g=e.attr("data-tid"),h=e.find(".commentpage"),i=e.find(".comments"),j=e.find("[data-role=next-time]"),l=+e.find("[data-role=user]").eq(0).attr("data-uid")===Global.user.uid,m=10;f.requestComments(g,d,m,function(a){var b=!0;new k({parentNode:h,showPN:!1,total:a.total,size:m,success:function(a){return b?void(b=!1):void f.requestComments(g,a,m,c)}}).render(),i.addClass("unfold"),c(a)})},foldComments:function(a,b){var c=b.closest(".weibo[data-tid]"),d=c.find(".commentpage"),e=c.find(".comments");e.removeClass("unfold"),d.empty()},openComment:{is:function(a,b){r.commentTextarea(m.getTextarea(b))},not:function(a,b,c){var d=b.closest("textarea").eq(0);if(d.length||(d=b.find("textarea").eq(0)),"expression"!==c&&"replyComment"!==c){var e=d.val();if(0===e.length||/^回复@[^:]{1,5}:$/.test(e)){var f=b.closest("[data-role=editor-wrap]"),g=f.find(".input-group").eq(0),h=f.find("[data-role=send-comment-bar]").eq(0);d.val(""),g.removeClass("active"),h.hide(),d.blur()}}}},sendComment:function(a,b){if(b.hasClass("abled")){var c=b.closest(".weibo[data-tid]"),d=c.find(".input-group").eq(0),e=c.find("[data-role=editor]").eq(0),g=c.find("[data-role=send-comment-bar]").eq(0),h=g.find("[data-action=sendComment]").eq(0),j=c.find("[data-role=first-time]").eq(0),k=c.find("[data-role=comment-count]").eq(0),l=+c.find("[data-role=user]").eq(0).attr("data-uid")===Global.user.uid,m=e.data("rid"),n=e.data("rname"),o=e.val(),p=function(a,b){d.removeClass("active"),g.hide(),e.val(""),h.addClass("disabled").removeClass("abled"),j.prepend(q.comment.render({item:a,topic:{own:l}})),k.text(+k.text()+1),i.clear(e),b&&b(a)},r="回复@"+n+":";m&&o.indexOf(0===r)?(o=o.replace(r,""),f.reply(c.attr("data-tid"),m,i.transfer(e,o),function(a){p(a,function(){e.removeData("rid").removeData("rname")})})):f.comment(c.attr("data-tid"),i.transfer(e),p)}},replyComment:function(a,b){m.showComments(b);var c=m.getTextarea(b),d=b.closest(".comment"),e=d.find("[data-role=user]").eq(0),f=e.find("[data-role=username]").eq(0).text();r.commentTextarea(c),i.selectedUsersAdd(c,f,e.attr("data-uid")),c.val("回复@"+f+":"),c.data("rid",d.attr("data-id")).data("rname",f),c.focus().data("selection").cursor(c.val().length),setTimeout(function(){c.click()},0)},deleteComment:function(a,b){h.confirm({header:!1,closable:!1,content:"确定删除这条评论？",height:132,buttons:[{text:"取消",className:"cancel btn"},{text:"删除",action:"submit",className:"confirm btn"}],className:"delcontent"}).on("submit",function(){var a=this,c=b.closest(".comment"),d=b.closest(".weibo[data-tid]"),e=d.attr("data-tid"),g=c.eq(0).attr("data-id"),h=d.find("[data-role=comment-count]").eq(0);f.deleteComment(e,g,function(){c.slideUp(function(){c.eq(0).remove()}),h.text(+h.text()-1)}).then(function(){a.hide()})})},at:function(a,b){var c=m.getTextarea(b),d=m.selection(c),e=d.cachedCursor;d.insertText("@",e,!0),d.cursor(e[0]+1,e[0]+1),c.focus()},topic:function(a,b){var c=m.getTextarea(b),d=m.selection(c),e=d.cachedCursor;d.insertText(b.attr("data-tip")||"#请输入话题#",e),d.cursor(e[0]+1,e[0]+6),c.focus()},toggleUploadPic:function(a,b){var c=m.getEditorWrap(b),d=c.find(".gear.pic-button");return d.hasClass("active")?(d.removeClass("active"),c.find(".pic-upload").hide()):(d.addClass("active"),c.find(".pic-upload").show())},submitNewWeibo:function(a,b){var c=d(b),e=m.getEditorWrap(b),h=m.getTextarea(b),k=h.data("atCache"),l=e.data("default")||"";if(!k.sending&&k.validate()){k.sending=!0;var o=d.map(d(".pic-wrapper",e),function(a){return d(a).data("image-id")}).join(","),p={category:"text",content:i.transfer(h),extra_id:o};c.addClass("sending"),f.submitNewWeibo(p).done(function(a){n.instance&&n.instance.hide(),j.prependNew(a),e.removeClass("active");var b=e.find(".gear.pic-button");b.removeClass("active"),e.find(".pic-upload").hide(),k.u.reset(),i.clear(h,l)}).fail(function(){g.error("发送失败")}).then(function(){k.sending=!1,c.removeClass("sending"),k.validate()})}}})})}),define("dist/app/common/action/api",["$","../ajax","../_ajax","../../../lib/util/event","../../../lib/util/json","../dialog/singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button"],function(a,b,c){var d=(a("$"),a("../ajax")),e={common:function(a,b,c,e){return d({url:a,method:b,data:e}).done(function(a){c&&c(a)})}},f={deleteWeibo:function(a,b){var c="/topic_api/topic/tid/"+a;return e.common(c,"DELETE",b)},favorite:function(a,b){var c="/favorite_api/favorite/tid/"+a;return e.common(c,"POST",b)},unfavorite:function(a,b,c){var d="/favorite_api/favorite/"+b+"/"+a;return e.common(d,"DELETE",c)},praise:function(a,b){var c="/praise_api/praise/tid/"+a;return e.common(c,"POST",b)},cancelPraise:function(a,b){var c="/praise_api/praise/tid/"+a;return e.common(c,"DELETE",b)},follow:function(a,b){var c="/relation_api/idol/uid/"+Global.user.uid+"/idol_uid/"+a;return e.common(c,"POST",b)},unfollow:function(a,b){var c="/relation_api/idol/idol_uid/"+a;return e.common(c,"DELETE",b)},requestComments:function(a,b,c,d){var f="/reply_api/replylist/tid/"+a+"/page_size/"+c+"/page/"+b;return e.common(f,"GET",d)},repost:function(a,b,c,d){d=d||{};var f="/topic_api/repost",g={content:d.decode?encodeURIComponent(b):b,root_tid:a,reply_flag:0,weibo_tid:0};return e.common(f,"POST",c,g)},deleteComment:function(a,b,c){var d="/reply_api/reply/tid/"+a+"/rid/"+b;return e.common(d,"DELETE",c)},submitNewWeibo:function(a){return d({url:"/topic_api/topic",method:"POST",data:a})},comment:function(a,b,c,d){d=d||{};var f="/reply_api/reply/tid/"+a,g={content:d.decode?encodeURIComponent(b):b,reflag:0,relay:0};return e.common(f,"POST",c,g)},reply:function(a,b,c,d,f){f=f||{};var g="/reply_api/comment/tid/"+a+"/rid/"+b,h={content:f.decode?encodeURIComponent(c):c,reflag:0,relay:0};return e.common(g,"POST",d,h)},praiseList:function(a,b,c,d){var f="/praise_api/praisors/tid/"+a+"/page_size/"+c+"/page/"+b;return e.common(f,"GET",d)}};c.exports=f}),define("dist/app/common/ajax",["./_ajax","../../lib/util/event","$","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button"],function(a,b,c){function d(a,b){var c=h.extend({},i);if(a instanceof Array){var d=f.stringify(a);c=h.extend(c,{method:"POST",url:"/adapter/m",data:d});var g=h.map(a,function(a,b){return b=h.extend(b,i),e(b,!0)}),j=e(h.extend(c,{success:function(a,b,c){return this.trigger("done",a,b,c),this}}));return j.on("done",function(a){h.each(g,function(b,c){c.success(a[b])})}),g}c=h.extend(c,a),a.method&&"GET"===a.method.toUpperCase()?c.method="GET":(c.method="POST","DELETE"===a.method.toUpperCase()&&(a.data=a.data||{},a.data.method="delete"),c.data=f.stringify(a.data),c.contentType="application/json; charset=UTF-8");var k=a.url;return h.isFunction(k)&&(k=k()),c.url="/adapter/s"+k,e(c,b)}var e=a("./_ajax"),f=a("../../lib/util/json"),g=a("./dialog/singleton"),h=a("$"),i={success:function(a,b,c){switch(a.code){case 401:this.trigger("not-allowed",a,b,c);break;case 200:this.trigger("done",a.data,b,c);break;default:this.trigger("fail",a,b,c)}return this},dataType:"json",defaults:{"not-allowed":function(){window.location="/login?ret="+window.location},timeout:function(){var a=this;setTimeout(function(){a.resend()},5e3)},"no-found":function(){g.show({title:"404",content:"请求资源不存在",buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog"})},fail:function(a){g.show({title:"请求异常",content:a&&a.data&&a.data.msg||"请求异常",buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog"})},"server-error":function(){g.show({title:"服务器内部错误",content:"服务器内部错误",buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog"})}}};c.exports=d}),define("dist/app/common/_ajax",["../../lib/util/event","$"],function(a,b,c){function d(a,b){function c(){var b=d.ajax||{};return b.abort&&b.abort(),d.ajax=f.ajax(a),d.abort=function(){return d.ajax.abort()},d}var d=new e;return f.extend(d,{done:function(a){return this.on("done",a),this},fail:function(a){return this.on("fail",a),this},then:function(a){return this.on("always",a),this}}),a.timeout=a.timeout||6e4,a.success=a.success||function(a,b,c){return this.trigger("done",a,b,c),this},a.success=f.proxy(a.success,d),a.error=a.error||function(a,b,c){if(0===a.readyState&&("timeout"===b?this.trigger("timeout",a,b,c):this.trigger("disconnect",a,b,c)),4===a.readyState){var d=a.status;switch(d){case 401:this.trigger("not-allowed",a,b,c);break;case 403:this.trigger("no-permission",a,b,c);break;case 404:this.trigger("not-found",a,b,c);break;case 500:this.trigger("server-error",a,b,c)}}return this.trigger("error",a,b,c),this},a.error=f.proxy(a.error,d),a.complete=a.complete||function(a,b){return this.trigger("always",a,b),this},a.complete=f.proxy(a.complete,d),a.defaults&&f.each(a.defaults,function(a,b){d.on(a,b,d)}),b?f.extend(d,{success:a.success,resend:function(){},abort:function(){}}):(d.resend=c,d=c())}var e=a("../../lib/util/event"),f=a("$");c.exports=d}),define("dist/lib/util/json",[],function(require,exports,module){"object"!=typeof JSON&&(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","        ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),module.exports=window.JSON}),define("dist/app/common/dialog/singleton",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button"],function(a,b,c){var d,e=(a("$"),a("../../../lib/cmp/dialog/confirm-box")),f=e.extend({show:function(a){return this.get("visible")&&this.hide(),f.superclass.show.call(this,a),this}});f.show=function(a){return d||(d=new f(a)),d.show(a)},c.exports=f}),define("dist/lib/cmp/dialog/confirm-box",["$","./dialog","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../mask","../../util/dom/sticky","../../util/dom/scroll","../../util/dom/wheel","./tpl/dialog","./tpl/button"],function(a,b,c){var d=a("$"),e=a("./dialog"),f=a("./tpl/button"),g=0,h={title:"",content:"",width:375,height:275,buttons:[{text:"关闭",className:"btn",action:"close"}]},i=e.extend({attrs:{title:h.title,content:h.content,width:h.width,height:h.height,hasMask:{hideOnClick:!1},buttons:[]},setup:function(){i.superclass.setup.call(this);for(var a=this.get("buttons"),b=[],c=0,d=a.length;d>c;c++){var e=a[c],h="string"==typeof e.action?e.action:"click_"+ ++g;b.push(f.render({className:e.className,action:h,text:e.text})),"close"!==h&&"confirm"!==h&&this.delegateEvents('click [data-action="'+h+'"]',function(a){return function(b){b.preventDefault(),this.trigger(a)}}(h))}this.$("[data-role=buttons]").eq(0).html(b.join(""))},events:{"click [data-action=close]":function(a){a.preventDefault(),this.hide()},"click [data-action=confirm]":function(a){a.preventDefault(),this.trigger("confirm")}},_onChangeContent:function(a){this.$("[data-role=content]").html(a)},_onChangeTitle:function(a){this.$("[data-role=title]").html(a)}});i.alert=function(a){return a=a||{},a=d.extend(!0,{},h,a),1!==a.buttons.length&&(a.buttons=[a.buttons[0]]),new i(a).show().after("hide",function(){this.destroy()})},i.confirm=function(a){return a=a||{},a=d.extend(!0,{buttons:[{text:"确认",className:"btn",action:"confirm"},{text:"取消",className:"btn",action:"close"}]},h,a),a.buttons=a.buttons.slice(0,2),new i(a).show().after("hide",function(){this.destroy()})},i.show=function(a){return a=a||{},a=d.extend({},h,a),new i(a).show().after("hide",function(){this.destroy()})},c.exports=i}),define("dist/lib/cmp/dialog/dialog",["$","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../mask","../../util/dom/sticky","../../util/dom/scroll","../../util/dom/wheel","./tpl/dialog"],function(a,b,c){function d(a){null==a.attr("tabindex")&&a.attr("tabindex","-1"),a.css("outline","none").attr("hidefocus","true")}function e(a){var b,c=a[0].contentWindow.document;return c.body.scrollHeight&&c.documentElement.scrollHeight?b=Math.min(c.body.scrollHeight,c.documentElement.scrollHeight):c.documentElement.scrollHeight?b=c.documentElement.scrollHeight:c.body.scrollHeight&&(b=c.body.scrollHeight),b}var f=a("$"),g=a("../overlay"),h=a("../mask"),i=a("../../util/event"),j=a("../../util/dom/sticky"),k=a("../../util/dom/scroll"),l=a("./tpl/dialog"),m=300,n=999,o=g.extend({attrs:{template:l.render(),title:"对话框",content:{value:null,setter:function(a){return this._type=/^(https?:\/\/|\/|\.\/|\.\.\/)/.test(a)?"iframe":"",a}},hasMask:{value:!0,hideOnClick:!1},width:500,height:null,zIndex:n,fixed:!0,autoFit:!0,effect:"none",align:{selfXY:["50%","50%"],baseXY:["50%","50%"]}},events:{"click [data-action=close]":function(){return this.hide(),!1}},parseElement:function(){o.superclass.parseElement.call(this),this.contentElement=this.$('[data-role="content"]'),this.contentElement.css({background:"#fff",height:"100%",zoom:1})},setup:function(){o.superclass.setup.call(this),this._setupMask(),this._setupKeyEvents(),this._setupFocus(),d(this.element),this.get("fixed")!==!1&&j.fix(this.element),k.prevent(this.element)},_onRenderVisible:function(a){var b=this.get("effect");a?f.isFunction(b)?b.call(this,this.element):this.element.show():this.element.hide()},show:function(a){if(o.superclass.show.call(this),"iframe"===this._type?(this.get("height")||this.element.height(m),this._showIframe()):this.get("height")&&this.$(".main").height(this.get("height")-this.$(".header").outerHeight()-this.$(".footer").outerHeight()),a)for(var b in a)this.set(b,a[b]);return this},hide:function(){return"iframe"===this._type&&this.iframe&&(this.iframe.attr({src:"about:blank"}),this.iframe.remove(),this.iframe=null,this._errCount=0),o.superclass.hide.call(this),clearInterval(this._interval),delete this._interval,this},destroy:function(){return this.element.remove(),clearInterval(this._interval),o.superclass.destroy.call(this)},_onRenderHeader:function(a){this.$(".header")[a?"show":"hide"]()},_onRenderFooter:function(a){this.$(".footer")[a?"show":"hide"]()},_onRenderTitle:function(a){this.$("[data-role=title]").eq(0).html(a)},_onRenderClosable:function(a){this.$("[data-role=close]").eq(0)[a===!1?"hide":"show"]()},_onRenderContent:function(a){if("iframe"!==this._type){var b;try{b=f(a)}catch(c){b=[]}b[0]?this.contentElement.empty().append(b):this.contentElement.empty().html(a)}},_setupMask:function(){var a=this,b=function(){a.hide()};this.before("show",function(){this.set("zIndex",n),n+=2;var a=parseInt(this.get("zIndex"),10),c=this.get("hasMask");c&&(h.set("zIndex",a-1).show(),c.hideOnClick&&h.element.one("click",b))}),this.after("hide",function(){var a=this.get("hasMask");a&&(h.hide(),a.hideOnClick&&h.element.off("click",b))})},_setupFocus:function(){this.after("show",function(){this.element.focus()})},_setupKeyEvents:function(){this.delegateEvents(f(document),"keyup",function(a){27===a.keyCode&&this.get("visible")&&this.hide()})},_showIframe:function(){var a=this;this.iframe||this._createIframe(),this.iframe.attr({src:this._fixUrl(),name:"dialog-iframe"+(new Date).getTime()}),this.iframe.one("load",function(){a.get("visible")&&(a.get("autoFit")&&(clearInterval(a._interval),a._interval=setInterval(function(){a._syncHeight()},300)),a._syncHeight(),a.trigger("complete:show"))})},_fixUrl:function(){var a=this.get("content").match(/([^?#]*)(\?[^#]*)?(#.*)?/);return a.shift(),a[1]=(a[1]&&"?"!==a[1]?a[1]+"&":"?")+"t="+(new Date).getTime(),a.join("")},_createIframe:function(){var a=this;this.contentElement.empty(),this.iframe=f("<iframe>",{src:"about:blank",scrolling:"no",frameborder:"no",allowTransparency:"true",css:{border:"none",width:"100%",display:"block",height:"100%",overflow:"hidden"}}).appendTo(this.contentElement),this._errCount=0,i.mixTo(this.iframe[0]),this.iframe[0].on("close",function(){a.hide()})},_syncHeight:function(){var a;if(this.get("height"))clearInterval(this._interval),delete this._interval;else{try{a=e(this.iframe)+"px"}catch(b){this._errCount=(this._errCount||0)+1,this._errCount>=6&&(a=m,clearInterval(this._interval),delete this._interval)}this.element.css("height",a),this._setPosition(),this.element[0].className=this.element[0].className}}});c.exports=o}),define("dist/lib/cmp/mask",["$","./overlay","../util/dom/position","../util/bom/browser","../util/dom/iframe-shim","./widget","../util/base","../util/class","../util/event","../util/aspect","../util/attribute","./daparser","./auto-render"],function(a,b,c){var d=a("$"),e=a("./overlay"),f=(window.navigator.userAgent||"").toLowerCase(),g=-1!==f.indexOf("msie 6"),h=d(document.body),i=d(document),j=[],k=e.extend({attrs:{width:g?i.outerWidth(!0):"100%",height:g?i.outerHeight(!0):"100%",className:"dialog-mask",opacity:.5,backgroundColor:"#000",style:{position:g?"absolute":"fixed",top:0,left:0},align:{baseElement:g?h:void 0}},show:function(){return g&&(this.set("width",i.outerWidth(!0)),this.set("height",i.outerHeight(!0))),k.superclass.show.call(this)},setup:function(){this._setupShim(),this.before("show",function(){j.push(this.get("zIndex"))})},hide:function(){return j.pop(),j.length>0?(this.set("zIndex",j[j.length-1]),this):k.superclass.hide.call(this)},_onRenderBackgroundColor:function(a){this.element.css("backgroundColor",a)},_onRenderOpacity:function(a){this.element.css("opacity",a)}});c.exports=new k}),define("dist/lib/util/dom/sticky",["$"],function(a,b,c){function d(a,b,c){return new g({element:a,marginTop:b||0,callback:c}).render()}function e(){return!n}function f(){if(m)return!1;var a=i[0].body;if(i[0].createElement&&a&&a.appendChild&&a.removeChild){var b,c=i[0].createElement("div"),d=function(a){return window.getComputedStyle?window.getComputedStyle(c).getPropertyValue(a):c.currentStyle.getAttribute(a)};a.appendChild(c);for(var e=0;e<j.length&&(c.style.cssText="position:"+j[e]+"sticky;visibility:hidden;",!(b=-1!==d("position").indexOf("sticky")));e++);return c.parentNode.removeChild(c),b}}function g(a){this.options=a||{},this.elem=h(this.options.element),this.callback=a.callback||function(){},this.marginTop=a.marginTop||0,this._stickyId=k++}var h=a("$"),i=h(document),j=["-webkit-","-ms-","-o-","-moz-",""],k=0,l=(window.navigator.userAgent||"").toLowerCase(),m=-1!==l.indexOf("msie"),n=-1!==l.indexOf("msie 6"),o=f(),p=e();d.stick=d,d.fix=function(a){return new g({element:a,marginTop:Number.MAX_VALUE}).render()},d.isPositionStickySupported=o,d.isPositionFixedSupported=p,g.prototype.render=function(){var a,b=this;if(this.elem.length&&!this.elem.data("bind-sticked")){this._originTop=this.elem.offset().top,this.marginTop===Number.MAX_VALUE&&(a=!0,this.marginTop=this._originTop),this._originStyles={position:null,top:null,left:null};for(var c in this._originStyles)this._originStyles.hasOwnProperty(c)&&(this._originStyles[c]=this.elem.css(c));var e;if(d.isPositionStickySupported&&!a){e=this._supportSticky;for(var f="",g=0;g<j.length;g++)f+="position:"+j[g]+"sticky;";this.elem[0].style.cssText+=f+"top: "+this.marginTop+"px;"}else d.isPositionFixedSupported?e=this._supportFixed:(e=this._supportAbsolute,h('<style type="text/css"> * html{ background:url(null) no-repeat fixed; } </style>').appendTo("head"));return e.call(this),h(window).on("scroll."+this._stickyId,function(){b.elem.is(":visible")&&e.call(b)}),this.elem.data("bind-sticked",!0),this}},g.prototype._supportFixed=function(){var a=this._originTop-i.scrollTop();!this.elem.data("sticked")&&a<=this.marginTop?(this._addPlaceholder(),this.elem.css({position:"fixed",top:this.marginTop,left:this.elem.offset().left}),this.elem.data("sticked",!0),this.callback.call(this,!0)):this.elem.data("sticked")&&a>this.marginTop&&this._restore()},g.prototype._supportAbsolute=function(){var a=this._originTop-i.scrollTop();a<=this.marginTop?(this.elem.data("sticked")||(this._addPlaceholder(),this.elem.data("sticked",!0),this.callback.call(this,!0)),this.elem.css({position:"absolute",top:this.marginTop+i.scrollTop()})):this.elem.data("sticked")&&a>this.marginTop&&this._restore()},g.prototype._supportSticky=function(){var a=this._originTop-i.scrollTop();!this.elem.data("sticked")&&a<=this.marginTop?(this.elem.data("sticked",!0),this.callback.call(this,!0)):this.elem.data("sticked")&&a>this.marginTop&&this.callback.call(this,!1)},g.prototype._restore=function(){this._removePlaceholder(),this.elem.css(this._originStyles),this.elem.data("sticked",!1),this.callback.call(this,!1)},g.prototype._addPlaceholder=function(){var a=!1,b=this.elem.css("position");("static"===b||"relative"===b)&&(a=!0),"block"!==this.elem.css("display")&&(a=!1),a&&(this._placeholder=h('<div style="visibility:hidden;margin:0;padding:0;"></div>'),this._placeholder.width(this.elem.outerWidth(!0)).height(this.elem.outerHeight(!0)).css("float",this.elem.css("float")).insertAfter(this.elem))},g.prototype._removePlaceholder=function(){this._placeholder&&this._placeholder.remove()},g.prototype.destroy=function(){this._restore(),this.elem.data("bind-sticked",!1),h(window).off("scroll."+this._stickyId)},c.exports=d}),define("dist/lib/util/dom/scroll",["$","./wheel","../bom/browser"],function(a,b,c){var d=a("$"),e=a("./wheel"),f={detect:function(a){var b,c,e;return a===window||a===document?(c=d(document).scrollTop(),a=document.documentElement):c=a.scrollTop,e=Math.ceil(a.clientHeight),0===c?b=a.scrollHeight>Math.ceil(e)?"top":"noscroll":c+Math.ceil(e)>=a.scrollHeight&&(b="bottom"),b}},g={to:function(a,b){(a===window||a===document||a===document.body)&&(a=document.documentElement),a=a[0]||a,"top"===b?b=0:"bottom"===b&&(b=a.scrollHeight),a.scrollTop=b},prevent:function(a,b){a=a[0]||a,e(a,function(c,d,e,g){var h=f.detect(a);a===c.target&&("ie"===g||"noscroll"===h||"top"===h&&"up"===d||"bottom"===h&&"down"===d)&&(e(),b&&b.call(a,c,h))})},listen:function(a,b,c){var e={},h=d(a).scrollTop(),i=function(c,g){if(g){var h=f.detect(a),i=d(a).scrollTop();e.bottom=(a===document?document.body:a).scrollHeight-parseFloat(a===document?document.documentElement.clientHeight:a.clientHeight),b.other&&b.other(c,i,g,e),h&&(b.top&&"top"===h&&"up"===g&&b.top(c,i,g,e),b.bottom&&"bottom"===h&&"down"===g&&b.bottom(c,i,g,e))}};a=a[0]||a,a=a===document||a===document.body?window:a,d(a).scroll(function(b){var c=d(a).scrollTop(),e=c>h?"down":h>c?"up":"";h=c,e&&i(b.originalEvent,e)}),a!==window&&c!==!1&&g.prevent(a)
}};c.exports=g}),define("dist/lib/util/dom/wheel",["../bom/browser"],function(a,b,c){var d=a("../bom/browser");c.exports=function(a,b){a=a[0]||a,d.ie?a.attachEvent("onmousewheel",function(c){c=window.event;var d=function(){a.scrollTop+=c.wheelDelta>0?-60:60,c.returnValue=!1};b&&b.call(a,c,c.wheelDelta>0?"up":"down",d,"ie")}):d.firefox?a.addEventListener("DOMMouseScroll",function(c){b&&b.call(a,c,c.detail<0?"up":c.detail>0?"down":"",function(){c.preventDefault()},"firefox")},!1):a.addEventListener("mousewheel",function(c){b&&b.call(a,c,c.wheelDelta>=0?"up":c.wheelDelta<=0?"down":"",function(){c.returnValue=!1},"standard")},!1)}}),define("dist/lib/cmp/dialog/tpl/dialog",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-dialog"> <a href="#" data-action="close" data-role="close" title="关闭" class="dialog-close">×</a> <div class="header"> <div class="title" data-role="title"></div> </div> <div class="main"> <div class="content" data-role="content"></div> </div> <div class="footer"> <div class="buttons" data-role="buttons"></div> </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/cmp/dialog/tpl/button",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <input type=\"button\" value=\"',text,'\" class=\"',className,'\" data-action=\"',action,'\"/>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/singleton-tip",["$","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/util/dom/sticky"],function(a,b,c){var d,e=a("$"),f=a("../../lib/cmp/widget"),g=a("../../lib/util/dom/sticky"),h=f.extend({attrs:{timeout:3e3,template:'<div class="tips-pop"><span></span><a class="close" href="#" data-action="close">X</a></div>',top:42},events:{"click [data-action=close]":function(){return this.hide(),!1}},setup:function(){h.superclass.setup.call(this),g.fix(this.element)},show:function(a,b,c){return this.element.children("span:first").text(a),c?(this.element.css(c),c.left===d&&this.element.css("left",(e(window).width()-this.element.width())/2)):this.element.css({left:(e(window).width()-this.element.width())/2,top:this.get("top")}),this.element.removeClass().addClass("tips-pop "+b||""),this.element.show(),this},hide:function(){return this.element.hide(),this},success:function(a){return this.show(a)},error:function(a){return this.show(a,"tips-failure")},auto:function(a){return function(b){var c=this;return clearTimeout(a),e(".tips-pop").find("a").css("display","none"),this.show(b),a=setTimeout(function(){c.hide()},this.get("timeout")),this}}()});c.exports=(new h).render()}),define("dist/app/common/new-weibo",["$","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../../lib/util/dom/action","./weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/util/dom/selection","../../lib/cmp/autocomplete/autocomplete","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","./helper/inputor","../../lib/util/string","../../lib/util/dom/placeholder","./weibo-manager","./tpl/weibo","./tpl/comment","./tpl/weibo-pic","../../lib/util/date","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image","./upload-pic","../../lib/util/dom/upload/upload","../../lib/util/dom/upload/upload-swfupload","../../lib/util/dom/upload/swfupload","../../lib/util/dom/upload/upload-html5","../../lib/util/dom/upload/upload-draggable","./singleton-tip","./tpl/pic"],function(a){var b=a("$"),c=(a("./ajax"),a("../../lib/util/dom/action")),d=a("./weibo-textarea"),e=(a("./weibo-manager"),a("./upload-pic")),f=a("../../lib/cmp/widget"),g=a("./helper/inputor"),h=f.extend({attrs:{textarea:null},setup:function(){h.superclass.setup.call(this),this.after("render",function(){var a=this.get("textarea"),b=g.getEditorWrap(a),c=(b.find("[data-role=submit]"),b.find(".upload-pic-btn")),f=new d({trigger:a}).render();f.u=e(c),g.listenWordcount(a,function(){f.validate()})})}});return c.listen({toggleNewWeiboActive:{is:function(a,b){var c=b.closest("[data-role=editor-wrap]"),d=c.find("[data-role=editor]");return c.addClass("active"),d.focus(),!0},not:function(a,c,d){var e=(a.target,b(c).closest("[data-role=editor-wrap]")),f=e.find("[data-role=editor]"),g=["expression","expression-item","topic","at","toggleUploadPic","submitNewWeibo"];return-1!==b.inArray(d,g)||f.val()?!0:(e.removeClass("active"),e.find(".pic-upload").hide(),e.find(".pic-button").removeClass("active"),!1)}}}),{init:function(){b(".new-weibo",".dashboard").each(function(a,c){c=b(c);var d=b(".new-weibo-content",c);new h({textarea:d}).render(),c.on("click",".send-pic",function(){c.find(".gear.pic-button").trigger("click"),d.focus()})})}}}),define("dist/app/common/weibo-textarea",["$","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../../lib/cmp/autocomplete/textarea-complete","../../lib/util/dom/selection","../../lib/cmp/autocomplete/autocomplete","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","./helper/inputor","../../lib/util/string","../../lib/util/dom/placeholder"],function(a,b,c){var d=a("$"),e=a("./ajax"),f=a("../../lib/cmp/autocomplete/textarea-complete"),g=a("../../lib/util/dom/inputor"),h=a("./helper/inputor"),i=(a("../../lib/util/dom/placeholder"),{}),j=null,k=f.extend({attrs:{cursor:!0,dataSource:function(a,b){if(j=[],a){var c=a.substring(0,1);"@"===c&&e({method:"GET",url:"/search_api/user/max/7/keyword/"+encodeURIComponent(a.slice(1))}).done(function(a){d.each(a.users,function(a,b){j.push({name:b.nickname,uid:+b.uid})}),b(j)})}return!1},inputFilter:function(a){var b=a.lastIndexOf("@"),c=a.lastIndexOf("#"),d="";b>c?d=a.substring(b):c>b&&(d=a.substring(c));var e=d.match(/\s/);return e?null:d},itemTemplate:function(a){a=a.matchKey.split(",");var b=a[0],c=a[0].slice(1,-1),d=a[1];return'<li data-role="item" class="item" data-value="'+b+'">'+c+"("+d+")</li>"},zIndex:99999999},setup:function(){function a(a){var d={1:1,37:1,39:1};a.which in d&&(b._start=!0,b.queryValue="",b._onRenderInputValue.call(b,c.val()))}k.superclass.setup.call(this);var b=this,c=this.get("trigger");c.data("selection",this.sel),g(c,function(){var a=b.sel;a.cachedCursor=a.cursor()},{keep:!0,silentBlur:!0}),c.data("atCache",this),this.sending=!1,this.set("locator",function(a){var c=b.queryValue;if(c){var e=c.substring(0,1);if("@"===e){for(var f=0,g=a.length;g>f;f++){var h=a[f];i[h.uid]||(i[h.uid]=h)}a=d.map(a,function(a){return"@"+a.name+" ,"+a.uid})}}return a}),this.delegateEvents(c,"focus",a),this.delegateEvents(c,"click",a),this.delegateEvents(c,"keyup",a),this.selectedUsers={},this.on("itemSelect",function(a){a=a.matchKey.split(",");var d=a[0].slice(1,-1),e=a[1];b.selectedUsersAdd(d,e);var f=c.data("selection"),g=f.cachedCursor;f.cursor(g[1]+d.length+1)}).after("selectItem",function(){setTimeout(function(){c.focus()},0)})},selectItem:function(){this.hide();var a=this.currentItem,b=this.get("selectedIndex"),c=this.get("data")[b];if(a){var d=a.attr("data-value"),e=this.sel.cursor()[1],f=e-this.queryValue.length;this.sel.cursor(f,e).insertText(d,[f,e]);var g=this.get("trigger").val();this.set("inputValue",g),this.mirror&&this.mirror.setContent(g||"","",[f+d.length,f+d.length]),this.trigger("itemSelect",c),this._clear()}},selectedUsersAdd:function(a,b){var c=this.selectedUsers;c[a]?c[a].push(b):c[a]=[b]},transfer:function(a){var b=this;return a=a||this.get("trigger").val(),a=a.replace(/@([^@\s]+)?/g,function(a,c){var d,e=b.selectedUsers[c],f=!1;if(e)d=e.length>1?e.pop():e[0],f=!0;else for(d in i)if(i[d].name===c){f=!0;break}return f?"<M "+d+">@"+c+"</M>":a}),encodeURIComponent(a)},clear:function(a){this.get("trigger").val(a),this.selectedUsers={}},validate:function(a){var b=this,c=this.get("trigger"),d=h.getEditorWrap(c),e=d.find("[data-role=wordcount]"),f=d.find(".submit"),g=!1;return h.wordcount(c,a||2e3,function(a,c,h){e.text(a),e[c?"addClass":"removeClass"]("overflow"),b.u.status||c||h?(d.removeClass("validate"),f.removeClass("abled").addClass("disabled"),g=!1):(d.addClass("validate"),f.removeClass("disabled").addClass("abled"),g=!0)}),g}});k.selectedUsersAdd=function(a,b,c){var d=a.data("atCache");d&&d.selectedUsersAdd(b,c)},k.transfer=function(a,b){var c=a.data("atCache");return c?c.transfer(b):encodeURIComponent(b||a.val())},k.clear=function(a,b){var c=a.data("atCache");return c?c.clear(b):a.val(b)},c.exports=k}),define("dist/lib/cmp/autocomplete/textarea-complete",["$","../../util/dom/selection","./autocomplete","../../util/dom/inputor","../../util/timer","../../util/dom/position","../../util/bom/browser","../overlay","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./data-source","./filter","./tpl/autocomplete"],function(a,b,c){var d=a("$"),e=a("../../util/dom/selection"),f=a("./autocomplete"),g=f.extend({attrs:{cursor:!1},setup:function(){g.superclass.setup.call(this),this.sel=e(this.get("trigger"));var a=this.get("inputFilter"),b=this;this.set("inputFilter",function(c){var d=c.substring(0,b.sel.cursor()[1]);return a.call(b,d)}),this.get("cursor")&&(this.mirror=d.extend({},h.init(this.get("trigger"))),this.dataSource.before("getData",function(){b.mirror.setContent(b.get("inputValue")||"",b.queryValue,b.sel.cursor())}))},_keyUp:function(a){this.get("visible")&&(a.preventDefault(),this.get("data").length&&this._step(-1))},_keyDown:function(a){this.get("visible")&&(a.preventDefault(),this.get("data").length&&this._step(1))},_keyEnter:function(a){this.get("visible")&&(this.currentItem?(a.preventDefault(),a.stopImmediatePropagation(),this.selectItem()):this.hide())},show:function(){var a=this.get("cursor");if(a){var b;b=d.isArray(a)?a:[0,0];var c=this.mirror.getFlagRect(),e=this.get("align");e.baseXY=[c.left+b[0],c.bottom+b[1]],e.selfXY=[0,0];var f=this.get("trigger");e.baseXY[0]-=d(f).scrollLeft(),e.baseXY[1]-=d(f).scrollTop(),this.set("align",e)}g.superclass.show.call(this)},selectItem:function(){this.hide();var a=this.currentItem,b=this.get("selectedIndex"),c=this.get("data")[b];if(a){var d=a.attr("data-value"),e=this.sel.cursor()[1],f=e-this.queryValue.length;this.sel.cursor(f,e).text("").append(d,"right");var g=this.get("trigger").val();this.set("inputValue",g),this.mirror&&this.mirror.setContent(g||"","",this.sel.cursor()),this.trigger("itemSelect",c),this._clear()}}}),h={mirror:null,css:["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX"],init:function(a){if(a=d(a),a[0].createTextRange)return this.isIE=!0,this.mirror=null,this.origin=a[0],this;var b={position:"absolute",left:-9999,top:11,zIndex:-2e4,"white-space":"pre-wrap"};return d.each(this.css,function(c,d){return b[d]=a.css(d)}),this.mirror=d("<div><span></span></div>").css(b).insertAfter(a),this},setContent:function(a,b,c){if(!this.isIE){var d=b?c[1]-b.length:c[1],e=c[1],f=["<span>",a.substring(0,d).replace(/\r\n|\n/g,"<br>"),"</span>",'<span id="flag">',(b||"").replace(/\r\n|\n/g,"<br>"),"</span>","<span>",a.substring(e).replace(/\r\n|\n/g,"<br>"),"</span>"].join("");return this.mirror.html(f),this}},getFlagRect:function(){var a,b,c;if(this.isIE){var e=this.origin,f=d(e).offsetParent(),g=f.offset(),h=document.selection.createRange(),i=h.boundingLeft-g.left-parseInt(f.css("padding-left")),j=h.boundingTop-g.top+parseInt(f.css("padding-top"))+2*d(e).scrollTop()+d(window).scrollTop();return null!==h&&(b={left:i,bottom:j}),b}return c=this.mirror.find("span#flag"),a=c.position(),b={left:a.left,right:c.width()+a.left,top:a.top,bottom:c.height()+a.top}}};c.exports=g}),define("dist/lib/cmp/autocomplete/autocomplete",["$","../../util/dom/inputor","../../util/timer","../../util/dom/position","../../util/bom/browser","../overlay","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./data-source","./filter","./tpl/autocomplete"],function(a,b,c){function d(a){return"[object String]"===Object.prototype.toString.call(a)}function e(a,b){if(!a)return b;if(h.isFunction(a))return a.call(this,b);if(d(a)){for(var c=a.split("."),e=b;c.length;){var f=c.shift();if(!e[f])break;e=e[f]}return e}return b}function f(a,b){var c=this.highlightIndex,d=0,e=b||this.matchKey||"",f="";if(h.isArray(c)){for(var g=0,i=c.length;i>g;g++){var j,k,l=c[g];if(h.isArray(l)?(j=l[0],k=l[1]-l[0]):(j=l,k=1),j>d&&(f+=e.substring(d,j)),j<e.length&&(f+='<span class="'+a+'-item-hl">'+e.substr(j,k)+"</span>"),d=j+k,d>=e.length)break}return e.length>d&&(f+=e.substring(d,e.length)),f}return e}var g,h=a("$"),i=a("../../util/dom/inputor"),j=a("../../util/dom/position"),k=a("../overlay"),l=a("./data-source"),m=a("./filter"),n=a("./tpl/autocomplete"),o=-1!==(window.navigator.userAgent||"").toLowerCase().indexOf("msie"),p={UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13,ESC:27,BACKSPACE:8},q=k.extend({attrs:{trigger:{value:null,getter:function(a){return h(a)}},classPrefix:"widget-autocomplete",align:{baseXY:[0,"100%"]},template:n.render(),submitOnEnter:!0,selectItem:!0,dataSource:[],locator:"data",filter:g,inputFilter:function(a){return a},disabled:!1,highlight:!1,selectFirst:!1,delay:100,selectedIndex:g,inputValue:null,data:null},events:{"mousedown [data-role=item]":function(a){var b=this.items.index(a.currentTarget);this.set("selectedIndex",b),this.get("selectItem")&&(this.selectItem(),this._firstMousedown=!0)},mousedown:function(){this._secondMousedown=!0},"click [data-role=item]":function(){this.get("selectItem")||this.hide()},"mouseenter [data-role=item]":function(a){var b=this.get("classPrefix")+"-item-hover";this.currentItem&&this.currentItem.removeClass(b),h(a.currentTarget).addClass(b)},"mouseleave [data-role=item]":function(a){var b=this.get("classPrefix")+"-item-hover";h(a.currentTarget).removeClass(b)}},setup:function(){var a=this.get("trigger"),b=this,c=this.get("inputor"),d=h.isFunction(c);q.superclass.setup.call(this),this.dataSource=new l({source:this.get("dataSource")}).on("data",this._filterData,this),this._initFilter(),this._blurHide([a]),this._tweakAlignDefaultValue(),a.attr("autocomplete","off"),this.delegateEvents(a,"blur.autocomplete",h.proxy(this._blurEvent,this)),this.delegateEvents(a,"keydown.autocomplete",h.proxy(this._keydownEvent,this)),i(a,function(a){b._keyupEvent.call(b),d&&c.call(b,a)},{timer:b.get("delay")})},destroy:function(){this._clear(),this.element.remove(),q.superclass.destroy.call(this)},hide:function(){this._timeout&&clearTimeout(this._timeout),this.dataSource.abort(),q.superclass.hide.call(this)},selectItem:function(){this.hide();var a=this.currentItem,b=this.get("selectedIndex"),c=this.get("data")[b];if(a){var d=a.attr("data-value");this.get("trigger").val(d),this.set("inputValue",d,{silent:!0}),this.trigger("itemSelect",c),this._clear()}},setInputValue:function(a){this._start=!0,this.set("inputValue",a);var b=this.get("trigger");b.val()!==a&&b.val(a),""===a&&h.isFunction(this.get("emptyAction"))&&this._emptyAction()},_onRenderInputValue:function(a){if(this._start&&a){var b=this.queryValue;this.queryValue=this.get("inputFilter").call(this,a),this.queryValue&&this.queryValue!==b&&(this.dataSource.abort(),this.dataSource.getData(this.queryValue))}else this.queryValue="";""!==a&&this.queryValue||(h.isFunction(this.get("emptyAction"))?this._emptyAction():(this.set("data",[]),this.hide())),delete this._start},_filterData:function(a){var b=this.get("filter"),c=this.get("locator");a=e(c,a),a=b.func.call(this,a,this.queryValue,b.options),this.set("data",a)},_onRenderData:function(a){this._clear(),function(a){for(var b=[],c=this.get("classPrefix"),d=0,e=a.length;e>d;d++){var g=a[d],i=this.get("highlight")?f.call(g,c,a[d].matchKey):a[d].matchKey;b[d]=this.get("itemTemplate")?h.isFunction(this.get("itemTemplate"))?this.get("itemTemplate")(a[d]):this.get("itemTemplate").replace(/\{\{value\}\}/g,a[d].matchKey).replace(/\{\{text\}\}/g,i):'<li data-role="item" class="'+c+'-item" data-value="'+a[d].matchKey+'">'+i+"</li>"}this.$("[data-role=items]").html(b.join(""))}.call(this,a),this.items=this.$("[data-role=items]").children(),this.currentItem=null,this.get("selectFirst")&&this.set("selectedIndex",0),h.trim(this.$("[data-role=items]").text())?this.show():this.hide()},_onRenderSelectedIndex:function(a){if(-1!==a){var b=this.get("classPrefix")+"-item-hover";this.currentItem&&this.currentItem.removeClass(b),this.currentItem=this.items.eq(a).addClass(b),this.trigger("indexChange",a,this.lastIndex),this.lastIndex=a}},_initFilter:function(){var a=this.get("filter");a=a===g?"url"===this.dataSource.get("type")?null:{name:"startsWith",func:m.startsWith,options:{key:"value"}}:h.isPlainObject(a)?m[a.name]?{name:a.name,func:m[a.name],options:a.options}:null:h.isFunction(a)?{func:a}:m[a]?{name:a,func:m[a]}:null,a||(a={name:"default",func:m["default"]}),this.set("filter",a)},_blurEvent:function(){o||(this._secondMousedown?this._firstMousedown&&(this.get("trigger").focus(),this.hide()):this.hide(),delete this._firstMousedown,delete this._secondMousedown)},_keyupEvent:function(){if(!this.get("disabled")){var a=this.get("trigger").val();this.setInputValue(a)}},_keydownEvent:function(a){if(!this.get("disabled"))switch(a.which){case p.ESC:this.hide();break;case p.UP:this._keyUp(a);break;case p.DOWN:this._keyDown(a);break;case p.LEFT:case p.RIGHT:break;case p.ENTER:this._keyEnter(a)}},_keyUp:function(a){if(a.preventDefault(),this.get("data").length){if(!this.get("visible"))return void this.show();this._step(-1)}},_keyDown:function(a){if(a.preventDefault(),this.get("data").length){if(!this.get("visible"))return void this.show();this._step(1)}},_keyEnter:function(a){this.get("visible")&&(this.selectItem(),this.get("submitOnEnter")||a.preventDefault())},_step:function(a){var b=this.get("selectedIndex");-1===a?b>0?this.set("selectedIndex",b-1):this.set("selectedIndex",this.items.length-1):1===a&&(b<this.items.length-1?this.set("selectedIndex",b+1):this.set("selectedIndex",0))},_clear:function(){this.$("[data-role=items]").empty(),this.set("selectedIndex",-1),delete this.items,delete this.lastIndex,delete this.currentItem},_emptyAction:function(){var a=this.get("locator"),b=this.get("emptyAction").call(this);b&&(b=e(a,b),b=m["default"](b),this.set("data",b))},_tweakAlignDefaultValue:function(){var a=this.get("align");a.baseElement===j.VIEWPORT&&(a.baseElement=this.get("trigger")),this.set("align",a)}});q._filter=m,c.exports=q}),define("dist/lib/cmp/autocomplete/data-source",["../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","$"],function(a,b,c){function d(a){return"[object String]"===Object.prototype.toString.call(a)}function e(a){return a.replace(/^([a-z])/,function(a,b){return b.toUpperCase()})}var f=a("../../util/base"),g=a("$"),h=f.extend({attrs:{source:null,type:"array"},initialize:function(a){h.superclass.initialize.call(this,a),this.id=0,this.callbacks=[];var b=this.get("source");if(d(b))this.set("type","url");else if(g.isArray(b))this.set("type","array");else if(g.isPlainObject(b))this.set("type","object");else{if(!g.isFunction(b))throw new Error("Source Type Error");this.set("type","function")}},getData:function(a){return this["_get"+e(this.get("type")||"")+"Data"](a)},abort:function(){this.callbacks=[]},_done:function(a){this.trigger("data",a)},_getUrlData:function(a){var b,c=this,d={query:a?encodeURIComponent(a):"",timestamp:(new Date).getTime()},e=this.get("source").replace(/{{(.*?)}}/g,function(a,b){return d[b]}),f="callback_"+this.id++;this.callbacks.push(f),b=/^(https?:\/\/)/.test(e)?{dataType:"jsonp"}:{dataType:"json"},g.ajax(e,b).success(function(a){g.inArray(f,c.callbacks)>-1&&(delete c.callbacks[f],c._done(a))}).error(function(){g.inArray(f,c.callbacks)>-1&&(delete c.callbacks[f],c._done({}))})},_getArrayData:function(){var a=this.get("source");return this._done(a),a},_getObjectData:function(){var a=this.get("source");return this._done(a),a},_getFunctionData:function(a){function b(a){c._done(a)}var c=this,d=this.get("source"),e=d.call(this,a,b);e&&this._done(e)}});c.exports=h}),define("dist/lib/cmp/autocomplete/filter",["$"],function(a,b,c){function d(a,b){if(g.isPlainObject(a)){var c=b&&b.key||"value";return a[c]||""}return a}function e(a,b){for(var c=[],d=a.split(""),e=0,f=b.split(""),g=0,h=d.length;h>g;g++){var i=d[g];if(i===f[e]){if(e===f.length-1){c.push([g-f.length+1,g+1]),e=0;continue}e++}else e=0}return c}function f(a){return(a||"").replace(i,"\\$1")}var g=a("$"),h={"default":function(a,b,c){var e=[];return g.each(a,function(a,b){var f={},h=d(b,c);g.isPlainObject(b)&&(f=g.extend({},b)),f.matchKey=h,e.push(f)}),e},startsWith:function(a,b,c){var e=[],h=b.length,i=new RegExp("^"+f(b));return h?(g.each(a,function(a,b){var f={},j=d(b,c);g.isPlainObject(b)&&(f=g.extend({},b)),i.test(j)&&(f.matchKey=j,h>0&&(f.highlightIndex=[[0,h]]),e.push(f))}),e):[]},stringMatch:function(a,b,c){b=b||"";var f=[],h=b.length;return h?(g.each(a,function(a,h){var i={},j=d(h,c);g.isPlainObject(h)&&(i=g.extend({},h)),j.indexOf(b)>-1&&(i.matchKey=j,i.highlightIndex=e(j,b),f.push(i))}),f):[]}};c.exports=h;var i=/(\[|\[|\]|\^|\$|\||\(|\)|\{|\}|\+|\*|\?|\\)/g}),define("dist/lib/cmp/autocomplete/tpl/autocomplete",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-autocomplete"> <ul class="widget-autocomplete-ctn" data-role="items"> </ul> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/util/dom/placeholder",["$","./position","../bom/browser","./inputor","../timer"],function(a,b,c){var d=a("$"),e=a("./position"),f=(a("./inputor"),function(){var a=0;return function(){return 0===a&&(a="placeholder"in document.createElement("input")),a}}()),g=function(a,b){if(!f()&&(a=d(a),!a.data("placeholder"))){b=b||a.attr("placeholder");var c=d('<span class="placeholder">'+b+"</span>"),g=parseInt(a.css("line-height")),h=parseInt(a.css("padding-left")),i=parseInt(a.css("padding-top"))+2;a.after(c),c.css({color:"#bbb",height:g,lineHeight:g+"px",paddingLeft:h+"px",paddingTop:i+"px"}),e.pin({element:c},{element:a}),a.timer(function(a){c[a.length?"hide":"show"]()}),c.bind("focus click",function(){a.focus()}),a.val().length&&c.hide(),a.data("placeholder",!0)}};g.render=function(){d("[placeholder]").placehoder()},d.fn.placehoder=function(){this.each(function(){g(this)})},d(function(){f()||d(window).bind("resize.placeholder",function(){d("[placeholder]").each(function(a,b){b=d(b);var c=b.nextAll(".placeholder").eq(0);e.pin({element:c},{element:b})})})}),c.exports=g}),define("dist/app/common/weibo-manager",["$","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/util/dom/selection","../../lib/cmp/autocomplete/autocomplete","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","./helper/inputor","../../lib/util/string","../../lib/util/dom/placeholder","./tpl/weibo","./tpl/comment","./tpl/weibo-pic","../../lib/util/date","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image"],function(a,b,c){var d=a("$"),e=a("./ajax"),f=(a("./weibo-textarea"),a("./tpl/weibo")),g=a("./tpl/comment"),h=a("./tpl/weibo-pic"),i=(a("../../lib/util/date"),a("./pagenation")),j=a("../../lib/util/dom/placeholder"),k=a("../../lib/util/dom/image"),l=Global.user.uid,m={index:1,INDEX:1,loading:!1,dom:d(".weibo-container"),tip:d(".see-new-weibo"),"no-more":d(".main-content .no-more"),"see-more":d(".main-content .see-more"),"auto-loading":d(".main-content .see-more .auto-loading"),pagination:d(".main-content .see-more .pagination"),init:function(a,b){var c=this;c.pageSize=30,c._requestUrl=a||"/topic_api/timeline_web";var d=!0;return c.minId=0,this.requestPage(1,b).done(function(){new i({parentNode:c.pagination,showPN:!1,total:c.total,size:90,success:function(a){d?d=!1:c.requestPage(a)}}).render()})},requestNew:function(){var a=this,b=a.minId;a.minId=0,e({url:"/topic_api/timeline_web/id_min/"+b,method:"GET"}).on("done",function(b){b=b.topics,a._append(b),a.minId=+b[0].id})},prependNew:function(a){"/topic_api/timeline_web"===m._requestUrl&&(a={topic:a},m._prepend([a]),m.minId=+a.topic.tid,d(".home-no-weibo").hide())},_request:function(a,b){var c=this;if(!b&&void 0!==c.maxNum&&(0===c.maxNum||a>c.maxNum))return!1;var f=e({url:c._requestUrl+"/page_size/"+c.pageSize+"/page/"+a,method:"GET"});return f.on("done",function(b){c.total=+b.total,c.maxNum=Math.ceil(c.total/c.pageSize),0===b.total&&f.trigger("null"),f.trigger(a+1>c.maxNum?"drained":"not-drained")}),f.on("fail",function(){}),f.on("always",function(){c.loading=!1}),f.on("drained",function(){c.drained=!0,c["no-more"].show(),1===c.INDEX&&c["see-more"].hide(),1!==c.INDEX&&(c["see-more"].show(),c["auto-loading"].hide(),c.pagination.show())}),f.on("not-drained",function(){c.drained=!1,c["no-more"].hide(),3===++c.index?(c["auto-loading"].hide(),c.pagination.show()):(c["auto-loading"].show(),c.pagination.hide())}),f.on("null",function(){c.drained=!0,d(".no-weibo").show(),c["see-more"].hide()}),this.loading=!0,f},requestMore:function(){var a=this;if(!this.loading&&3!==this.index&&!a.drained){var b=this._request(3*(this.INDEX-1)+this.index+1);return b?(b.on("done",function(b){b=b.topics,a._append(b)}),b):!1}},requestPage:function(a,b){var c=this,d=this._request(3*(a-1)+1,b);return d?(d.on("done",function(b){c.total=b.total,b=b.topics,c._empty(),c.INDEX=a,c.index=1,c.total&&1===c.INDEX&&b.length>0&&(c.minId=b[0].id),c._append(b)}),d):!1},_pend:function(a,b){var c=this;a=d.isArray(a)?a:[a];var e="";d.each(a,function(a,b){b.topic&&b.topic.user&&(b=c.parseData(b),e+=c.render(b))});var f=d(e);b?m.dom.prepend(f):m.dom.append(f),c.renderPic(f),j.render()},_append:function(a){this._pend(a)},_prepend:function(a){this._pend(a,!0)},_empty:function(){d("body, html").scrollTop(0),this.dom.empty()},remove:function(a){a.remove(),0===d(".weibo-container").children(".weibo").length&&(d(".no-weibo").show(),d(".main-content>.see-more").hide(),"/topic_api/timeline_web"===m._requestUrl&&d(".home-no-weibo").show())},parseData:function(a){return a.topic.own=+a.topic.uid===+l,a.replys||(a.replys={count:0,replylist:[],total:0}),a.praises||(a.praises={count:0,praisors:[],total:0}),a},render:function(a){return a.tpl={comment:g,weiboPic:h},f.render(a)},renderPic:function(a){var b=a.find(".pic-wrap img");d.each(b,function(a,b){var c=d(b).parent().width(),e=d(b).parent().height();k.load({url:b.src,ready:function(){var a=this;k.zoom({node:b,width:a.width,height:a.height,maxWidth:c,maxHeight:e,overflow:!0,callback:function(c,d){1.25>c/d&&(d=e,c=a.width*(e/a.height)),b.width=c,b.height=d}}),k.center({node:b,width:c,height:e,callback:function(a,c){d(b).css({top:a,left:c})}})}})})}};c.exports=m}),define("dist/app/common/tpl/weibo",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="weibo" data-tid="\',topic.tid,\'" data-role="weibo"> <div class="header">\',Global.Helper.avatar(topic.user),\' <div class="name-and-date">\',Global.Helper.userLink(topic.user),\' <div class="date">  <span data-role="date">\',Global.Helper.cuteDate(topic.post_time),\'</span>  <span class="emptyspan">来自\',topic.from_string,\'</span>  <span class="emptyspan">阅读(\',topic.glances,\')</span>  </div>  </div> </div>\');if(topic.own){_s.push(\' <div class="delete own" data-action="deleteWeibo"></div>\');}_s.push(\' <div class="content" data-role="content-wrap">  <div class="text" data-role="content">\',Global.Helper.parseContent(topic.content),\'</div>\');if(topic.category===\'longtext\'){_s.push(\'  <div class="longtext" data-role="long-content">\',Global.Helper.parseContent(topic.article),\'</div>  <a href="javascript:void(0)" class="unfold-content" data-role="unfold-btn" data-action="showLongText">查看所有</a>  <a href="javascript:void(0)" class="fold-content" data-role="fold-btn" data-action="hideLongText">收起</a>\');}if(topic.root_topic&&topic.root_topic.topic&&topic.root_topic.topic.user){_s.push(\'  <div class="text referer-topic" data-role="content-wrap">  <div class="referer-text text" data-role="content">\',Global.Helper.userLink(topic.root_topic.topic.user),\': \',Global.Helper.parseContent(topic.root_topic.topic.content),\'</div>\');if(topic.root_topic.topic.category===\'longtext\'){_s.push(\'  <div class="referer-longtext longtext" data-role="long-content">\',Global.Helper.userLink(topic.root_topic.topic.user),\': \',Global.Helper.parseContent(topic.root_topic.topic.article),\'</div>  <a href="javascript:void(0)" class="unfold-content" data-role="unfold-btn" data-action="showLongText">查看所有</a>  <a href="javascript:void(0)" class="fold-content" data-role="fold-btn" data-action="hideLongText">收起</a>\');}if(topic.root_topic.topic.image){_s.push(tpl.weiboPic.render({topic:topic.root_topic.topic}));}_s.push(\'  </div>\');}if(topic.image){_s.push(tpl.weiboPic.render({topic:topic}));}_s.push(\' </div> <div class="gear-bar">  <div class="support">  <div class="users">\');for(var key=0; key<praises.praisors.length;key+=1){var praisor=praises.praisors[key];if(praisor.user){_s.push(Global.Helper.avatar(praisor.user));}}_s.push(\'  </div>\');if(praises.total > praises.count){_s.push(\'  <div class="see-all" data-action="openPraiseList"></div>\');}_s.push(\'  </div>\');if(+topic.praised===0){_s.push(\'  <div class="support-button button" data-action="praise" title="赞">\');if(+topic.praises > 0){_s.push(\'  <span class="praisecount">\',topic.praises,\'</span>\');}else{_s.push(\'  <span></span>\');}_s.push(\'  </div>\');}else{_s.push(\'  <div class="support-button button active" data-action="cancelPraise" title="取消赞">  <span class="praisecount">\',topic.praises,\'</span>  </div>\');}_s.push(\'  <div class="transmit-button button" data-action="repost" title="转发">  <span class="\',topic.forwards===\'0\'?\'\':\'forwards\',\'"></span>  </div>\');if(+topic.favorited===0){_s.push(\'  <div class="collect-button button" data-action="favorite" title="收藏"></div>\');}else{_s.push(\'  <div class="collect-button button active" data-action="unfavorite" title="取消收藏"></div>\');}_s.push(\' </div> <div class="comments" data-role="editor-wrap">\');if(topic.isrender){if(+topic.replys>0){_s.push(\'  <div class="see-all">  <div data-role="fold" data-action="foldComments">  <div> <a href="javascript:void(0);"> 隐藏评论<i class="fold-icon"></i></a> </div>\');if(topic.replys-10>0){_s.push(\'  <div> <a href="javascript:void(0);">还剩\',topic.replys - 10,\'条评论</a> </div>\');}_s.push(\'  </div>  <div data-role="unfold">  <a href="javascript:void(0);" data-action="unfoldComments"> <span data-role="comment-count">\',topic.replys,\'</span>条评论<i class="unfold-icon"></i></a>  </div>  </div>\');}}else{if(+topic.replys > 5){_s.push(\'  <div class="see-all">  <div data-role="fold">  <div> <a href="javascript:void(0);" data-action="foldComments"> 隐藏评论<i class="fold-icon"></i></a> </div>\');if(topic.replys-10>0){_s.push(\'  <div> <a href="javascript:void(0);">还剩\',topic.replys - 10,\'条评论</a> </div>\');}_s.push(\'  </div>  <div data-role="unfold">  <a href="javascript:void(0);" data-action="unfoldComments"> <span data-role="comment-count">\',topic.replys,\'</span>条评论<i class="unfold-icon"></i></a>  </div>  </div>\');}}_s.push(\'  <div class="comments-container" data-role="comments-container">  <div data-role="first-time">\');for(var key=0; key<replys.replylist.length;key+=1){var item=replys.replylist[key];_s.push(tpl.comment.render({item:item.reply, topic: topic}));}_s.push(\'  </div>  <div data-role="next-time"></div>  </div>  <div class="commentpage"></div>  <div class="input-group" data-action="openComment">  <textarea class="reply-content large" placeholder="评论几句..." data-role="editor" ></textarea>  </div>  <div class="sendbtn hide" data-role="send-comment-bar">  <span class="gear smiley-button" data-action="expression"></span>  <input class="button disabled" type="button" value="发送" data-action="sendComment"/>  </div> </div> </div>\'); return _s;').apply(null,c).join("")
}}}),define("dist/app/common/tpl/comment",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\'\');if(item.user){_s.push(\' <div class="comment" data-id="\',item.rid,\'">\',Global.Helper.avatar(item.user),\' <div class="header-and-content">  <div class="header">\',Global.Helper.userLink(item.user),\' <span class="date">\',Global.Helper.cuteDate(item.post_time),\'</span>  <span class="reply" data-action="replyComment"></span>\');if(+item.user.uid === +Global.user.uid || topic.own){_s.push(\'  <span class="delete" data-action="deleteComment"></span>\');}_s.push(\'  </div>  <div class="content">\',Global.Helper.parseContent(item.content),\' </div>  </div> </div>\');} return _s;').apply(null,c).join("")}}}),define("dist/app/common/tpl/weibo-pic",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="pic pic-count-\',topic.image.length,\'">  <div class="pic-wrap first">  <img src="\',topic.image[0].image_original,\'" data-action="display-pic"/>  </div>\');for(var key=0; key<topic.image.slice(1).length;key+=1){var image=topic.image.slice(1)[key];_s.push(\'  <div class="pic-wrap">  <img src="\',image.image_middle,\'" data-action="display-pic"/>  </div>\');}_s.push(\' </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/pagenation",["../../lib/cmp/pagination/pagination","$","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/util/ajax"],function(a,b,c){var d=a("../../lib/cmp/pagination/pagination"),e=d.extend({attrs:{initRun:!0},view:function(){var a='<input type="button" class="btn" value="<" data-action="prev"/>';return a+=this.classicHTML(),a+='<input type="button" class="btn" value=">" data-action="next"/>',this.element.html(a),this.reflow(),this.get("initRun")&&this.get("success")&&this.get("success").call(this,this.get("current")),this.set("initRun",!0),this}});c.exports=e}),define("dist/lib/cmp/pagination/pagination",["$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../../util/ajax"],function(a){var b=a("$"),c=a("../widget"),d=a("../../util/ajax"),e={tpl:function(a,b,c){var d='<a href="'+(c===!0?"#":a+b)+'" data-page="'+b+'" data-action="page">'+b+"</a>";return d}},f=c.extend({attrs:{url:"",type:"ajax",data:null,before:null,success:null,error:null,method:"get",pageName:"page",sizeName:"pagesize",totalName:"data.total",pageIndexOffset:0,size:12,current:{value:1,setter:function(a){if(a)return+a||0;var b=Math.ceil(this.get("total")/this.get("size"));return Math.min(Math.max(a,1),b)}},total:0,template:'<div class="widget-pagination"></div>'},setup:function(){f.superclass.setup.call(this),this._init=!0},events:{"click [data-action=prev]":function(a){"link"!==this.get("type")&&(b(a.target).hasClass("disabled")||this.prev(),a.preventDefault())},"click [data-action=page]":function(a){"link"!==this.get("type")&&(this.load(b(a.target).attr("data-page")),a.preventDefault())},"click [data-action=next]":function(a){"link"!==this.get("type")&&(b(a.target).hasClass("disabled")||this.next(),a.preventDefault())}},prev:function(){return this.set("current",Math.max(1,this.get("current")-1)),this},next:function(){var a=Math.ceil(this.get("total")/this.get("size"));return this.set("current",Math.min(a,this.get("current")+1)),this},load:function(a){return this.set("current",+a),this},classicHTML:function(){var a,c="post"===this.get("method").toLowerCase(),d=this.get("url"),f=(this.get("x")||2,this.get("y")||1,this.get("size")),g=Math.ceil(this.get("total")/f),h=this.get("current"),i=this.get("sizeName"),j=this.get("pageName"),k=[],l=["",""],m="<span>...</span>";if(c||(d+=-1===d.indexOf("?")?"?":"&",d+=b.param(this.get("data")||{}),-1===d.indexOf(i+"=")&&(d+=i+"="+f+"&"),-1===d.indexOf(j+"=")&&(d+=j+"=")),this.get("showPN")!==!1&&(l[0]='<a href="'+(c?"#":d+Math.max(1,h-1))+'" data-action="prev">上一页</a>',l[1]='<a href="'+(c?"#":d+Math.min(g,h+1))+'" data-action="next">下一页</a>'),5>=g)for(a=1;g>=a;a++)k.push(e.tpl(d,a,c));else if(3>=h){for(a=1;4>=a;a++)k.push(e.tpl(d,a,c));k.push(m,e.tpl(d,g,c))}else if(h>=g-2)for(k.push(e.tpl(d,1,c),m),a=g-2;g>=a;a++)k.push(e.tpl(d,a,c));else k.push(e.tpl(d,1,c),m,e.tpl(d,h-1,c),e.tpl(d,h,c),e.tpl(d,h+1,c),m,e.tpl(d,g,c));return l[0]+k.join("")+l[1]},view:function(a){var c=this.get("size"),d=this.get("current");return this.element.html(this.classicHTML()),this.reflow(),"ajax"===this.get("type")?a!==!1&&this.ajax():this.get("success")&&this.get("success").call(this,d,b.isArray(this.get("data"))?this.get("data").splice((d-1)*c,Math.min(this.get("data").length,d*c)):[]),this},reflow:function(){var a=this.get("current"),b=Math.ceil(this.get("total")/this.get("size"));return this.$("[data-action=prev]").toggleClass("disabled",1>=a),this.$("[data-action=next]").toggleClass("disabled",a>=b),this.$("[data-page]").removeClass("active"),this.$("[data-page="+a+"]").addClass("active"),this},ajax:function(){var a=this,c=d.single(this.cid),e={},f=["before","error","complete"],g={url:this.get("url"),success:function(b){for(var c=a.get("totalName").split("."),d=b,e=+a.get("total"),f=0,g=c.length;g>f;f++)d&&(d=d[c[f]]);a.checkTotal(d,e),a.get("success")&&a.get("success").call(a,a.get("current"),b)}},h=this.get("data");h=b.isFunction(h)?h.call(this):h,e[this.get("pageName")]=+this.get("current")+ +this.get("pageIndexOffset"),e[this.get("sizeName")]=this.get("size"),g.data="object"==typeof h?b.extend(e,h):h,g.type=this.get("method");for(var i=0,j=f.length;j>i;i++){var k=f[i];a.get(k)&&(g[k]=a.get(k).call(a))}return c.send(g)},checkTotal:function(a,b){var c=this.get("current"),d=this.get("size");if(a=+a||0,b!==a){var e=Math.ceil(a/d);this.set("total",a,{silent:!0}),c>e?this.set("current",e):this.view(!1)}},_onRenderCurrent:function(){this.view()},_onRenderTotal:function(){this._init!==!0?this.view():delete this._init}});return f}),define("dist/lib/util/ajax",["$"],function(a,b,c){var d=a("$"),e={},f={},g={loginPage:"/",noPermissionAction:function(){location.href=g.loginPage},errorAction:function(){}},h={success:function(a){return a&&200===+a.code},permission:function(a){return a&&401===+a.code}},i=function(a,b,c){var e;return e=b&&b.rule&&d.isFunction(b.rule[c])?b.rule[c]:h[c],e(a)===!0};d(document).keydown(function(a){return 27===a.keyCode?!1:void 0}),window.ActiveXObject&&d.ajaxSetup({cache:!1});var j={setSuccessRule:function(a){h.success=function(b){return a(b)},j.setSuccessRule=null},setPermissionRule:function(a){h.permission=function(b){return a(b)},j.setPermissionRule=null},setNoPermissionAction:function(a){g.noPermissionAction=a,j.setNoPermissionAction=null},setErrorAction:function(a){g.errorAction=a,j.setErrorAction=null},base:function(a){var b=d.extend({},a||{});return!b.before||b.before&&b.before()!==!1?(b.dataType="json",b.type=a.type||"GET",b.success=function(c){i(c,b,"success")?a.success&&a.success(c):i(c,b,"permission")?d.isFunction(a.permission)?a.permission(c):g.noPermissionAction():d.isFunction(a.error)?a.error(c):g.errorAction(c)},b.error=function(b,c){"abort"!==c&&(d.isFunction(a.error)?a.error(b,c):g.errorAction(b,c))},b.complete=function(b,c){d.isFunction(a.complete)&&a.complete(b,c)},d.ajax(b)):void 0},single:function(a){e[a]||(e[a]={});var b={send:function(b){var c=e[a].url&&b.url===e[a].url;if(c)if(typeof b.data==typeof e[a].data&&"object"==typeof b.data){for(var f in b.data)if(b.data[f]!==e[a].data[f]){c=!1;break}}else c=b.data===e[a].data;if(c)return!1;e[a].xhr&&e[a].xhr.abort();var g=b.complete;b.complete=function(b,c){e[a]={},d.isFunction(g)&&g(b,c)},e[a]={xhr:j.base(b),url:b.url,data:b.data}},abort:function(){e[a]&&e[a].xhr&&4!==e[a].xhr.readyState&&(e[a].xhr.abort(),e[a].xhr=null)}};return b},pool:function(a,b,c){if(!f[a]){var e=0;f[a]={};var g=f[a];b=Math.max(1,parseInt(b,10)||1),c=Math.max(1,parseInt(c,10)||1);for(var h=1;c>=h;h++)g[h]=[];var i={},k=function(){if(b>e)for(var a=1;c>=a;a++)if(g[a].length>0){var f=g[a].shift();if(f){var h=+new Date+"_"+Math.random(),l=f.complete;e++,f.complete=function(a){return function(b,c){e--,"success"!==c&&b&&b.abort(),d.isFunction(l)&&l(b,c),i[a]=null,delete i[a],k()}}(h),i[h]=j.base(f);break}}},l={add:function(a,b){b&&g[b]?g[b].push(a):g[c].push(a),k()},abort:function(){if(g){for(var a=1;c>=a;a++)g[a].length=0;for(var b in i)i[b].abort()}}};return l}}};c.exports=j}),define("dist/lib/util/dom/image",["$"],function(a,b,c){var d,e=a("$"),f={getCssPrefix:function(){var a=!1;return function(){var b=document.createElement("div");return a=b.style.MozTransform!==d?"Moz":b.style.webkitTransform!==d?"webkit":b.style.OTransform!==d?"O":""}}()},g={load:function(){var a=[],b=null,c=function(){for(var b=0;b<a.length;b++)a[b].end?a.splice(b--,1):a[b]();!a.length&&d()},d=function(){clearInterval(b),b=null};return function(d){var e,f,g,h,i,j=new Image;j.src=d.url,j.complete?(d.ready.call(j),d.load&&d.load.call(j)):(f=j.width,g=j.height,j.onerror=function(){d.error&&d.error.call(j),e.end=!0,j=j.onload=j.onerror=null},e=function(){h=j.width,i=j.height,(h!==f||i!==g||h*i>1024)&&(d.ready.call(j),e.end=!0)},e(),j.onload=function(){!e.end&&e(),d.load&&d.load.call(j),j=j.onload=j.onerror=null},e.end||(a.push(e),null===b&&(b=setInterval(c,40))))}}(),zoom:function(a){var b=a.node[0]||a.node,c=a.width||b.width,d=a.height||b.height,e=a.maxWidth||a.max,f=a.maxHeight||a.max,g=a.overflow===!0;return(c>e||d>f)&&(g?c>d?(c/=d/f,d=f):(d/=c/e,c=e):c>d?(d/=c/e,c=e):(c/=d/f,d=f)),a.callback&&a.callback.call(b,c,d),{width:c,height:d}},center:function(a){var b=a.node[0]||a.node,c=(a.height-b.height)/2,d=(a.width-b.width)/2;return a.callback&&a.callback.call(b,c,d),{top:c,left:d}},rotate:function(a){var b=a.node[0]||a.node,c=a.dir,g=f.getCssPrefix();if(b.degree===d&&(b.degree=0,g!==!1&&a.animate!==!1&&(g?b.style[g+"Transition"]="-"+g.toLowerCase()+"-transform .2s ease-in":b.style.transition="transform .2s ease-in")),c===!0?b.degree-=90:b.degree+=90,g){var h="rotate("+b.degree+"deg)";g?b.style[g+"Transform"]=h:b.style.transform=h,a.callback&&a.callback.call(b)}else{var i=e(b),j=Math.PI/180,k=b.degree*j,l=Math.sin(k),m=Math.cos(k),n=i.position();i.css({filter:'progid:DXImageTransform.Microsoft.Matrix(M11="'+m+'", M12="'+-l+'", M21='+l+', M22="'+m+'", sizingMethod="auto expand")',left:n.left+(i.width()-i.height())/2,top:n.top-(i.width()-i.height())/2}),a.callback&&a.callback.call(b)}}};c.exports=g}),define("dist/app/common/upload-pic",["$","../../lib/util/dom/upload/upload","../../lib/util/class","../../lib/util/dom/upload/upload-swfupload","../../lib/util/dom/upload/swfupload","../../lib/util/base","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/util/dom/upload/upload-html5","../../lib/util/dom/upload/upload-draggable","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./singleton-tip","./tpl/pic","../../lib/util/dom/image","./helper/inputor","../../lib/util/dom/selection","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/util/string"],function(a){var b=a("$"),c=a("../../lib/util/dom/upload/upload"),d=a("./dialog/singleton"),e=(a("./singleton-tip"),a("./tpl/pic")),f=a("../../lib/util/dom/image"),g=a("./helper/inputor"),h=function(a){d.show({title:"上传错误",content:a,buttons:[{text:"确定",action:"close"}]})};return function(a){var i=g.getEditorWrap(a),j=g.getTextarea(a),k=j.data("atCache"),l=i.find(".upload-pic-btn"),m=l.parent().addClass("upload-pic-btn"),n=b(".pics",i),o=0,p=b(".stat",i),q=new c({url:"/adapter/s/upload_api/image",swf:"/static/swf/swfupload.swf",node:a,type:"*.jpg; *.jpeg; *.gif; *.png",maxSize:"3MB",maxCount:-1,_maxCount:9,multi:!0,max:2,fileName:"image",data:{},height:80}).on("overSizeLimit",function(){h("超过限制大小")}).on("zeroSize",function(){h("空文件")}).on("overCountLimit",function(){h("文件数量超过限制")}).on("notAllowType",function(){h("文件类型错误")}).on("successAdd",function(a){{var b;this.successList?!0:!1}if(b=n.children().not(".error, .upload-pic-btn").length+1,b<=this.get("_maxCount")){var c=e.render(a);m.before(c),o=b,p.html(+o+"/9"),q.upload()}b>=this.get("_maxCount")&&m.width(0)}).on("errorAdd",function(){h("加入队列失败")}).on("progress",function(a,b,c){var d=parseInt(100*b/c,10),e=n.find(".index-"+a.index);e.find(".progress .num span").html(d),e.find(".progress .loaded").width(d+"%")}).on("success",function(a,c){var e=n.find(".index-"+a.index);200===c.code?(c=c.data,e.data("image-id",c.image_id),j.val()||j.val("分享图片").focus().blur(),f.load({url:"/adapter/s/upload_api/image/id/"+c.image_id+"/type/s",ready:function(){var a=this;f.zoom({node:b(a),maxWidth:100,maxHeight:80,overflow:!0,callback:function(c,d){a.width=c,a.height=d,b(a).css({width:c,height:d})}}),f.center({node:b(a),width:100,height:80,callback:function(c,d){b(a).css({top:c,left:d})}})},load:function(){var a=this;e.find(".pic").replaceWith(a),b(a).addClass("pic"),e.addClass("success")},error:function(){h("加载图片失败"),e.addClass("error")}})):(d.show({title:c.code,content:c.msg,buttons:[{text:"确定",action:"close"}]}),h("上传失败"),e.addClass("error"))}).on("error",function(a){var b=n.find(".index-"+a.index);h("上传失败"),b.addClass("error")}).on("complete",function(){k.validate()}).on("remove",function(a,b){var c,d=n.find(".index-"+b);d.remove(),o-=1,p.html(+o+"/9"),c=n.children().not(".error, .upload-pic-btn").length,c<this.get("_maxCount")&&m.width(100)}).on("reset",function(){b(".pic-wrapper",i).last().width(100).siblings().remove(),o=0,p.html(+o+"/9")});return n.on("click",".pic-mask",function(a){q.remove(b(a.target).closest(".pic-wrapper").data("index"))}),q}}),define("dist/lib/util/dom/upload/upload",["../../class","./upload-swfupload","$","./swfupload","../../base","../../event","../../aspect","../../attribute","./upload-html5","./upload-draggable"],function(a,b,c){var d=a("../../class"),e=a("./upload-swfupload"),f=a("./upload-html5"),g=d.create({Extends:f.isSupportHTML5Upload?f:e});g.isSupportHTML5Upload=f.isSupportHTML5Upload,c.exports=g}),define("dist/lib/util/dom/upload/upload-swfupload",["$","./swfupload","../../base","../../class","../../event","../../aspect","../../attribute"],function(a,b,c){var d=a("$"),e=a("./swfupload"),f=a("../../base"),g=f.extend({attrs:{url:"",swf:"",node:"",type:"*",maxSize:"5MB",maxCount:-1,multi:!0,disabled:!1,requeueOnError:!1,fileName:"Filedata",data:{},method:"post",customSettings:{},dataType:"json",backgroundImage:"",width:100,height:24,text:"",textStyle:"",description:"选择文件",cursor:e.CURSOR.ARROW,mode:e.WINDOW_MODE.TRANSPARENT,debug:!1,cache:!1},initialize:function(){var a=this;g.superclass.initialize.apply(this,arguments);var b={};b.upload_url=this.get("url"),b.flash_url=this.get("swf"),b.button_placeholder_id=d(this.get("node")).attr("id"),b.file_types=function(a){for(var b=a.split(";"),c=[],d=0,e=b.length;e>d;d++)c.push(b[d].toLowerCase(),b[d].toUpperCase());return c.join(";")}(this.get("type")),b.file_size_limit=this.get("maxSize").toUpperCase(),-1!==this.get("maxCount")&&(b.file_upload_limit=this.get("maxCount"),b.file_queue_limit=this.get("maxCount")),b.button_action=this.get("multi")===!1?e.BUTTON_ACTION.SELECT_FILE:e.BUTTON_ACTION.SELECT_FILES,b.requeue_on_error=this.get("requeueOnError"),b.file_post_name=this.get("fileName"),b.post_params=this.get("data"),b.use_query_string="get"===this.get("method").toLowerCase(),b.custom_settings=this.get("customSettings"),b.button_image_url=this.get("backgroundImage"),b.button_width=this.get("width"),b.button_height=this.get("height"),b.button_text=this.get("text"),b.file_types_description=this.get("description"),b.button_cursor=this.get("cursor"),b.button_window_mode=this.get("mode"),b.button_text_style=this.get("textStyle"),(window.ActiveXObject||this.get("cache"))&&(b.prevent_swf_caching=!0),b.swfupload_loaded_handler=function(){a.trigger("flashLoaded"),a.get("disabled")&&a.disable()},b.file_dialog_start_handler=function(){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),a.trigger("dialogStart")},b.file_queued_handler=function(b){b&&a.trigger("successAdd",b)},b.file_queue_error_handler=function(c,d,f){d==e.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED?a.trigger("overCountLimit",b.file_queue_limit):d==e.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT?a.trigger("overSizeLimit",b.file_size_limit,c):d==e.QUEUE_ERROR.ZERO_BYTE_FILE?a.trigger("zeroSize",c):d==e.QUEUE_ERROR.INVALID_FILETYPE&&a.trigger("notAllowType",c),a.trigger("errorAdd",c,d,f)},b.file_dialog_complete_handler=function(b,c){a.trigger("dialogComplete",c,b)},b.upload_start_handler=function(b){b&&a.trigger("uploadStart",b)},b.upload_progress_handler=function(b,c,d){b&&a.trigger("progress",b,c,d)},b.upload_error_handler=function(b,c,d){b&&a.trigger("error",b,c,d)},b.upload_success_handler=function(b,c){b&&a.trigger("success",b,"json"===a.get("dataType").toLowerCase()?d.parseJSON(c):c)},b.upload_complete_handler=function(b){this.startUpload();var c=a.swfupload.getStats();c=c||{},c.in_progress||0!=c.files_queued||a.trigger("complete",b),b&&a.trigger("finish",b)},b.debug_handler=function(b){"function"==typeof a.get("debug")&&a.get("debug")(b)},this.swfupload=new e(b)},remove:function(a){var b=this.swfupload.getFile(a),c=this.swfupload.getStats();return c?(c.in_progress&&this.abort(a),c.successful_uploads--,this.swfupload.setStats(c),this.trigger("remove",b,a),this):(this.trigger("remove",b,a),this)},abort:function(a){a=+a;var b=this.swfupload.getFile(a);return this.swfupload.cancelUpload(b.id),this.trigger("abort",b,a),this},upload:function(){return this.swfupload.startUpload(),this},reset:function(){var a=this.swfupload,b=a.getStats();return b=b||{},b.in_progress&&a.stopUpload(),b.successful_uploads=0,b.upload_errors=0,b.upload_cancelled=0,b.queue_errors=0,a.setStats(b),this.set("disabled",!1),this.trigger("reset"),this},enable:function(){return this.set("disabled",!1),this},disable:function(){return this.set("disabled",!0),this},_onChangeUrl:function(a){this.swfupload.setUploadURL(a)},_onChangeDisabled:function(a){var b=this.swfupload;b.setButtonDisabled(!!a)}});c.exports=g}),define("dist/lib/util/dom/upload/swfupload",[],function(require,exports,module){var SWFUpload,swfobject;void 0==SWFUpload&&(SWFUpload=function(a){this.initSWFUpload(a)}),SWFUpload.prototype.initSWFUpload=function(a){try{this.customSettings={},this.settings={},this.eventQueue=[],this.movieName="SWFUpload_"+SWFUpload.movieCount++,this.movieElement=null,SWFUpload.instances[this.movieName]=this,this.initSettings(a),this.loadSupport(),this.swfuploadPreload()&&this.loadFlash(),this.displayDebugInfo()}catch(b){throw delete SWFUpload.instances[this.movieName],b}},SWFUpload.instances={},SWFUpload.movieCount=0,SWFUpload.version="2.5.0 2010-01-15 Beta 2",SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130},SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290,RESIZE:-300},SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5},SWFUpload.UPLOAD_TYPE={NORMAL:-1,RESIZED:-2},SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120,JAVASCRIPT:-130,NONE:-130},SWFUpload.CURSOR={ARROW:-1,HAND:-2},SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"},SWFUpload.RESIZE_ENCODING={JPEG:-1,PNG:-2},SWFUpload.completeURL=function(a){try{var b="",c=-1;return"string"!=typeof a||a.match(/^https?:\/\//i)||a.match(/^\//)||""===a?a:(c=window.location.pathname.lastIndexOf("/"),b=0>=c?"/":window.location.pathname.substr(0,c)+"/",b+a)}catch(d){return a}},SWFUpload.onload=function(){},SWFUpload.prototype.initSettings=function(a){this.ensureDefault=function(b,c){var d=a[b];this.settings[b]=void 0!=d?d:c},this.ensureDefault("upload_url",""),this.ensureDefault("preserve_relative_urls",!1),this.ensureDefault("file_post_name","Filedata"),this.ensureDefault("post_params",{}),this.ensureDefault("use_query_string",!1),this.ensureDefault("requeue_on_error",!1),this.ensureDefault("http_success",[]),this.ensureDefault("assume_success_timeout",0),this.ensureDefault("file_types","*.*"),this.ensureDefault("file_types_description","All Files"),this.ensureDefault("file_size_limit",0),this.ensureDefault("file_upload_limit",0),this.ensureDefault("file_queue_limit",0),this.ensureDefault("flash_url","swfupload.swf"),this.ensureDefault("flash9_url","swfupload_fp9.swf"),this.ensureDefault("prevent_swf_caching",!0),this.ensureDefault("button_image_url",""),this.ensureDefault("button_width",1),this.ensureDefault("button_height",1),this.ensureDefault("button_text",""),this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;"),this.ensureDefault("button_text_top_padding",0),this.ensureDefault("button_text_left_padding",0),this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES),this.ensureDefault("button_disabled",!1),this.ensureDefault("button_placeholder_id",""),this.ensureDefault("button_placeholder",null),this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW),this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW),this.ensureDefault("debug",!1),this.settings.debug_enabled=this.settings.debug,this.settings.return_upload_start_handler=this.returnUploadStart,this.ensureDefault("swfupload_preload_handler",null),this.ensureDefault("swfupload_load_failed_handler",null),this.ensureDefault("swfupload_loaded_handler",null),this.ensureDefault("file_dialog_start_handler",null),this.ensureDefault("file_queued_handler",null),this.ensureDefault("file_queue_error_handler",null),this.ensureDefault("file_dialog_complete_handler",null),this.ensureDefault("upload_resize_start_handler",null),this.ensureDefault("upload_start_handler",null),this.ensureDefault("upload_progress_handler",null),this.ensureDefault("upload_error_handler",null),this.ensureDefault("upload_success_handler",null),this.ensureDefault("upload_complete_handler",null),this.ensureDefault("mouse_click_handler",null),this.ensureDefault("mouse_out_handler",null),this.ensureDefault("mouse_over_handler",null),this.ensureDefault("debug_handler",this.debugMessage),this.ensureDefault("custom_settings",{}),this.customSettings=this.settings.custom_settings,this.settings.prevent_swf_caching&&(this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime(),this.settings.flash9_url=this.settings.flash9_url+(this.settings.flash9_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()),this.settings.preserve_relative_urls||(this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url),this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)),delete this.ensureDefault},SWFUpload.prototype.loadSupport=function(){this.support={loading:swfobject.hasFlashPlayerVersion("9.0.28"),imageResize:swfobject.hasFlashPlayerVersion("10.0.0")}},SWFUpload.prototype.loadFlash=function(){var a,b,c,d,e;if(!this.support.loading)return void this.queueEvent("swfupload_load_failed_handler",["Flash Player doesn't support SWFUpload"]);if(null!==document.getElementById(this.movieName))return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Element ID already in use"]);if(a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder,void 0==a)return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["button place holder not found"]);c="block"!==(a.currentStyle&&a.currentStyle.display||window.getComputedStyle&&document.defaultView.getComputedStyle(a,null).getPropertyValue("display"))?"span":"div",b=document.createElement(c),d=this.getFlashHTML();try{b.innerHTML=d}catch(f){return this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Exception loading Flash HTML into placeholder"])}return e=b.getElementsByTagName("object"),!e||e.length>1||0===e.length?(this.support.loading=!1,void this.queueEvent("swfupload_load_failed_handler",["Unable to find movie after adding to DOM"])):(1===e.length&&(this.movieElement=e[0]),a.parentNode.replaceChild(b.firstChild,a),void(void 0==window[this.movieName]&&(window[this.movieName]=this.getMovieElement())))},SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" />','<param name="quality" value="high" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")},SWFUpload.prototype.getFlashVars=function(){var a,b;return b=this.buildParamString(),a=this.settings.http_success.join(","),["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")},SWFUpload.prototype.getMovieElement=function(){if(void 0==this.movieElement&&(this.movieElement=document.getElementById(this.movieName)),null===this.movieElement)throw"Could not find Flash element";return this.movieElement},SWFUpload.prototype.buildParamString=function(){var a,b,c=[];if(b=this.settings.post_params,"object"==typeof b)for(a in b)b.hasOwnProperty(a)&&c.push(encodeURIComponent(a.toString())+"="+encodeURIComponent(b[a].toString()));return c.join("&amp;")},SWFUpload.prototype.destroy=function(){var a;try{if(this.cancelUpload(null,!1),a=this.cleanUp())try{a.parentNode.removeChild(a)}catch(b){}return window[this.movieName]=null,SWFUpload.instances[this.movieName]=null,delete SWFUpload.instances[this.movieName],this.movieElement=null,this.settings=null,this.customSettings=null,this.eventQueue=null,this.movieName=null,!0}catch(c){return!1}},SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","flash9_url:                ",this.settings.flash9_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_cursor:            ",this.settings.button_cursor.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_preload_handler assigned:  ",("function"==typeof this.settings.swfupload_preload_handler).toString(),"\n","	","swfupload_load_failed_handler assigned:  ",("function"==typeof this.settings.swfupload_load_failed_handler).toString(),"\n","	","swfupload_loaded_handler assigned:  ",("function"==typeof this.settings.swfupload_loaded_handler).toString(),"\n","	","mouse_click_handler assigned:       ",("function"==typeof this.settings.mouse_click_handler).toString(),"\n","	","mouse_over_handler assigned:        ",("function"==typeof this.settings.mouse_over_handler).toString(),"\n","	","mouse_out_handler assigned:         ",("function"==typeof this.settings.mouse_out_handler).toString(),"\n","	","file_dialog_start_handler assigned: ",("function"==typeof this.settings.file_dialog_start_handler).toString(),"\n","	","file_queued_handler assigned:       ",("function"==typeof this.settings.file_queued_handler).toString(),"\n","	","file_queue_error_handler assigned:  ",("function"==typeof this.settings.file_queue_error_handler).toString(),"\n","	","upload_resize_start_handler assigned:      ",("function"==typeof this.settings.upload_resize_start_handler).toString(),"\n","	","upload_start_handler assigned:      ",("function"==typeof this.settings.upload_start_handler).toString(),"\n","	","upload_progress_handler assigned:   ",("function"==typeof this.settings.upload_progress_handler).toString(),"\n","	","upload_error_handler assigned:      ",("function"==typeof this.settings.upload_error_handler).toString(),"\n","	","upload_success_handler assigned:    ",("function"==typeof this.settings.upload_success_handler).toString(),"\n","	","upload_complete_handler assigned:   ",("function"==typeof this.settings.upload_complete_handler).toString(),"\n","	","debug_handler assigned:             ",("function"==typeof this.settings.debug_handler).toString(),"\n","Support:\n","	","Load:                     ",this.support.loading?"Yes":"No","\n","	","Image Resize:             ",this.support.imageResize?"Yes":"No","\n"].join(""))
},SWFUpload.prototype.addSetting=function(a,b,c){return this.settings[a]=void 0==b?c:b},SWFUpload.prototype.getSetting=function(a){return void 0!=this.settings[a]?this.settings[a]:""},SWFUpload.prototype.callFlash=function(functionName,argumentArray){var movieElement,returnValue,returnString;argumentArray=argumentArray||[],movieElement=this.getMovieElement();try{void 0!=movieElement?(returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>"),returnValue=eval(returnString)):this.debug("Can't call flash because the movie wasn't found.")}catch(ex){this.debug("Exception calling flash function '"+functionName+"': "+ex.message)}return void 0!=returnValue&&"object"==typeof returnValue.post&&(returnValue=this.unescapeFilePostParams(returnValue)),returnValue},SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")},SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")},SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])},SWFUpload.prototype.startResizedUpload=function(a,b,c,d,e,f){this.callFlash("StartUpload",[a,{width:b,height:c,encoding:d,quality:e,allowEnlarging:f}])},SWFUpload.prototype.cancelUpload=function(a,b){b!==!1&&(b=!0),this.callFlash("CancelUpload",[a,b])},SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")},SWFUpload.prototype.requeueUpload=function(a){return this.callFlash("RequeueUpload",[a])},SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")},SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])},SWFUpload.prototype.getFile=function(a){return"number"==typeof a?this.callFlash("GetFileByIndex",[a]):this.callFlash("GetFile",[a])},SWFUpload.prototype.getQueueFile=function(a){return"number"==typeof a?this.callFlash("GetFileByQueueIndex",[a]):this.callFlash("GetFile",[a])},SWFUpload.prototype.addFileParam=function(a,b,c){return this.callFlash("AddFileParam",[a,b,c])},SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])},SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString(),this.callFlash("SetUploadURL",[a])},SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a,this.callFlash("SetPostParams",[a])},SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b,this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a],this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a,this.settings.file_types_description=b,this.callFlash("SetFileTypes",[a,b])},SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a,this.callFlash("SetFileSizeLimit",[a])},SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a,this.callFlash("SetFileUploadLimit",[a])},SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a,this.callFlash("SetFileQueueLimit",[a])},SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a,this.callFlash("SetFilePostName",[a])},SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a,this.callFlash("SetUseQueryString",[a])},SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a,this.callFlash("SetRequeueOnError",[a])},SWFUpload.prototype.setHTTPSuccess=function(a){"string"==typeof a&&(a=a.replace(" ","").split(",")),this.settings.http_success=a,this.callFlash("SetHTTPSuccess",[a])},SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a,this.callFlash("SetAssumeSuccessTimeout",[a])},SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a,this.callFlash("SetDebugEnabled",[a])},SWFUpload.prototype.setButtonImageURL=function(a){void 0==a&&(a=""),this.settings.button_image_url=a,this.callFlash("SetButtonImageURL",[a])},SWFUpload.prototype.setButtonDimensions=function(a,b){this.settings.button_width=a,this.settings.button_height=b;var c=this.getMovieElement();void 0!=c&&(c.style.width=a+"px",c.style.height=b+"px"),this.callFlash("SetButtonDimensions",[a,b])},SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a,this.callFlash("SetButtonText",[a])},SWFUpload.prototype.setButtonTextPadding=function(a,b){this.settings.button_text_top_padding=b,this.settings.button_text_left_padding=a,this.callFlash("SetButtonTextPadding",[a,b])},SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a,this.callFlash("SetButtonTextStyle",[a])},SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a,this.callFlash("SetButtonDisabled",[a])},SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a,this.callFlash("SetButtonAction",[a])},SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a,this.callFlash("SetButtonCursor",[a])},SWFUpload.prototype.queueEvent=function(a,b){var c=this;if(void 0==b?b=[]:b instanceof Array||(b=[b]),"function"==typeof this.settings[a])this.eventQueue.push(function(){this.settings[a].apply(this,b)}),setTimeout(function(){c.executeNextEvent()},0);else if(null!==this.settings[a])throw"Event handler "+a+" is unknown or is not a function"},SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;"function"==typeof a&&a.apply(this)},SWFUpload.prototype.unescapeFilePostParams=function(a){var b,c,d,e=/[$]([0-9a-f]{4})/i,f={};if(void 0!=a){for(c in a.post)if(a.post.hasOwnProperty(c)){for(b=c;null!==(d=e.exec(b));)b=b.replace(d[0],String.fromCharCode(parseInt("0x"+d[1],16)));f[b]=a.post[c]}a.post=f}return a},SWFUpload.prototype.swfuploadPreload=function(){var a;if("function"==typeof this.settings.swfupload_preload_handler)a=this.settings.swfupload_preload_handler.call(this);else if(void 0!=this.settings.swfupload_preload_handler)throw"upload_start_handler must be a function";return void 0===a&&(a=!0),!!a},SWFUpload.prototype.flashReady=function(){var a=this.cleanUp();return a?void this.queueEvent("swfupload_loaded_handler"):void this.debug("Flash called back ready but the flash movie can't be found.")},SWFUpload.prototype.cleanUp=function(){var a,b=this.getMovieElement();try{if(b&&"unknown"==typeof b.CallFunction){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(a in b)try{"function"==typeof b[a]&&(b[a]=null)}catch(c){}}}catch(d){}return window.__flash__removeCallback=function(a,b){try{a&&(a[b]=null)}catch(c){}},b},SWFUpload.prototype.mouseClick=function(){this.queueEvent("mouse_click_handler")},SWFUpload.prototype.mouseOver=function(){this.queueEvent("mouse_over_handler")},SWFUpload.prototype.mouseOut=function(){this.queueEvent("mouse_out_handler")},SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")},SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("file_queued_handler",a)},SWFUpload.prototype.fileQueueError=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("file_queue_error_handler",[a,b,c])},SWFUpload.prototype.fileDialogComplete=function(a,b,c){this.queueEvent("file_dialog_complete_handler",[a,b,c])},SWFUpload.prototype.uploadResizeStart=function(a,b){a=this.unescapeFilePostParams(a),this.queueEvent("upload_resize_start_handler",[a,b.width,b.height,b.encoding,b.quality])},SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("return_upload_start_handler",a)},SWFUpload.prototype.returnUploadStart=function(a){var b;if("function"==typeof this.settings.upload_start_handler)a=this.unescapeFilePostParams(a),b=this.settings.upload_start_handler.call(this,a);else if(void 0!=this.settings.upload_start_handler)throw"upload_start_handler must be a function";void 0===b&&(b=!0),b=!!b,this.callFlash("ReturnUploadStart",[b])},SWFUpload.prototype.uploadProgress=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_progress_handler",[a,b,c])},SWFUpload.prototype.uploadError=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_error_handler",[a,b,c])},SWFUpload.prototype.uploadSuccess=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_success_handler",[a,b,c])},SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("upload_complete_handler",a)},SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)},SWFUpload.prototype.debugMessage=function(a){var b,c,d;if(this.settings.debug)if(c=[],"object"==typeof a&&"string"==typeof a.name&&"string"==typeof a.message){for(d in a)a.hasOwnProperty(d)&&c.push(d+": "+a[d]);b=c.join("\n")||"",c=b.split("\n"),b="EXCEPTION: "+c.join("\nEXCEPTION: "),SWFUpload.Console.writeLine(b)}else SWFUpload.Console.writeLine(a)},SWFUpload.Console={},SWFUpload.Console.writeLine=function(a){var b,c;try{b=document.getElementById("SWFUpload_Console"),b||(c=document.createElement("form"),document.getElementsByTagName("body")[0].appendChild(c),b=document.createElement("textarea"),b.id="SWFUpload_Console",b.style.fontFamily="monospace",b.setAttribute("wrap","off"),b.wrap="off",b.style.overflow="auto",b.style.width="700px",b.style.height="350px",b.style.margin="5px",c.appendChild(b)),b.value+=a+"\n",b.scrollTop=b.scrollHeight-b.clientHeight}catch(d){alert("Exception: "+d.name+" Message: "+d.message)}},swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}{var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();!function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))}(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}()}return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}(),swfobject.addDomLoadEvent(function(){"function"==typeof SWFUpload.onload&&SWFUpload.onload.call(window)}),module.exports=SWFUpload,window.SWFUpload=SWFUpload}),define("dist/lib/util/dom/upload/upload-html5",["$","../../base","../../class","../../event","../../aspect","../../attribute","./upload-draggable"],function(a){var b=a("$"),c=a("../../base"),d=a("./upload-draggable"),e={unit:function(a){for(var c=b.trim(a.replace(/\d+/,"")).toUpperCase(),d=b.trim(a.replace(/\D+/g,"")),e=["B","KB","MB","GB","TB"],f=0,g=0,h=e.length;h>g;g++)if(c===e[g]){f=g;break}return d*Math.pow(1e3,f)},search:function(a,b){for(var c,d=0;c=b[d];d++)if(+a===+c.index)return d;return-1},del:function(a,b){var c=e.search(a,b);return-1!==c?b.splice(c,1)[0]:void 0}},f=d.isSupportHTML5Upload,g=c.extend({attrs:{url:"",node:"",type:"*",maxSize:"5MB",maxCount:-1,multi:!0,disabled:!1,draggable:!0,container:document.body,fileName:"Filedata",data:{},dataType:"json",resultCheck:function(){},postType:"form",max:2},initialize:function(){var a=this;g.superclass.initialize.apply(this,arguments),"*"!==this.get("type")&&this.set("type",function(a){for(var c=a.split(";"),d=0,e=c.length;e>d;d++)c[d]=b.trim(c[d].toLowerCase());return c}(this.get("type"))),this.get("maxSize")&&(this._maxSize=this.get("maxSize"),this.set("maxSize",e.unit(this.get("maxSize")))),this.fileList=[],this.successList=[],this.failureList=[],this.xhrList={},this.index=0,this.status=0,this._fixUploadNode(),this.get("draggable")&&d.bind({node:b(this.get("container")).eq(0)[0],dragenter:function(b,c){a.trigger("dragenter",c)},dragover:function(b,c){a.trigger("dragover",c)},dragleave:function(b,c){a.trigger("dragleave",c)},drop:function(b,c){a.trigger("drop",c)}}),this.get("disabled")&&this.disable()},add:function(a){if(this.get("disabled")===!1){var c=this,d=a.length?a:[a],e=this.get("maxCount");if(-1!==e&&a.length+this.successList.length+this.fileList.length+this.status>e)this.trigger("overCountLimit",e);else{var f=this.get("type");if("*"!=f?function(a){for(var c,e=[],f=0;c=d[f];f++){var g=c.name.split(".");g=g[g.length-1].toLowerCase(),g="*."+g,c.index=this.index++,-1!==b.inArray(g,a)?e.push(c):(c.error=!0,this.trigger("notAllowType",c),this.trigger("errerAdd",c))}d=e}.call(this,f):b.each(d,function(a,b){b.index=c.index++}),d!==!1)for(var g,h=0;g=d[h];h++){var i=g.size;0==i?(g.error=!0,this.trigger("zeroSize",g),this.trigger("errerAdd",g)):i>this.get("maxSize")?(g.error=!0,this.trigger("overSizeLimit",this._maxSize,g),this.trigger("errerAdd",g)):(this.fileList.push(g),this.trigger("successAdd",g))}else this.trigger("errorAdd",a)}}return this},remove:function(a){var b=function(){var b=e.del(a,this.fileList),c=e.del(a,this.successList),d=e.del(a,this.failureList);return b||c||d}.call(this);return this._abortCore(a),this.trigger("remove",b,a),this},abort:function(a){a=+a;var b=function(){var b=e.del(a,this.fileList),c=e.del(a,this.successList),d=e.del(a,this.failureList);return b||c||d}.call(this);return this._abortCore(a),this.trigger("abort",b,a),this},_abortCore:function(a){a=+a;var b=this.xhrList[a];b&&(this.status--,b.abort(),delete this.xhrList[a],this.upload())},upload:function(){var a=this,c=this.get("postType");if(this.status=Math.max(this.status,0),this.status<this.get("max")){var d=this.fileList.shift();if(d&&(this.status++,f)){var e=new XMLHttpRequest;if(this.xhrList[d.index]=e,this.trigger("uploadStart",d)===!1)a.trigger("error",d,"refuse");else{e.upload.addEventListener("progress",function(b){a.trigger("progress",d,b.loaded,b.total)},!1);var g=function(b){a.status--,delete a.xhrList[b.index],0==a.fileList.length&&a.status<=0?a.trigger("complete",b):a.upload()};if(e.onload=function(){var c=e.responseText;try{var f=!0;"json"===a.get("dataType")&&(c=JSON.parse(e.responseText)),b.isFunction(a.get("resultCheck"))&&(f=a.get("resultCheck")(c)!==!1),f?(a.trigger("success",d,c),a.successList.push(d)):(a.trigger("error",d,c),a.failureList.push(d))}catch(h){a.trigger("error",d,c),a.failureList.push(d)}finally{a.trigger("finish",d),g(d)}},e.onerror=function(){a.trigger("finish",d),g(d)},e.open("POST",this.get("url"),!0),"form"===c){var h=new FormData;(function(){for(var a in this.get("data"))h.append(a,this.get("data")[a])}).call(this),h.append(this.get("fileName"),d),e.send(h)}else if(e.setRequestHeader(this.get("fileName"),d.name),function(){for(var a in this.get("data"))e.setRequestHeader(a,this.get("data")[a])}.call(this),"blob"===c){var i,j=window.MozBlobBuilder||window.WebKitBlobBuilder||window.MSBlobBuilder||window.BlobBuilder,k=new j;k.append(d),i=k.getBlob(),e.send(i)}else if("buffer"===c){var l=new FileReader;l.readAsArrayBuffer(d),l.onload=function(){e.send(this.result)}}else e.send(d);this.upload()}}}return this},reset:function(){for(var a in this.xhrList){var b=this.xhrList[a];b&&b.abort&&b.abort(),delete this.xhrList[a]}return this.fileList.length=0,this.successList.length=0,this.failureList.length=0,this.status=0,this._fixUploadNode(),this.set("disabled",!1),this.trigger("reset"),this},enable:function(){return this.set("disabled",!1),this},disable:function(){return this.set("disabled",!0),this},_onChangeDisabled:function(a){var b=this.get("node");b&&(b=b.children("input:file"),a?b.prop("disabled","disabled"):b.removeProp("disabled"))},getStatus:function(){var a=this.status,b=0;return a>0?b=1:this.fileList.length>0&&(b=1),b},_fixUploadNode:function(){var a=this,c=this.get("node");if(c){var d=b('<a class="upload-select-btn" href="javascript:;"><input type="file" '+(this.get("multi")?' multiple="true"':"")+' name="'+this.get("fileName")+'" /></a>');b(c).replaceWith(d),this.set("node",d),d.children("input:file").change(function(){a.add(this.files)})}}});return g.preview=function(a,b){var c=new FileReader;c.readAsDataURL(a),c.onload=function(){b&&b.call(this,a,this.result)}},g.isSupportHTML5Upload=f,g}),define("dist/lib/util/dom/upload/upload-draggable",["$"],function(a,b,c){var d=a("$"),e=!1;!function(){if("undefined"!=typeof XMLHttpRequest){var a=new XMLHttpRequest;e=!!a.upload}}();var f={addEventListener:function(a,b,c){a.addEventListener(b,function(a){var d=a.target.files||a.dataTransfer.files;if("drop"===b)try{d&&d.length&&c&&c(a,d)}catch(a){}else c&&c(a,d);a.stopPropagation(),a.preventDefault()},!1)}},g={bind:function(a){a=a||{};var b=a.node||document.body,c=["dragenter","dragover","dragleave","drop"];return d.each(c,function(c,d){f.addEventListener(b,d,a[d])}),{unbind:function(){d.each(c,function(c,d){f.removeEventListener(b,d,a[d])})}}},isSupportHTML5Upload:e};d(function(){e&&f.addEventListener(document.body,"drop",function(a){a.stopPropagation(),a.preventDefault()})}),c.exports=g}),define("dist/app/common/tpl/pic",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="pic-wrapper index-\',index,\'" data-index="\',index,\'">  <div class="progress">  <div class="num">  <span>0</span>%  </div>  <div class="bar">  <div class="loaded"></div>  </div>  </div>  <img class="pic" alt="pic" />  <p class="error">上传失败</p>  <div class="pic-mask"></div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/new-weibo",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","../expression/expression","../../../lib/cmp/tip/tip","../../../lib/cmp/tip/basic-tip","../../../lib/cmp/popup","../../../lib/cmp/tip/tpl/tip","../../../lib/cmp/switchable/tabs","../../../lib/cmp/switchable/switchable","../../../lib/cmp/switchable/plugins/effects","../../../lib/util/dom/easing","../../../lib/cmp/switchable/plugins/autoplay","../../../lib/cmp/switchable/plugins/circular","../helper/inputor","../../../lib/util/dom/selection","../../../lib/util/dom/inputor","../../../lib/util/timer","../../../lib/util/string","../expression/tpl/container","../expression/tpl/item","../expression/tpl/expression","../expression/data","../upload-pic","../../../lib/util/dom/upload/upload","../../../lib/util/dom/upload/upload-swfupload","../../../lib/util/dom/upload/swfupload","../../../lib/util/dom/upload/upload-html5","../../../lib/util/dom/upload/upload-draggable","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","../singleton-tip","../tpl/pic","../../../lib/util/dom/image","./tpl/new-weibo","../weibo-textarea","../ajax","../_ajax","../../../lib/util/json","../../../lib/cmp/autocomplete/textarea-complete","../../../lib/cmp/autocomplete/autocomplete","../../../lib/cmp/autocomplete/data-source","../../../lib/cmp/autocomplete/filter","../../../lib/cmp/autocomplete/tpl/autocomplete","../../../lib/util/dom/placeholder"],function(a,b,c){var d=a("$"),e=a("../../../lib/cmp/dialog/dialog"),f=a("../../../lib/util/dom/action"),g=a("../expression/expression"),h=a("../upload-pic"),i=a("../helper/inputor"),j=a("./tpl/new-weibo"),k=a("../weibo-textarea"),l=e.extend({attrs:{title:"撰写新动态",repositionOnResize:!1,content:j.render(),width:600,height:200,fixed:!1,hasMask:{hideOnClick:!0},plugins:{}},setup:function(){var a=this.get("limit");l.superclass.setup.call(this),this.after("render",function(){var b=this.$("[data-role=editor]").eq(0),c=(this.$("[data-role=wordcount]").eq(0),this.$("[data-role=send]").eq(0),new k({trigger:b}).render());i.listenWordcount(b,function(){c.validate(a)});var d=this.$(".upload-pic-btn");c.u=h(d)}).after("show",function(){var a=this.$("[data-role=editor]").eq(0);a.focus()}).after("hide",function(){var a=this.get("plugins");for(var b in a)d.isFunction(a[b].hide)&&a[b].hide()})}});d(function(){var a;f.listen({"new-weibo":function(b,c){a||(a=new l({plugins:{expression:g.ins}}),l.instance=a),a.show();var d=c.attr("data-uid"),e=a.$("[data-role=editor]").eq(0);if(d){var f=c.attr("data-username");k.selectedUsersAdd(e,f,d),e.val("@"+f+" ")}var h=c.attr("data-content");h&&e.val(h),e.focus()}})}),c.exports=l}),define("dist/app/common/dialog/tpl/new-weibo",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="new-weibo-overlay new-weibo open" data-role="editor-wrap">  <div class="input-group-wrapper">  <div class="input-group">  <textarea class="new-weibo-content large input-group-text" placeholder="撰写新动态..." data-role="editor"></textarea>  </div>  </div>  <div class="gear-bar">  <span class="gear smiley-button" data-action="expression"></span>  <span class="gear topic-button" data-action="topic"></span>  <span class="gear at-button" data-action="at"></span>  <span class="gear pic-button" data-action="toggleUploadPic"></span>  <span class="remain" data-role="wordcount">2000</span>  <div class="submit button disabled" data-role="send" data-action="submitNewWeibo">  <span class="text">发送</span>  <img class="loading" src="/static/themes/default/images/loading.gif" />  </div>  </div>  <div class="pic-upload">  <div class="pics">  <div class="pic-wrapper"> <div class="upload-pic-btn" id="nav-upload-pic"></div> </div>  </div>  <div class="pic-stat">  <div class="fold" data-action="toggleUploadPic"></div>  已上传 <span class="stat">0/9</span>  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/repost",["$","./new-weibo","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","../expression/expression","../../../lib/cmp/tip/tip","../../../lib/cmp/tip/basic-tip","../../../lib/cmp/popup","../../../lib/cmp/tip/tpl/tip","../../../lib/cmp/switchable/tabs","../../../lib/cmp/switchable/switchable","../../../lib/cmp/switchable/plugins/effects","../../../lib/util/dom/easing","../../../lib/cmp/switchable/plugins/autoplay","../../../lib/cmp/switchable/plugins/circular","../helper/inputor","../../../lib/util/dom/selection","../../../lib/util/dom/inputor","../../../lib/util/timer","../../../lib/util/string","../expression/tpl/container","../expression/tpl/item","../expression/tpl/expression","../expression/data","../upload-pic","../../../lib/util/dom/upload/upload","../../../lib/util/dom/upload/upload-swfupload","../../../lib/util/dom/upload/swfupload","../../../lib/util/dom/upload/upload-html5","../../../lib/util/dom/upload/upload-draggable","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","../singleton-tip","../tpl/pic","../../../lib/util/dom/image","./tpl/new-weibo","../weibo-textarea","../ajax","../_ajax","../../../lib/util/json","../../../lib/cmp/autocomplete/textarea-complete","../../../lib/cmp/autocomplete/autocomplete","../../../lib/cmp/autocomplete/data-source","../../../lib/cmp/autocomplete/filter","../../../lib/cmp/autocomplete/tpl/autocomplete","../../../lib/util/dom/placeholder","../weibo-manager","../tpl/weibo","../tpl/comment","../tpl/weibo-pic","../../../lib/util/date","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../action/api","./tpl/repost","./tpl/repost-referer"],function(a,b,c){var d=a("$"),e=a("./new-weibo"),f=a("../../../lib/util/dom/action"),g=a("../expression/expression"),h=a("../weibo-textarea"),i=a("../weibo-manager"),j=a("../action/api"),k=a("../helper/inputor"),l={dialog:a("./tpl/repost"),referer:a("./tpl/repost-referer")},m=e.extend({attrs:{title:"转发",limit:140,content:l.dialog.render(),plugins:{},referer:{}},setup:function(){m.superclass.setup.call(this),this.after("show",function(){var a=this.get("referer");
this.$("[data-role=referer]").html(l.referer.render(a))}).after("hide",function(){this.set("referer",{})})}});d(function(){var a;f.listen({repost:function(b,c){a||(a=new m({plugins:{expression:g.ins}}));var d=c.closest("[data-role=weibo]"),e=d.find("[data-role=user]");a.set("referer",{tid:d.attr("data-tid"),user:{uid:e.attr("data-uid"),nickname:e.find("[data-role=username]").eq(0).text()},date:d.find("[data-role=date]").text(),content:d.find("[data-role=content]").html()}),a.show()},submitRepost:function(b,c){var d=a.get("referer"),e=k.getTextarea(c),f=h.transfer(e);j.repost(d.tid,f,function(b){i.prependNew(b),a.hide(),h.clear(e)},{decode:!1})}})}),c.exports=m}),define("dist/app/common/dialog/tpl/repost",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="new-weibo-overlay new-weibo open" data-role="editor-wrap">  <div class="input-group-wrapper">  <div class="referer" data-role="referer"></div>  <div class="input-group">  <textarea class="new-weibo-content large input-group-text" placeholder="转发动态..." data-role="editor"></textarea>  </div>  </div>  <div class="gear-bar">  <span class="gear smiley-button" data-action="expression"></span>  <span class="remain" data-role="wordcount">140</span>  <div class="submit button disabled" data-role="send" data-action="submitRepost">  <span class="text">发送</span>  <img class="loading" src="/static/themes/default/images/loading.gif" />  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/tpl/repost-referer",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <div class=\"referer-avatar\">',Global.Helper.avatar(user),'</div> <div class=\"referer-main\">',Global.Helper.userLink(user),' <span class=\"date\">',date,'</span>  <div class=\"referer-content\">',content,'</div> </div>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/dialog/pic-display",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","../../../lib/util/dom/image","./tpl/pic-display"],function(a,b,c){var d=a("$"),e=a("../../../lib/cmp/dialog/dialog"),f=a("../../../lib/util/dom/action"),g=a("../../../lib/util/dom/image"),h=a("./tpl/pic-display"),i=e.extend({attrs:{template:h.render({cur:0,pics:[]}),repositionOnResize:!1,fixed:!0,current:null,sourceData:null,beforeShow:function(){var a=d(window).width(),b=d(window).height(),c=a>1024?1024:400>a?400:a,e=b>848?768:300>b?300:b-80;this.set("width",c),this.set("height",e),this.element.width(c).height(e+80)},afterHide:function(){this.set("current",-1,{silent:!0})}},setup:function(){i.superclass.setup.call(this),this.delegateEvents({"click [data-role=prev]":this.prev,"click [data-role=next]":this.next,"click [data-role=pic]":this.switchTo})},prev:function(){var a=this.get("current");this._switchTo(+a-1)},next:function(){var a=this.get("current");this._switchTo(+a+1)},switchTo:function(a){var b=d(a.target).closest(".pic-wrap").index();this._switchTo(b)},_switchTo:function(a){var b=this.get("sourceData").pics.length-1;a=a>b?0:0>a?b:a,this.set("current",a)},_onRenderCurrent:function(a){var b=this.get("width"),c=this.get("height"),e=this.get("sourceData"),f=this.$("[data-role=current-pic]")[0];f.src=e.pics[a].m,this.$("[data-role=open-origin]")[0].href=e.pics[a].o,g.zoom({node:f,width:f.width,height:f.height,maxWidth:b,maxHeight:c,overflow:!1,callback:function(a,b){this.width=a,this.height=b}}),g.center({node:f,width:b,height:c,callback:function(a,b){d(this).css({top:a,left:b})}}),g.load({url:e.pics[a].o,ready:function(){var a=this;g.zoom({node:f,width:a.width,height:a.height,maxWidth:b,maxHeight:c,overflow:!1,callback:function(b,c){this.width=b,this.height=c,a.width=b,a.height=c}}),g.center({node:f,width:b,height:c,callback:function(b,c){d(this).css({top:b,left:c}),d(a).css({top:b,left:c})}})},load:function(){d(this).addClass("current-pic").attr("data-role","current-pic"),d(f).replaceWith(this)}}),this.$("[data-role=pics-container]").find(".pic-wrap").eq(a).addClass("current").siblings().removeClass("current"),this.$("[data-role=current]").text(a+1)},_onRenderSourceData:function(a){var b=h.render(a);this.element.html(b),this.$(".current-pic-wrap").height(this.get("height")),this.$(".pics-container img").each(function(a,b){g.load({url:b.src,ready:function(){b.width=this.width,b.height=this.height},load:function(){g.zoom({node:b,width:b.width,height:b.height,max:60,overflow:!0,callback:function(a,b){this.width=a,this.height=b}}),g.center({node:b,width:60,height:60,callback:function(a,b){d(this).css({top:a,left:b})}})}})})}});f.listen({"display-pic":function(a,b){var c=d(b).closest(".pic"),e=c.find("img"),f=e.index(b);e=e.toArray(),e=d.map(e,function(a){var b=a.src.slice(0,-1);return{s:b+"s",m:b+"m",o:b+"o"}}),j.show(),j.set("sourceData",{cur:f,pics:e},{}),j.set("current",f)}});var j=new i;j.render(),c.exports=j}),define("dist/app/common/dialog/tpl/pic-display",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-dialog pic-display-dialog">  <a href="javascript:void(0)" data-action="close" data-role="close" title="关闭" class="dialog-close">×</a>  <a href="#" data-role="open-origin" class="open-origin" target="_blank" title="原图">原图</a>  <div class="main">  <div class="content" data-role="content">  <div class="current-pic-wrap">  <img src="" alt="pic" class="current-pic" data-role="current-pic" />  <div class="prev-btn" data-role="prev"></div>  <div class="next-btn" data-role="next"></div>  </div>  <div class="foot-wrap">  <div class="prev-btn" data-role="prev"></div>  <div class="next-btn" data-role="next"></div>  <div class="count">  第<span data-role="current"></span>张  （共<span data-role="total">\',pics.length,\'</span>张）  </div>  <div class="pics-container" data-role="pics-container">\');for(var key=0; key<pics.length;key+=1){var pic=pics[key];_s.push(\'  <div class="pic-wrap">  <img src="\',pic.m,\'" data-role="pic" alt="pic" />  </div>\');}_s.push(\'  </div>  </div>  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/praise-list",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../action/api","../ajax","../_ajax","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","./tpl/praise-list","./tpl/praise-data"],function(a,b,c){var d=a("$"),e=a("../../../lib/cmp/dialog/dialog"),f=a("../../../lib/util/dom/action"),g=a("../../../lib/cmp/pagination/pagination"),h=a("../action/api"),i={box:a("./tpl/praise-list"),list:a("./tpl/praise-data")},j=g.extend({attrs:{initRun:!0},view:function(){var a='<input type="button" class="btn" value="<" data-action="prev"/>';return a+='<input type="button" class="btn" value=">" data-action="next"/>',this.element.html(a),this.reflow(),this.get("initRun")&&this.get("success")&&this.get("success").call(this,this.get("current")),this.set("initRun",!0),this}}),k=e.extend({attrs:{title:"赞列表",content:i.box.render(),className:"praise-dialog",width:680,page:1,pageSize:10,topic:null},setup:function(){var a,b;k.superclass.setup.apply(this,arguments),this.after("show",function(){var c=this,d=this.get("topic"),e=d.attr("data-tid"),f=this.get("page"),g=this.get("pageSize"),k=this.$("[data-role=loading]").eq(0),l=this.$("[data-role=list]").eq(0),m=this.$("[data-role=pagination]").eq(0),n=function(a,d,e){return h.praiseList(a,d,e,function(d){k.hide(),l.html(i.list.render({data:d.praisors})),setTimeout(function(){c._setPosition()},0),!b&&d.total>d.count&&(b=new j({parentNode:m,showPN:!1,total:d.total,size:e,initRun:!1,success:function(b){c.set("page",b),n(a,b,e)}}).render())})};a=n(e,f,g)}),this.after("hide",function(){a&&a.ajax&&4!==a.ajax.readyState&&a.abort&&(a.abort(),b.destroy()),this.destroy()})},show:function(a,b,c){this.set("page",b||1),this.set("pageSize",c||10),this.set("topic",a),k.superclass.show.apply(this)}});c.exports=k,d(function(){f.listen({openPraiseList:function(a,b){var c=b.closest(".weibo[data-tid]"),d=1,e=30;(new k).render().show(c,d,e)}})})}),define("dist/app/common/dialog/tpl/praise-list",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="loading" data-role="loading">正在载入...</div> <div class="list-box" data-role="list"></div> <div class="pagination-box" data-role="pagination"></div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/tpl/praise-data",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <ul>');for(var key=0; key<data.length;key+=1){var item=data[key];_s.push('  <li>',Global.Helper.avatar(item.user),' </li>');}_s.push(' </ul>'); return _s;").apply(null,c).join("")}}}),define("dist/app/user/ajaxCommon",["$","../common/ajax","../common/_ajax","../../lib/util/event","../../lib/util/json","../common/dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../common/pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","./ajaxCallback","../common/handler","../../lib/util/date","../common/tpl/no-data","../common/tpl/weiboinfo","../common/tpl/weibo","../common/tpl/weibo-pic","../common/tpl/userinfo","../message/tpl/praise","../common/tpl/no-result","../common/tpl/comment","../common/tpl/weibo-del","../common/query"],function(a,b,c){var d,e=(a("$"),a("../common/ajax")),f=a("../common/pagenation"),g=a("./ajaxCallback"),h=a("../common/query"),i=h.param("uid"),j=30,k=null,l={page:function(a,b,c){"object"==typeof d?d.destroy():"",d=new f({parentNode:".userpage",showPN:!1,total:+a.total,size:j,success:function(a){c||b(a,!1)}}).render(),c=!1}},m={common:function(a,b,c,d,f){k&&k.abort(),k=null,k=e({url:a,method:b}).done(function(a){d&&l.page(a,c,d),"web"===f?g.userWeb(a):"favor"===f?g.favorite(a):"fans"===f?g.fans(a):"idols"===f&&g.idols(a),k=null})}},n={userInfo:function(a){var b="/user_api/tally/uid/"+a,c=e({url:b,method:"GET"});return c},userWeb:function(a,b){var c="/topic_api/user_web/uid/"+i+"/page_size/"+j+"/page/"+a;m.common(c,"GET",n.userWeb,b,"web")},favorite:function(a,b){var c="/favorite_api/favorite/page_size/"+j+"/page/"+a+"/type/0";m.common(c,"GET",n.favorite,b,"favor")},fans:function(a,b){var c="/relation_api/fans/uid/"+i+"/page_size/"+j+"/page/"+a;m.common(c,"GET",n.fans,b,"fans")},idols:function(a,b){var c="/relation_api/idols/uid/"+i+"/page_size/"+j+"/page/"+a;m.common(c,"GET",n.idols,b,"idols")}};c.exports=n}),define("dist/app/user/ajaxCallback",["$","../common/handler","../../lib/util/date","../common/tpl/no-data","../common/tpl/weiboinfo","../common/tpl/weibo","../common/tpl/weibo-pic","../common/tpl/userinfo","../message/tpl/praise","../common/tpl/no-result","../common/tpl/comment","../common/tpl/weibo-del","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/util/bom/browser"],function(a,b,c){var d=(a("$"),a("../common/handler")),e=a("../../lib/util/dom/scroll"),f={scrollto:function(){e.to(window,240)}},g={userWeb:function(a){d.renderUserData(a,"weibo"),f.scrollto(),d.hidepage(a)},favorite:function(a){d.renderUserData(a,"weibo",!0),f.scrollto(),d.hidepage(a)},fans:function(a){d.renderIdolsFans(a,"fans"),f.scrollto(),d.hidepage(a)},idols:function(a){d.renderIdolsFans(a,"idols"),f.scrollto(),d.hidepage(a)}};c.exports=g}),define("dist/app/common/handler",["$","../../lib/util/date","../common/tpl/no-data","../common/tpl/weiboinfo","../common/tpl/weibo","../common/tpl/weibo-pic","../common/tpl/userinfo","../message/tpl/praise","../common/tpl/no-result","../common/tpl/comment","../common/tpl/weibo-del"],function(a,b,c){var d=a("$"),e=a("../../lib/util/date"),f={noDataTpl:a("../common/tpl/no-data"),weiboInfoTpl:a("../common/tpl/weiboinfo"),weiboTpl:a("../common/tpl/weibo"),weiboPicTpl:a("../common/tpl/weibo-pic"),userInfoTpl:a("../common/tpl/userinfo"),praiseTpl:a("../message/tpl/praise"),noResultTpl:a("../common/tpl/no-result"),comment:a("../common/tpl/comment"),weiboDelTpl:a("../common/tpl/weibo-del")},g=Global.user.uid,h=30,i={handlerData:function(a,b,c){var h=[];return h=d.map(a.topics,function(a){var c=[];return a.del=a&&a.topic&&a.topic.user?"praise"===b?a.user?!1:!0:!1:!0,c.push(a),c}),d.map(h,function(a){if(!a.del){if("weibo"!==b){var h=new Date(parseInt(a.topic.post_time+"000",10));a.topic.time=e.format(h,"yyyy年M月d日 H:m")}a.topic.own=+a.topic.uid===+g,c&&(a.topic.isrender=!0),"weibo"!==b&&a.replys&&a.replys.replylist&&d.each(a.replys.replylist,function(a,b){h=new Date(parseInt(b.post_time+"000",10)),b.time=e.format(h,"yyyy年M月d日 H:m")}),a.replys||(a.replys={count:0,replylist:[],total:0}),a.praises||(a.praises={count:0,praisors:[],total:0}),a.tpl={comment:f.comment,weiboPic:f.weiboPicTpl}}return a}),h},handlerComment:function(a){var b=[];return b=d.map(a.replylist,function(a){var b=[];return a&&a.reply&&a.reply.user&&b.push(a),b}),d.map(b,function(a){var b=new Date(parseInt(a.reply.post_time+"000",10));return a.reply.time=e.format(b,"yyyy年M月d日 H:m"),a.reply.own=a.reply.to_topic&&1===+a.reply.to_topic.exists&&a.reply.to_topic.topic&&+a.reply.to_topic.topic.uid===+g,a}),b},renderData:function(a,b,c,e){var g=d(".user-ct .weiboinfos"),h=d(".search-ht"),i=d(".search-weibo .weiboinfos");if(a.total<=0)if(d(".see-more").hide(),"search"===c){e=decodeURIComponent(e);var j=f.noResultTpl.render({keyword:e});h.html(""),i.html(j)}else g.html(f.noDataTpl.render());else d(".see-more").show(),d(".auto-loading").hide(),"search"===c?(h.html("相关信息"),i.html("")):g.html(""),d.each(b,function(a,b){"comment"===c?g.append(f.weiboInfoTpl.render(b.reply)):"weibo"===c?g.append(b.del?f.weiboDelTpl.render(b):f.weiboTpl.render(b)):"praise"===c?b.del||g.append(f.praiseTpl.render(b)):"search"===c?b.del||i.append(f.weiboTpl.render(b)):"idolFans"===c&&g.append(f.userInfoTpl.render(b))});this.hidepage(a)},hidepage:function(a){+a.total<=+h&&d(".see-more").hide()}},j={renderComment:function(a){var b=i.handlerComment(a);i.renderData(a,b,"comment")},renderWeb:function(a){var b=i.handlerData(a,"weibo",!0);i.renderData(a,b,"weibo")},renderPraise:function(a){var b=i.handlerData(a,"praise");i.renderData(a,b,"praise")},renderSearchWeb:function(a,b){var c=i.handlerData(b,"weibo",!0);i.renderData(b,c,"search",a)},renderUserData:function(a,b,c){var e=i.handlerData(a,"weibo",c);d.each(e,function(a,b){b.deletable=!0}),i.renderData(a,e,"weibo")},renderIdolsFans:function(a,b){var c=d.map(a[b],function(a){return a});i.renderData(a,c,"idolFans")},hidepage:function(){return i.hidepage}};c.exports=j}),define("dist/app/common/tpl/no-data",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <p class=\"nodata\">暂无数据</p>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/tpl/weiboinfo",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="weibo-info  weibo comment" data-tid="\',to_tid,\'"  data-id="\',rid,\'" data-role="editor-wrap">\');if(own){_s.push(\'  <div class="delete own" data-action="deleteWeibo"></div>\');}_s.push(\'  <div class="user-avar">\',Global.Helper.avatar(user),\' <div class="user-info">  <p class="userp">\',Global.Helper.userLink(user),\' </p>\');if(to_topic){if(+to_topic.exists===1){_s.push(\'  <p class="userp">\');if(to_topic.topic.uid == Global.user.uid){_s.push(\'  评论你的动态\');}else{_s.push(\'  在\',to_topic.topic.user.nickname,\'的动态中@了你\');}_s.push(\'  <span>\',Global.Helper.parseContent(to_topic.topic.content),\' </span>  </p>\');}else{_s.push(\'  <p class="userp">  原微博已删除  </p>\');}}else if(to_reply){if(+to_reply.exists===1){_s.push(\'  <p class="userp">  回复你的评论  <span>\',to_reply.reply.content,\' </span>  </p>\');}else{_s.push(\'  <p class="userp">  原评论已删除  </p>\');}}_s.push(\'  </div>  </div>  <div class="weibo-ct">  <div class="weibo-st">\',Global.Helper.parseContent(content),\'</div>  <div class="name-and-date">  <div class="date">\',time,\' 来自\',from_string,\'</div>  <div class="operate">\');if(+user.uid===+Global.user.uid||own){_s.push(\'  <span class="delcom-icon button" data-action="deleteComment"></span>\');}_s.push(\'  <span class="com-icon button" data-action="replyComment"></span>  </div>  </div>  </div>  <div class="comments hide">  <div class="comments-container" data-role="comments-container">  <div data-role="first-time">  </div>  <div data-role="next-time"></div>  </div>  <div class="commentpage"></div>  <div class="input-group">  <textarea class="reply-content large" placeholder="评论几句..." data-action="openComment" data-role="editor" ></textarea>  </div>  <div class="sendbtn hide" data-role="send-comment-bar">  <span class="gear smiley-button" data-action="expression"></span>  <input class="button disabled" type="button" value="发送" data-action="sendComment"/>  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/tpl/userinfo",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="oneuser attentionuser" data-idoluid="\',user.uid,\'">  <div class="user-avar">\',Global.Helper.avatar(user),\' <div class="user-info">  <p class="userp">\',Global.Helper.userLink(user),\' </p>  <p></p>  </div>\');if(Global.user.uid!=user.uid){if(+is_following===1&&+follow_me===1){_s.push(\'  <div class="attention atten-button " data-action="unfollow"  data-role="editor-followed" data-uid="\',user.uid,\'">  互相关注  </div>\');}else if(+is_following===1&&+follow_me===2){_s.push(\'  <div class="attention following-btn" data-action="unfollow"  data-role="editor-follow" data-uid="\',user.uid,\'">  正在关注  </div>\');}else if(+is_following===2&&+follow_me===1){_s.push(\'  <div class="attention follow-button " data-action="follow"  data-role="editor-followed" data-uid="\',user.uid,\'">  关注  </div>\');}else if(+is_following===2&&+follow_me===2){_s.push(\'  <div class="attention follow-button " data-action="follow"  data-role="editor-follow" data-uid="\',user.uid,\'">  关注  </div>\');}}_s.push(\'  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/message/tpl/praise",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <div class=\"weibo-info praiseweibo\">  <div class=\"user-avar\">',Global.Helper.avatar(user),' <div class=\"user-info\">  <p class=\"userp\">',Global.Helper.userLink(user),' &nbsp;&nbsp;',topic.time,' 来自',topic.from_string,' </p>  <p class=\"userp\">赞了你的动态信息<span>',Global.Helper.parseContent(topic.content),' </span></p>  </div>  </div> </div>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/tpl/no-result",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="no-result">  <div class="no-render"></div>  <p>没有<span class="keyword">\',keyword,\'</span>的搜索结果</p> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/tpl/weibo-del",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="weibo"  data-role="weibo" data-id="\',id,\'">  <p class="weibo-delcls gear-bar">此微博已被删除<span class="collect-button button active" data-action="unfavorite"></span></p> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/query",["$"],function(a){var b=a("$");return{params:function(){var a={},c=window.location.search.slice(1).split("&");return b.each(c,function(b,c){var d=c.indexOf("="),e=c.substring(0,d),f=c.substring(d+1);a[e]=window.decodeURIComponent(f)}),a},param:function(a){return this.params()[a]}}}),define("dist/app/attention/ajaxCommon",["../common/ajax","../common/_ajax","../../lib/util/event","$","../../lib/util/json","../common/dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button"],function(a,b,c){var d=a("../common/ajax"),e={getList:function(a){var b="/relation_api/recommend";d({url:b,method:"GET",data:{}}).done(function(b){a(b)})}};c.exports=e}),define("dist/app/common/tpl/comments",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push('');for(var key=0; key<replylist.length;key+=1){var item=replylist[key];_s.push(tpl.comment.render({item:item.reply, topic: topic}));} return _s;").apply(null,c).join("")}}}),define("dist/app/common/tpl/recomm-user",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="user attentionuser" data-idoluid="\',idols.uid,\'">\',Global.Helper.avatar(idols),\' <div class="follow-button button" data-action="follow" data-uid="\',idols.uid,\'">关注</div>  <div class="name-and-reason">\',Global.Helper.userLink(idols));if(fans.nickname){_s.push(\'  <div class="reason">被<a href="/user?uid=\',fans.uid,\'"><span class="name">\',fans.nickname,\'</span></a>关注</div>\');}_s.push(\'  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/search",["$","../../lib/util/dom/action"],function(a){var b=a("$"),c=a("../../lib/util/dom/action");b(function(){c.listen({search_btn:function(){var a=b(".actions .search-bar").val(),c="/search?key="+encodeURIComponent(a);window.location.href=c}}),b(".actions").on("keyup",".search-bar",function(a){var c=b(this).val();""!==b.trim(c)?b(this).closest(".search").addClass("active"):b(this).closest(".search").removeClass("active"),13==a.keyCode&&b('[data-action="search_btn"]').trigger("click")})})}),define("dist/app/common/head",["$","../../lib/cmp/popup","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/util/bom/cookie","./new-weibo","./ajax","./_ajax","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../../lib/util/dom/action","./weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/util/dom/selection","../../lib/cmp/autocomplete/autocomplete","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","./helper/inputor","../../lib/util/string","../../lib/util/dom/placeholder","./weibo-manager","./tpl/weibo","./tpl/comment","./tpl/weibo-pic","../../lib/util/date","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image","./upload-pic","../../lib/util/dom/upload/upload","../../lib/util/dom/upload/upload-swfupload","../../lib/util/dom/upload/swfupload","../../lib/util/dom/upload/upload-html5","../../lib/util/dom/upload/upload-draggable","./singleton-tip","./tpl/pic","./message-manager","./ext-tip","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/tip/tpl/tip","./tpl/unread_tip"],function(a){var b=a("$"),c=a("../../lib/cmp/popup"),d=(a("../../lib/util/bom/cookie"),a("./new-weibo")),e=a("./message-manager");b(function(){setTimeout(function(){e.init()},2e3),new c({trigger:".global-top-bar .user",element:".global-top-bar .account-dropdown",triggerType:"click",align:{baseXY:[0,"100%"]}}),d.init()})}),define("dist/lib/util/bom/cookie",[],function(a,b,c){var d=decodeURIComponent,e=encodeURIComponent,f={set:function(a,b,c,d){c||(c=31536e6);var f=new Date;f.setTime(f.getTime()+c);var g=e(a)+"="+e(b)+";expires="+f.toGMTString();d&&(d.path&&(g+=";path="+d.path),d.domain&&(g+=";domain="+d.domain),d.secure&&(g+=";secure")),document.cookie=g},sets:function(a,b,c){for(var d in a)f.set(d,a[d],b,c)},get:function(a){var b=document.cookie;a=e(a);var c=b.indexOf(a+"="),f="";if(-1!==c){c+=a.length+1;var g=b.indexOf(";",c);f=d(-1===g?b.substring(c):b.substring(c,g))}return f},del:function(){var a=new Date,b=arguments.length,c=arguments[b-1],d="object"==typeof c;c=d?c:"",a.setTime(a.getTime()-864e5);for(var e=0,g=d?b-1:b;g>e;e++)f.set(arguments[e],"",a,c)}};c.exports=f}),define("dist/app/common/message-manager",["$","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./weibo-manager","./weibo-textarea","../../lib/cmp/autocomplete/textarea-complete","../../lib/util/dom/selection","../../lib/cmp/autocomplete/autocomplete","../../lib/util/dom/inputor","../../lib/util/timer","../../lib/cmp/autocomplete/data-source","../../lib/cmp/autocomplete/filter","../../lib/cmp/autocomplete/tpl/autocomplete","./helper/inputor","../../lib/util/string","../../lib/util/dom/placeholder","./tpl/weibo","./tpl/comment","./tpl/weibo-pic","../../lib/util/date","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../../lib/util/dom/image","./ext-tip","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/tip/tpl/tip","./tpl/unread_tip"],function(a,b,c){function d(a){return new e(a)}function e(a){var b=this;return this.timeout=15e4,this.pool=[],this.params=a,this._ajax=g(a,!0),this._ajax.stop=function(){b.stop()},this._ajax.resume=function(){b.resume()},this.init(),this._ajax}var f=a("$"),g=a("./ajax"),h=a("./weibo-manager"),i=a("./ext-tip"),j=a("./tpl/unread_tip"),k=new i({trigger:".global-top-bar .message",triggerType:"hover",content:"",theme:"white",arrowPosition:12,align:{baseXY:["-30%","100%-3px"],selfXy:["50%","0"]}}).render(),l={dom:f(".navigation .message span"),init:function(){var a=this;pooling=d({method:"GET",url:function(){return"/user_api/unread/tid/"+("/topic_api/timeline_web"===h._requestUrl&&h.minId||0)}}).on("done",function(b){var c=+b.t_at,d=+b.cmt,e=+b.cmt_at,f=+b.t_praised,g=+b.fans,i=c+d+e+f+g,l=+b.unread_t,m=c||d||e||f||g;k.set("content",j.render({sum:i,at:c+e,t_at_flag:+c>0?!0:!1,cmt:d,praise:f,fans:g})),k.set("triggerNum",i),m?(a.dom.hasClass("msgcount")||a.dom.addClass("msgcount"),a.dom.html(i>99?"99+":i)):(a.dom.removeClass("msgcount"),a.dom.html("")),h.minId&&l?(h.tip.text("你有"+l+"条未读微博"),h.tip.show()):h.tip.hide()}).on("no-permission",function(){}).on("timeout",function(){})}};e.prototype.init=function(){var a=this;return this._ajax.done(function(){var b,c=this,d=f.inArray(c,a.pool);for(b=0;d>=b;b++)a.pool[b].abort();a.pool=a.pool.slice(d+1)}),this.resume(),this._ajax},e.prototype.startTimeout=function(){function a(){b.status&&(b.request(),setTimeout(a,b.timeout))}var b=this;setTimeout(a,this.timeout)},e.prototype.request=function(){var a=g(this.params);a.__events=this._ajax.__events,this.pool.push(a)},e.prototype.stop=function(){this.status=0,f.each(this.pool,function(a,b){b.abort()}),this.pool.length=0},e.prototype.resume=function(){this.request(),this.status=1,this.startTimeout()},c.exports=l}),define("dist/app/common/ext-tip",["../../lib/cmp/tip/tip","$","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/tip/tpl/tip"],function(a,b,c){var d=a("../../lib/cmp/tip/tip"),e=d.extend({attrs:{triggerNum:0},setup:function(){e.superclass.setup.call(this),this._bindTrigger()},_bindTrigger:function(){+this.get("triggerNum")>0&&this._bindHover()},_onRenderTriggerNum:function(){this._bindTrigger()}});c.exports=e}),define("dist/app/common/tpl/unread_tip",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push('');if(sum>0){_s.push(' <ul>');if(+cmt>0){_s.push('  <li data-action=\"toComments\"><a href=\"/message?type=comments\">',cmt,'条新评论</a></li>');}if(+at>0){_s.push('  <li data-action=\"toAtme\"><a href=\"/message?type=atme&t_at_flag=',t_at_flag,'\">',at,'条新@我</a></li>');}if(+fans>0){_s.push('  <li data-action=\"toFans\"><a href=\"#\">',fans,'个新粉丝</a></li>');}if(+praise>0){_s.push('  <li data-action=\"toPraise\"><a href=\"/message?type=praises\">',praise,'个赞</a></li>');}_s.push(' </ul>');} return _s;").apply(null,c).join("")}}}),define("dist/app/common/dashboard",["./attention","$","../../lib/util/dom/action","../attention/ajaxCommon","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./tpl/recomm-user","./tpl/no-data","./hot-topic","./tpl/topic","./user-info","./helper/global","./tpl/user/avatar","./tpl/user/user-link","../../lib/util/string","./expression/expression","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/tip/tpl/tip","../../lib/cmp/switchable/tabs","../../lib/cmp/switchable/switchable","../../lib/cmp/switchable/plugins/effects","../../lib/util/dom/easing","../../lib/cmp/switchable/plugins/autoplay","../../lib/cmp/switchable/plugins/circular","./helper/inputor","../../lib/util/dom/selection","../../lib/util/dom/inputor","../../lib/util/timer","./expression/tpl/container","./expression/tpl/item","./expression/tpl/expression","./expression/data","../../lib/util/date","../user/ajaxCommon","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../user/ajaxCallback","./handler","./tpl/weiboinfo","./tpl/weibo","./tpl/weibo-pic","./tpl/userinfo","../message/tpl/praise","./tpl/no-result","./tpl/comment","./tpl/weibo-del","./query"],function(a){a("./attention"),a("./user-info");
var b=a("$"),c=a("./hot-topic");c.init(),b(".scroll-to-top").click(function(){b("body, html").animate({scrollTop:0},300)}),b(window).scroll(function(){b(window).scrollTop()>200?b(".scroll-to-top").fadeIn(300):b(".scroll-to-top").fadeOut(300)})}),define("dist/app/common/attention",["$","../../lib/util/dom/action","../attention/ajaxCommon","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../common/tpl/recomm-user","../common/tpl/no-data","./hot-topic","./tpl/topic"],function(a){function b(a){var b=c(".dashboard .recommand .content"),d=a.count,e=a.users;0>=d?b.html(g.render()):(b.html(""),c.each(e,function(a,c){var d=f.render(c);b.append(d)}))}var c=a("$"),d=a("../../lib/util/dom/action"),e=a("../attention/ajaxCommon"),f=a("../common/tpl/recomm-user"),g=a("../common/tpl/no-data"),h=a("./hot-topic"),i={mouseenter:function(a,b){c.each(a,function(a,d){c("body").on("mouseenter",d,b)})},mouseleave:function(a,b){c.each(a,function(a,d){c("body").on("mouseleave",d,b)})}};c(function(){d.listen({recommRefresh:function(){e.getList(b)},toComments:function(){window.location.href="/message?type=comments"},toFans:function(){window.location.href="/user?uid="+Global.user.uid+"&tabType=fans"},toAtme:function(a,b){var d=c(b).find("a").attr("href");window.location.href=d},toPraise:function(){window.location.href="/message?type=praises"},toUser:function(a,b){var d=c(b).closest("li").find("a").attr("href");window.location.href=d},hotTopicRefresh:function(){h.refresh()}}),i.mouseenter([".following-btn",".atten-button"],function(a){c(a.target).html("取消关注")}),i.mouseleave([".following-btn"],function(a){c(a.target).html("正在关注")}),i.mouseleave([".atten-button"],function(a){c(a.target).html("互相关注")}),e.getList(b)})}),define("dist/app/common/hot-topic",["$","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./tpl/topic"],function(a){var b,c=a("$"),d=a("./ajax"),e=a("./tpl/topic"),f=1,g=10,h={init:function(){var a=this;a._request()},refresh:function(){var a=this;a._request()},_request:function(){{var a=this;d({method:"GET",url:"/tag_api/hot/page_size/"+g+"/page/"+f}).done(function(c){b=c.total,f>b/g?f=1:f++,a._render(c.tags)})}},_render:function(a){var b=c.map(a,function(a){return e.render(a)}).join("");c(".hot-topic .content").html(b)}};return h}),define("dist/app/common/tpl/topic",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <div class=\"topic\" data-id=\"',tag_id,'>\">  <a href=\"/topicinfo?topic=',tag_name,'\">#',tag_name,'#</a> </div>'); return _s;").apply(null,c).join("")}}}),define("dist/app/common/user-info",["./helper/global","$","./tpl/user/avatar","./tpl/user/user-link","../../lib/util/string","./expression/expression","../../lib/cmp/tip/tip","../../lib/cmp/tip/basic-tip","../../lib/cmp/popup","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/tip/tpl/tip","../../lib/util/dom/action","../../lib/cmp/switchable/tabs","../../lib/cmp/switchable/switchable","../../lib/cmp/switchable/plugins/effects","../../lib/util/dom/easing","../../lib/cmp/switchable/plugins/autoplay","../../lib/cmp/switchable/plugins/circular","./helper/inputor","../../lib/util/dom/selection","../../lib/util/dom/inputor","../../lib/util/timer","./expression/tpl/container","./expression/tpl/item","./expression/tpl/expression","./expression/data","../../lib/util/date","../user/ajaxCommon","./ajax","./_ajax","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../user/ajaxCallback","./handler","./tpl/no-data","./tpl/weiboinfo","./tpl/weibo","./tpl/weibo-pic","./tpl/userinfo","../message/tpl/praise","./tpl/no-result","./tpl/comment","./tpl/weibo-del","./query"],function(a){a("./helper/global");var b=a("../user/ajaxCommon"),c=a("$"),d=Global.user.uid;return b.userInfo(d).done(function(a){var b=[null===a.topics?0:a.topics,null===a.favs?0:a.favs,null===a.fans?0:a.fans,null===a.idols?0:a.idols];c(".stat").find(".item").each(function(a){c(this).find(".num a").html(b[a])}),c(".profile .user-avatar").html(Global.Helper.avatar(a,100)),c(".profile .name").html(Global.Helper.userLink(a)),a.idols=+a.idols,a.idols||this.trigger("no-follow")})}),define("dist/app/common/placeholder",["../../lib/util/dom/placeholder","$","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/inputor","../../lib/util/timer"],function(a){var b=a("../../lib/util/dom/placeholder");b.render()}),define("dist/app/user/tab",["../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","$","../../lib/cmp/daparser","../../lib/cmp/auto-render","./ajaxCommon","../common/ajax","../common/_ajax","../../lib/util/json","../common/dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../common/pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","./ajaxCallback","../common/handler","../../lib/util/date","../common/tpl/no-data","../common/tpl/weiboinfo","../common/tpl/weibo","../common/tpl/weibo-pic","../common/tpl/userinfo","../message/tpl/praise","../common/tpl/no-result","../common/tpl/comment","../common/tpl/weibo-del","../common/query"],function(a,b,c){var d=a("../../lib/cmp/widget"),e=a("./ajaxCommon"),f=a("$"),g=d.extend({attrs:{index:0,current:{value:0}},events:{"click li":function(a){var b=f(a.target).closest("li"),c=this.$("li").index(b);this.active(c)}},_onRenderIndex:function(a){var b=this.$("li");b.eq(a).siblings("li").removeClass("active"),b.eq(a).addClass("active"),this.switchData(b.eq(a))},setup:function(){this.active(this.get("index"))},active:function(a){return this.set("index",a),this},switchData:function(a){var b=0,c=f(".weiboinfos");switch(a.hasClass("userWeb")?b=0:a.hasClass("favor")?b=1:a.hasClass("idols")?b=2:a.hasClass("fans")&&(b=3),b){case 0:f(".weibo-tabs").show(),c.data("favor",0),e.userWeb(1,!0);break;case 1:f(".weibo-tabs").hide(),e.favorite(1,!0),c.data("favor",1);break;case 2:f(".weibo-tabs").hide(),e.fans(1,!0),c.data("favor",0);break;case 3:f(".weibo-tabs").hide(),e.idols(1,!0),c.data("favor",0)}}});c.exports=g});